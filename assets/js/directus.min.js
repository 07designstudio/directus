var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var i=Object.prototype.toString,n="[object Function]",s="[object Object]";e.registerHelper=function(t,n,o){if(i.call(t)===s){if(o||n)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else o&&(n.not=o),this.helpers[t]=n},e.registerPartial=function(t,n){i.call(t)===s?e.Utils.extend(this.partials,t):this.partials[t]=n},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,s){var o=s.inverse||function(){},a=s.fn,r=i.call(t);return r===n&&(t=t.call(this)),t===!0?a(this):t===!1||null==t?o(this):"[object Array]"===r?t.length>0?e.helpers.each(t,s):o(this):a(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var i=new e.K;return e.K.prototype=null,i},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,i){if(e.logger.level<=t){var n=e.logger.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,i)}}},e.log=function(t,i){e.logger.log(t,i)},e.registerHelper("each",function(t,s){var o,a=s.fn,r=s.inverse,l=0,c="",u=i.call(t);if(u===n&&(t=t.call(this)),s.data&&(o=e.createFrame(s.data)),t&&"object"==typeof t)if(t instanceof Array)for(var d=t.length;d>l;l++)o&&(o.index=l),c+=a(t[l],{data:o});else for(var h in t)t.hasOwnProperty(h)&&(o&&(o.key=h),c+=a(t[h],{data:o}),l++);return 0===l&&(c=r(this)),c}),e.registerHelper("if",function(t,s){var o=i.call(t);return o===n&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?s.inverse(this):s.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn})}),e.registerHelper("with",function(t,s){var o=i.call(t);return o===n&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:s.fn(t)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)});var o=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function(e,t,i,n,s,o){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=new n.ProgramNode([],o[a]);break;case 3:this.$=new n.ProgramNode(o[a-2],o[a]);break;case 4:this.$=new n.ProgramNode(o[a-1],[]);break;case 5:this.$=new n.ProgramNode(o[a]);break;case 6:this.$=new n.ProgramNode([],[]);break;case 7:this.$=new n.ProgramNode([]);break;case 8:this.$=[o[a]];break;case 9:o[a-1].push(o[a]),this.$=o[a-1];break;case 10:this.$=new n.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 11:this.$=new n.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 12:this.$=o[a];break;case 13:this.$=o[a];break;case 14:this.$=new n.ContentNode(o[a]);break;case 15:this.$=new n.CommentNode(o[a]);break;case 16:this.$=new n.MustacheNode(o[a-1][0],o[a-1][1]);break;case 17:this.$=new n.MustacheNode(o[a-1][0],o[a-1][1]);break;case 18:this.$=o[a-1];break;case 19:this.$=new n.MustacheNode(o[a-1][0],o[a-1][1],"&"===o[a-2][2]);break;case 20:this.$=new n.MustacheNode(o[a-1][0],o[a-1][1],!0);break;case 21:this.$=new n.PartialNode(o[a-1]);break;case 22:this.$=new n.PartialNode(o[a-2],o[a-1]);break;case 23:break;case 24:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 25:this.$=[[o[a-1]].concat(o[a]),null];break;case 26:this.$=[[o[a-1]],o[a]];break;case 27:this.$=[[o[a]],null];break;case 28:this.$=[[o[a]],null];break;case 29:o[a-1].push(o[a]),this.$=o[a-1];break;case 30:this.$=[o[a]];break;case 31:this.$=o[a];break;case 32:this.$=new n.StringNode(o[a]);break;case 33:this.$=new n.IntegerNode(o[a]);break;case 34:this.$=new n.BooleanNode(o[a]);break;case 35:this.$=o[a];break;case 36:this.$=new n.HashNode(o[a]);break;case 37:o[a-1].push(o[a]),this.$=o[a-1];break;case 38:this.$=[o[a]];break;case 39:this.$=[o[a-2],o[a]];break;case 40:this.$=[o[a-2],new n.StringNode(o[a])];break;case 41:this.$=[o[a-2],new n.IntegerNode(o[a])];break;case 42:this.$=[o[a-2],new n.BooleanNode(o[a])];break;case 43:this.$=[o[a-2],o[a]];break;case 44:this.$=new n.PartialNameNode(o[a]);break;case 45:this.$=new n.PartialNameNode(new n.StringNode(o[a]));break;case 46:this.$=new n.PartialNameNode(new n.IntegerNode(o[a]));break;case 47:this.$=new n.DataNode(o[a]);break;case 48:this.$=new n.IdNode(o[a]);break;case 49:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 50:this.$=[{part:o[a]}]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],s=[null],o=[],a=this.table,r="",l=0,c=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;o.push(d);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,b,y,_,w,x={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=t()),g=a[m]&&a[m][p]),"undefined"==typeof g||!g.length||!g[0]){var k="";if(!u){w=[];for(b in a[m])this.terminals_[b]&&b>2&&w.push("'"+this.terminals_[b]+"'");k=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:d,expected:w})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),s.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,r=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,u>0&&u--);break;case 2:if(y=this.productions_[g[1]][1],x.$=s[s.length-y],x._$={first_line:o[o.length-(y||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(y||1)].first_column,last_column:o[o.length-1].last_column},h&&(x._$.range=[o[o.length-(y||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.call(x,r,c,l,this.yy,g[1],s,o),"undefined"!=typeof v)return v;y&&(n=n.slice(0,-1*y*2),s=s.slice(0,-1*y),o=o.slice(0,-1*y)),n.push(this.productions_[g[1]][0]),s.push(x.$),o.push(x._$),_=a[n[n.length-2]][n[n.length-1]],n.push(_);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,n,s;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),a=0;a<o.length&&(i=this._input.match(this.rules[o[a]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=a,this.options.flex));a++);return t?(s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,n){switch(i){case 0:return t.yytext="\\",14;case 1:if("\\"!==t.yytext.slice(-1)&&this.begin("mu"),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1),this.begin("emu")),t.yytext)return 14;break;case 2:return 14;case 3:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1)),14;case 4:return t.yytext=t.yytext.substr(0,t.yyleng-4),this.popState(),15;case 5:return 25;case 6:return 16;case 7:return 20;case 8:return 19;case 9:return 19;case 10:return 23;case 11:return 22;case 12:this.popState(),this.begin("com");break;case 13:return t.yytext=t.yytext.substr(3,t.yyleng-5),this.popState(),15;case 14:return 22;case 15:return 37;case 16:return 36;case 17:return 36;case 18:return 40;case 19:break;case 20:return this.popState(),24;case 21:return this.popState(),18;case 22:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),31;case 23:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\'/g,"'"),31;case 24:return 38;case 25:return 33;case 26:return 33;case 27:return 32;case 28:return 36;case 29:return t.yytext=t.yytext.substr(1,t.yyleng-2),36;case 30:return"INVALID";case 31:return 5}},e.rules=[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},emu:{rules:[3],inclusive:!1},com:{rules:[4],inclusive:!1},INITIAL:{rules:[0,1,2,31],inclusive:!0}},e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}();e.Parser=o,e.parse=function(t){return t.constructor===e.AST.ProgramNode?t:(e.Parser.yy=e.AST,e.Parser.parse(t))},e.AST={},e.AST.ProgramNode=function(t,i){this.type="program",this.statements=t,i&&(this.inverse=new e.AST.ProgramNode(i))},e.AST.MustacheNode=function(e,t,i){this.type="mustache",this.escaped=!i,this.hash=t;var n=this.id=e[0],s=this.params=e.slice(1),o=this.eligibleHelper=n.isSimple;this.isHelper=o&&(s.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.partialName=e,this.context=t},e.AST.BlockNode=function(t,i,n,s){var o=function(t,i){if(t.original!==i.original)throw new e.Exception(t.original+" doesn't match "+i.original)};o(t.id,s),this.type="block",this.mustache=t,this.program=i,this.inverse=n,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(t){this.type="ID";for(var i="",n=[],s=0,o=0,a=t.length;a>o;o++){var r=t[o].part;if(i+=(t[o].separator||"")+r,".."===r||"."===r||"this"===r){if(n.length>0)throw new e.Exception("Invalid path: "+i);".."===r?s++:this.isScoped=!0}else n.push(r)}this.original=i,this.parts=n,this.string=n.join("."),this.depth=s,this.isSimple=1===t.length&&!this.isScoped&&0===s,this.stringModeValue=this.string},e.AST.PartialNameNode=function(e){this.type="PARTIAL_NAME",this.name=e.original},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.original=this.string=this.stringModeValue=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},e.AST.CommentNode=function(e){this.type="comment",this.comment=e};var a=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<a.length;t++)this[a[t]]=e[a[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/,u=function(e){return r[e]||"&amp;"};e.Utils={extend:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),c.test(t)?t.replace(l,u):t)},isEmpty:function(e){return e||0===e?"[object Array]"===i.call(e)&&0===e.length?!0:!1:!0}};var d=e.Compiler=function(){},h=e.JavaScriptCompiler=function(){};d.prototype={compiler:d,disassemble:function(){for(var e,t,i,n=this.opcodes,s=[],o=0,a=n.length;a>o;o++)if(e=n[o],"DECLARE"===e.opcode)s.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var r=0;r<e.args.length;r++)i=e.args[r],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);s.push(e.opcode+" "+t.join(" "))}return s.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var n=this.opcodes[i],s=e.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length)return!1;for(var o=0;o<n.args.length;o++)if(n.args[o]!==s.args[o])return!1}if(t=this.children.length,e.children.length!==t)return!1;for(i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t,i=e.statements;this.opcodes=[];for(var n=0,s=i.length;s>n;n++)t=i[n],this[t.type](t);return this.isSimple=1===s,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var s=0,o=i.depths.list.length;o>s;s++)t=i.depths.list[s],2>t||this.addDepth(t-1);return n},block:function(e){var t=e.mustache,i=e.program,n=e.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var s=this.classifyMustache(t);"helper"===s?this.helperMustache(t,i,n):"simple"===s?(this.simpleMustache(t),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,i,n=e.pairs;this.opcode("pushHash");for(var s=0,o=n.length;o>s;s++)t=n[s],i=t[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type)):this.accept(i),this.opcode("assignToHash",t[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,i=this.classifyMustache(e);"simple"===i?this.simpleMustache(e):"helper"===i?this.helperMustache(e):this.ambiguousMustache(e),this.opcode(e.escaped&&!t.noEscape?"appendEscaped":"append")},ambiguousMustache:function(e,t,i){var n=e.id,s=n.parts[0],o=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",s,o)},simpleMustache:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",n.length,s);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s);this.opcode("invokeHelper",n.length,s)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,n=e.parts.length;n>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(t){if(this.options.data=!0,t.id.isScoped||t.id.depth)throw new e.Exception("Scoped data references are not supported: "+t.original);this.opcode("lookupData");for(var i=t.id.parts,n=0,s=i.length;s>n;n++)this.opcode("lookup",i[n])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,i=e.eligibleHelper,n=this.options;if(i&&!t){var s=e.id.parts[0];n.knownHelpers[s]?t=!0:n.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,i){var n=e.params;return this.pushParams(n),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("emptyHash"),n}};var p=function(e){this.value=e};h.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":h.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,i,n,s){this.environment=t,this.options=i||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,i);var o,a=t.opcodes;for(this.i=0,v=a.length;this.i<v;this.i++)o=a[this.i],"DECLARE"===o.opcode?this[o.name]=o.value:this[o.opcode].apply(this,o.args);return this.createFunctionContext(s)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(i+=" data = data || {};"),e.push(i)}e.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var i=this.stackVars.concat(this.registers.list);if(i.length>0&&(this.source[1]=this.source[1]+", "+i.join(", ")),!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],o=0,a=this.environment.depths.list.length;a>o;o++)s.push("depth"+this.environment.depths.list[o]);var r=this.mergeSource();if(!this.isChild){var l=e.COMPILER_REVISION,c=e.REVISION_CHANGES[l];r="this.compilerInfo = ["+l+",'"+c+"'];\n"+r}if(t)return s.push(r),Function.apply(this,s);var u="function "+(this.name||"")+"("+s.join(",")+") {\n  "+r+"}";return e.log(e.logger.DEBUG,u+"\n\n"),u},mergeSource:function(){for(var e,i="",n=0,s=this.source.length;s>n;n++){var o=this.source[n];o.appendToBuffer?e=e?e+"\n    + "+o.content:o.content:(e&&(i+="buffer += "+e+";\n  ",e=t),i+=o+"\n  ")}return i},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){this.flushInline();var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),"string"==typeof e?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=t,this.options.stringParams&&(this.register("hashContexts","{"+e.contexts.join(",")+"}"),this.register("hashTypes","{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(e,t,!0),n=this.nameLookup("depth"+this.lastContext,t,"context");this.push(i.name+" || "+n),this.replaceStack(function(e){return e+" ? "+e+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var i=this.setupHelper(0,e,t),n=this.lastHelper=this.nameLookup("helpers",e,"helper"),s=this.nameLookup("depth"+this.lastContext,e,"context"),o=this.nextStack();this.source.push("if ("+o+" = "+n+") { "+o+" = "+o+".call("+i.callParams+"); }"),this.source.push("else { "+o+" = "+s+"; "+o+" = typeof "+o+" === functionType ? "+o+".apply(depth0) : "+o+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")
},assignToHash:function(e){var t,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),t=this.popStack());var s=this.hash;t&&s.contexts.push("'"+e+"': "+t),i&&s.types.push("'"+e+"': "+i),s.values.push("'"+e+"': ("+n+")")},compiler:h,compileChildren:function(e,t){for(var i,n,s=e.children,o=0,a=s.length;a>o;o++){i=s[o],n=new this.compiler;var r=this.matchExistingProgram(i);null==r?(this.context.programs.push(""),r=this.context.programs.length,i.index=r,i.name="program"+r,this.context.programs[r]=n.compile(i,t,this.context),this.context.environments[r]=i):(i.index=r,i.name="program"+r)}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],n=i.depths.list,s=[i.index,i.name,"data"],o=0,a=n.length;a>o;o++)t=n[o],s.push(1===t?"depth0":"depth"+(t-1));return(0===n.length?"self.program(":"self.programWithDepth(")+s.join(", ")+")"},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new p(e))},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.source.push(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t,i="",n=this.isInline();if(n){var s=this.popStack(!0);if(s instanceof p)t=s.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();i="("+this.push(o)+" = "+s+"),",t=this.topStack()}}else t=this.topStack();var a=e.call(this,t);return n?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+i+a+")")):(/^stack/.test(t)||(t=this.nextStack()),this.source.push(t+" = ("+i+a+");")),t},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,i=e.length;i>t;t++){var n=e[t];n instanceof p?this.compileStack.push(n):this.pushStack(n)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();return!e&&i instanceof p?i.value:(t||this.stackSlot--,i)},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,i=t[t.length-1];return!e&&i instanceof p?i.value:i},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,i){var n=[];this.setupParams(e,n,i);var s=this.nameLookup("helpers",t,"helper");return{params:n,name:s,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(t)].concat(n).join(", ")}},setupParams:function(e,t,i){var n,s,o,a=[],r=[],l=[];a.push("hash:"+this.popStack()),s=this.popStack(),o=this.popStack(),(o||s)&&(o||(this.context.aliases.self="this",o="self.noop"),s||(this.context.aliases.self="this",s="self.noop"),a.push("inverse:"+s),a.push("fn:"+o));for(var c=0;e>c;c++)n=this.popStack(),t.push(n),this.options.stringParams&&(l.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(a.push("contexts:["+r.join(",")+"]"),a.push("types:["+l.join(",")+"]"),a.push("hashContexts:hashContexts"),a.push("hashTypes:hashTypes")),this.options.data&&a.push("data:data"),a="{"+a.join(",")+"}",i?(this.register("options",a),t.push("options")):t.push(a),t.join(", ")}};for(var f="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),m=h.RESERVED_WORDS={},g=0,v=f.length;v>g;g++)m[f[g]]=!0;h.isValidJavaScriptVariableName=function(e){return!h.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},e.precompile=function(t,i){if(null==t||"string"!=typeof t&&t.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);i=i||{},"data"in i||(i.data=!0);var n=e.parse(t),s=(new d).compile(n,i);return(new h).compile(s,i)},e.compile=function(i,n){function s(){var s=e.parse(i),o=(new d).compile(s,n),a=(new h).compile(o,n,t,!0);return e.template(a)}if(null==i||"string"!=typeof i&&i.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+i);n=n||{},"data"in n||(n.data=!0);var o;return function(e,t){return o||(o=s()),o.call(this,e,t)}},e.VM={template:function(t){var i={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,i,n){var s=this.programs[t];return n?s=e.VM.program(t,i,n):s||(s=this.programs[t]=e.VM.program(t,i)),s},merge:function(t,i){var n=t||i;return t&&i&&(n={},e.Utils.extend(n,i),e.Utils.extend(n,t)),n},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(n,s){s=s||{};var o=t.call(i,e,n,s.helpers,s.partials,s.data),a=i.compilerInfo||[],r=a[0]||1,l=e.COMPILER_REVISION;if(r!==l){if(l>r){var c=e.REVISION_CHANGES[l],u=e.REVISION_CHANGES[r];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+c+") or downgrade your runtime to an older version ("+u+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+")."}return o}},programWithDepth:function(e,t,i){var n=Array.prototype.slice.call(arguments,3),s=function(e,s){return s=s||{},t.apply(this,[e,s.data||i].concat(n))};return s.program=e,s.depth=n.length,s},program:function(e,t,i){var n=function(e,n){return n=n||{},t(e,n.data||i)};return n.program=e,n.depth=0,n},noop:function(){return""},invokePartial:function(i,n,s,o,a,r){var l={helpers:o,partials:a,data:r};if(i===t)throw new e.Exception("The partial "+n+" could not be found");if(i instanceof Function)return i(s,l);if(e.compile)return a[n]=e.compile(i,{data:r!==t}),a[n](s,l);throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars);var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,n){return t&&eachProp(t,function(t,s){(i||!hasProp(e,s))&&(n&&"string"!=typeof t?(e[s]||(e[s]={}),mixin(e[s],t,i,n)):e[s]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,n){var s=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return s.requireType=e,s.requireModules=n,i&&(s.originalError=i),s}function newContext(e){function t(e){var t,i;for(t=0;e[t];t+=1)if(i=e[t],"."===i)e.splice(t,1),t-=1;else if(".."===i){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,n){var s,o,a,r,l,c,u,d,h,p,f,m=i&&i.split("/"),g=m,v=k.map,b=v&&v["*"];if(e&&"."===e.charAt(0)&&(i?(g=getOwn(k.pkgs,i)?m=[i]:m.slice(0,m.length-1),e=g.concat(e.split("/")),t(e),o=getOwn(k.pkgs,s=e[0]),e=e.join("/"),o&&e===s+"/"+o.main&&(e=s)):0===e.indexOf("./")&&(e=e.substring(2))),n&&(m||b)&&v){for(r=e.split("/"),l=r.length;l>0;l-=1){if(u=r.slice(0,l).join("/"),m)for(c=m.length;c>0;c-=1)if(a=getOwn(v,m.slice(0,c).join("/")),a&&(a=getOwn(a,u))){d=a,h=l;break}if(d)break;!p&&b&&getOwn(b,u)&&(p=getOwn(b,u),f=l)}!d&&p&&(d=p,h=f),d&&(r.splice(0,h,d),e=r.join("/"))}return e}function n(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===_.contextName?(t.parentNode.removeChild(t),!0):void 0})}function s(e){var t=getOwn(k.paths,e);return t&&isArray(t)&&t.length>1?(n(e),t.shift(),_.require.undef(e),_.require([e]),!0):void 0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function a(e,t,n,s){var a,r,l,c,u=null,d=t?t.name:null,h=e,p=!0,f="";return e||(p=!1,e="_@r"+($+=1)),c=o(e),u=c[0],e=c[1],u&&(u=i(u,d,s),r=getOwn(E,u)),e&&(u?f=r&&r.normalize?r.normalize(e,function(e){return i(e,d,s)}):i(e,d,s):(f=i(e,d,s),c=o(f),u=c[0],f=c[1],n=!0,a=_.nameToUrl(f))),l=!u||r||n?"":"_unnormalized"+(M+=1),{prefix:u,name:f,parentMap:t,unnormalized:!!l,url:a,originalName:h,isDefine:p,id:(u?u+"!"+f:f)+l}}function r(e){var t=e.id,i=getOwn(C,t);return i||(i=C[t]=new _.Module(e)),i}function l(e,t,i){var n=e.id,s=getOwn(C,n);!hasProp(E,n)||s&&!s.defineEmitComplete?r(e).on(t,i):"defined"===t&&i(E[n])}function c(e,t){var i=e.requireModules,n=!1;t?t(e):(each(i,function(t){var i=getOwn(C,t);i&&(i.error=e,i.events.error&&(n=!0,i.emit("error",e)))}),n||req.onError(e))}function u(){globalDefQueue.length&&(apsp.apply(T,[T.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function d(e){delete C[e]}function h(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,each(e.depMaps,function(n,s){var o=n.id,a=getOwn(C,o);!a||e.depMatched[s]||i[o]||(getOwn(t,o)?(e.defineDep(s,E[o]),e.check()):h(a,t,i))}),i[n]=!0)}function p(){var e,t,i,o,a=1e3*k.waitSeconds,r=a&&_.startTime+a<(new Date).getTime(),l=[],u=[],d=!1,f=!0;if(!b){if(b=!0,eachProp(C,function(i){if(e=i.map,t=e.id,i.enabled&&(e.isDefine||u.push(i),!i.error))if(!i.inited&&r)s(t)?(o=!0,d=!0):(l.push(t),n(t));else if(!i.inited&&i.fetched&&e.isDefine&&(d=!0,!e.prefix))return f=!1}),r&&l.length)return i=makeError("timeout","Load timeout for modules: "+l,null,l),i.contextName=_.contextName,c(i);f&&each(u,function(e){h(e,{},{})}),r&&!o||!d||!isBrowser&&!isWebWorker||x||(x=setTimeout(function(){x=0,p()},50)),b=!1}}function f(e){hasProp(E,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function m(e,t,i,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(i,t,!1)}function g(e){var t=e.currentTarget||e.srcElement;return m(t,_.onScriptLoad,"load","onreadystatechange"),m(t,_.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(u();T.length;){if(e=T.shift(),null===e[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var b,y,_,w,x,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},map:{},config:{}},C={},S={},T=[],E={},A={},$=1,M=1;return w={require:function(e){return e.require?e.require:e.require=_.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=E[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return k.config&&getOwn(k.config,e.map.id)||{}},exports:E[e.map.id]}}},y=function(e){this.events=getOwn(S,e.id)||{},this.map=e,this.shim=getOwn(k.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,_.startTime=(new Date).getTime();var e=this.map;return this.shim?void _.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;A[e]||(A[e]=!0,_.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,s=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error)try{s=_.execCb(i,o,n,s)}catch(a){e=a}else s=_.execCb(i,o,n,s);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?s=t.exports:void 0===s&&this.usingExports&&(s=this.exports)),e)return e.requireMap=this.map,e.requireModules=[this.map.id],e.requireType="define",c(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(E[i]=s,req.onResourceLoad&&req.onResourceLoad(_,this.map,this.depMaps)),delete C[i],this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=a(e.prefix);this.depMaps.push(n),l(n,"defined",bind(this,function(n){var s,o,u,h=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=_.makeRequire(e.parentMap,{enableBuildCallback:!0,skipMap:!0});return this.map.unnormalized?(n.normalize&&(h=n.normalize(h,function(e){return i(e,p,!0)})||""),o=a(e.prefix+"!"+h,this.map.parentMap),l(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),u=getOwn(C,o.id),void(u&&(this.depMaps.push(o),this.events.error&&u.on("error",bind(this,function(e){this.emit("error",e)})),u.enable()))):(s=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(C,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&d(e.map.id)}),c(e)}),s.fromText=bind(this,function(i,n){var o=e.name,l=a(o),c=useInteractive;n&&(i=n),c&&(useInteractive=!1),r(l),hasProp(k.config,t)&&(k.config[o]=k.config[t]);try{req.exec(i)}catch(u){throw new Error("fromText eval for "+o+" failed: "+u)}c&&(useInteractive=!0),this.depMaps.push(l),_.completeLoad(o),f([o],s)}),void n.load(e.name,f,s,k))})),_.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,n,s;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,s=getOwn(w,e.id))return void(this.depExports[t]=s(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",this.errback)}i=e.id,n=C[i],hasProp(w,i)||!n||n.enabled||_.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&_.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},_={config:k,contextName:e,registry:C,defined:E,urlFetched:A,defQueue:T,Module:y,makeModuleMap:a,nextTick:req.nextTick,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=k.pkgs,i=k.shim,n={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?"map"===t?mixin(k[t],e,!0,!0):mixin(k[t],e,!0):k[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=_.makeShimExports(e)),i[t]=e}),k.shim=i),e.packages&&(each(e.packages,function(e){var i;e="string"==typeof e?{name:e}:e,i=e.location,t[e.name]={name:e.name,location:i||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),k.pkgs=t),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&_.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function s(i,o,l){var u,d,h;return n.enableBuildCallback&&o&&isFunction(o)&&(o.__requireJsBuild=!0),"string"==typeof i?isFunction(o)?c(makeError("requireargs","Invalid require call"),l):t&&hasProp(w,i)?w[i](C[t.id]):req.get?req.get(_,i,t):(d=a(i,t,!1,!0),u=d.id,hasProp(E,u)?E[u]:c(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),_.nextTick(function(){v(),h=r(a(null,t)),h.skipMap=n.skipMap,h.init(i,o,l,{enabled:!0}),p()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n=e.lastIndexOf("."),s=null;return-1!==n&&(s=e.substring(n,e.length),e=e.substring(0,n)),_.nameToUrl(i(e,t&&t.id,!0),s)},defined:function(e){return hasProp(E,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(E,e)||hasProp(C,e)}}),t||(s.undef=function(e){u();var i=a(e,t,!0),n=getOwn(C,e);delete E[e],delete A[i.url],delete S[e],n&&(n.events.defined&&(S[e]=n.events),d(e))}),s},enable:function(e){var t=getOwn(C,e.id);t&&r(e).enable()},completeLoad:function(e){var t,i,n,o=getOwn(k.shim,e)||{},a=o.exports;for(u();T.length;){if(i=T.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(n=getOwn(C,e),!t&&!hasProp(E,e)&&n&&!n.inited){if(!(!k.enforceDefine||a&&getGlobal(a)))return s(e)?void 0:c(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t){var i,n,s,o,a,r,l,c,u;if(req.jsExtRegExp.test(e))c=e+(t||"");else{for(i=k.paths,n=k.pkgs,a=e.split("/"),r=a.length;r>0;r-=1){if(l=a.slice(0,r).join("/"),s=getOwn(n,l),u=getOwn(i,l)){isArray(u)&&(u=u[0]),a.splice(0,r,u);break}if(s){o=e===s.name?s.location+"/"+s.main:s.location,a.splice(0,r,o);break}}c=a.join("/"),c+=t||(/\?/.test(c)?"":".js"),c=("/"===c.charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+c}return k.urlArgs?c+((-1===c.indexOf("?")?"?":"&")+k.urlArgs):c},load:function(e,t){req.load(_,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=g(e);_.completeLoad(t.id)}},onScriptError:function(e){var t=g(e);return s(t.id)?void 0:c(makeError("scripterror","Script error",e,[t.id]))}},_.require=_.makeRequire(),_}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.2",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,n){var s,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=i,i=n):e=[]),o&&o.context&&(a=o.context),s=getOwn(contexts,a),s||(s=contexts[a]=req.s.newContext(a)),o&&s.configure(o),s.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,i){var n,s=e&&e.config||{};return isBrowser?(n=s.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),n.type=s.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n):void(isWebWorker&&(importScripts(i),e.completeLoad(t)))},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0):void 0}),define=function(e,t,i){var n,s;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=[]),!t.length&&isFunction(i)&&i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(e||(e=n.getAttribute("data-requiremodule")),s=contexts[n.getAttribute("data-requirecontext")])),(s?s.defQueue:globalDefQueue).push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");t>=0&&alert("For best performance, we recommend that you use Directus with Google Chrome.")}(),define("handlebars",function(e){return function(){return e.Handlebars||Handlebars}}(this)),function(){require.config({urlArgs:"bust="+window.directusData.cacheBuster,paths:{jquery:"../assets/js/libs/jquery",underscore:"../assets/js/libs/underscore",backbone:"../assets/js/libs/backbone",handlebars:"../assets/js/libs/handlebars",sortable:"../assets/js/libs/sortable",moment:"../assets/js/libs/moment.min",noty:"../assets/js/libs/noty",noty_theme:"../assets/js/libs/noty_theme",libs:"../assets/js/libs",plugins:"../assets/js/plugins",vendor:"../assets/vendor",extensions:"../extensions",listviews:"../listviews",ui:"../ui"},shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},handlebars:{exports:"Handlebars"},underscore:{exports:"_"},noty:{deps:["jquery"]},noty_theme:{deps:["jquery","noty"]},"plugins/backbone.layoutmanager":["backbone"],"plugins/bootstrap-dropdown":["jquery"],"plugins/typeahead":["jquery"],"plugins/bootstrap-tooltip":["jquery"]}}),define("config",function(){}),function(e){function t(e,t){return function(i){return l(e.call(this,i),t)}}function i(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)}}function n(){}function s(e){_(e),a(this,e)}function o(e){var t=f(e),i=t.year||0,n=t.month||0,s=t.week||0,o=t.day||0,a=t.hour||0,r=t.minute||0,l=t.second||0,c=t.millisecond||0;this._input=e,this._milliseconds=+c+1e3*l+6e4*r+36e5*a,this._days=+o+7*s,this._months=+n+12*i,this._data={},this._bubble()}function a(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function r(e){return 0>e?Math.ceil(e):Math.floor(e)}function l(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}function c(e,t,i,n){var s,o,a=t._milliseconds,r=t._days,l=t._months;a&&e._d.setTime(+e._d+a*i),(r||l)&&(s=e.minute(),o=e.hour()),r&&e.date(e.date()+r*i),l&&e.month(e.month()+l*i),a&&!n&&tt.updateOffset(e),(r||l)&&(e.minute(s),e.hour(o))}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function h(e,t,i){var n,s=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(n=0;s>n;n++)(i&&e[n]!==t[n]||!i&&g(e[n])!==g(t[n]))&&a++;return a+o}function p(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Pt[e]||Lt[t]||t}return e}function f(e){var t,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=p(i),t&&(n[t]=e[i]));return n}function m(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else{if(0!==t.indexOf("month"))return;i=12,n="month"}tt[t]=function(s,o){var a,r,l=tt.fn._lang[t],c=[];if("number"==typeof s&&(o=s,s=e),r=function(e){var t=tt().utc().set(n,e);return l.call(tt.fn._lang,t,s||"")},null!=o)return r(o);for(a=0;i>a;a++)c.push(r(a));return c}}function g(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function v(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function b(e){return y(e)?366:365}function y(e){return 0===e%4&&0!==e%100||0===e%400}function _(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[at]<0||e._a[at]>11?at:e._a[rt]<1||e._a[rt]>v(e._a[ot],e._a[at])?rt:e._a[lt]<0||e._a[lt]>23?lt:e._a[ct]<0||e._a[ct]>59?ct:e._a[ut]<0||e._a[ut]>59?ut:e._a[dt]<0||e._a[dt]>999?dt:-1,e._pf._overflowDayOfYear&&(ot>t||t>rt)&&(t=rt),e._pf.overflow=t)}function w(e){e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function x(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function k(e){return e?e.toLowerCase().replace("_","-"):e}function C(e,t){return t.abbr=e,ht[e]||(ht[e]=new n),ht[e].set(t),ht[e]}function S(e){delete ht[e]}function T(e){var t,i,n,s,o=0,a=function(e){if(!ht[e]&&pt)try{require("./lang/"+e)}catch(t){}return ht[e]};if(!e)return tt.fn._lang;if(!u(e)){if(i=a(e))return i;e=[e]}for(;o<e.length;){for(s=k(e[o]).split("-"),t=s.length,n=k(e[o+1]),n=n?n.split("-"):null;t>0;){if(i=a(s.slice(0,t).join("-")))return i;if(n&&n.length>=t&&h(s,n,!0)>=t-1)break;t--}o++}return tt.fn._lang}function E(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function A(e){var t,i,n=e.match(vt);for(t=0,i=n.length;i>t;t++)n[t]=Ht[n[t]]?Ht[n[t]]:E(n[t]);return function(s){var o="";for(t=0;i>t;t++)o+=n[t]instanceof Function?n[t].call(s,e):n[t];return o}}function $(e,t){return e.isValid()?(t=M(t,e.lang()),Vt[t]||(Vt[t]=A(t)),Vt[t](e)):e.lang().invalidDate()}function M(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(bt.lastIndex=0;n>=0&&bt.test(e);)e=e.replace(bt,i),bt.lastIndex=0,n-=1;return e}function N(e,t){var i;switch(e){case"DDDD":return wt;case"YYYY":case"GGGG":case"gggg":return xt;case"YYYYY":case"GGGGG":case"ggggg":return kt;case"S":case"SS":case"SSS":case"DDD":return _t;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return St;case"a":case"A":return T(t._l)._meridiemParse;case"X":return At;case"Z":case"ZZ":return Tt;case"T":return Et;case"SSSS":return Ct;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return yt;default:return i=new RegExp(F(V(e.replace("\\","")),"i"))}}function O(e){var t=(Tt.exec(e)||[])[0],i=(t+"").match(It)||["-",0,0],n=+(60*i[1])+g(i[2]);return"+"===i[0]?-n:n}function I(e,t,i){var n,s=i._a;switch(e){case"M":case"MM":null!=t&&(s[at]=g(t)-1);break;case"MMM":case"MMMM":n=T(i._l).monthsParse(t),null!=n?s[at]=n:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(s[rt]=g(t));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=g(t));break;case"YY":s[ot]=g(t)+(g(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":s[ot]=g(t);break;case"a":case"A":i._isPm=T(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":s[lt]=g(t);break;case"m":case"mm":s[ct]=g(t);break;case"s":case"ss":s[ut]=g(t);break;case"S":case"SS":case"SSS":case"SSSS":s[dt]=g(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=O(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=t)}}function D(e){var t,i,n,s,o,a,r,l,c,u,d=[];if(!e._d){for(n=P(e),e._w&&null==e._a[rt]&&null==e._a[at]&&(o=function(t){return t?t.length<3?parseInt(t,10)>68?"19"+t:"20"+t:t:null==e._a[ot]?tt().weekYear():e._a[ot]},a=e._w,null!=a.GG||null!=a.W||null!=a.E?r=J(o(a.GG),a.W||1,a.E,4,1):(l=T(e._l),c=null!=a.d?U(a.d,l):null!=a.e?parseInt(a.e,10)+l._week.dow:0,u=parseInt(a.w,10)||1,null!=a.d&&c<l._week.dow&&u++,r=J(o(a.gg),u,c,l._week.doy,l._week.dow)),e._a[ot]=r.year,e._dayOfYear=r.dayOfYear),e._dayOfYear&&(s=null==e._a[ot]?n[ot]:e._a[ot],e._dayOfYear>b(s)&&(e._pf._overflowDayOfYear=!0),i=q(s,0,e._dayOfYear),e._a[at]=i.getUTCMonth(),e._a[rt]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=d[t]=n[t];for(;7>t;t++)e._a[t]=d[t]=null==e._a[t]?2===t?1:0:e._a[t];d[lt]+=g((e._tzm||0)/60),d[ct]+=g((e._tzm||0)%60),e._d=(e._useUTC?q:j).apply(null,d)}}function R(e){var t;e._d||(t=f(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],D(e))}function P(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function L(e){e._a=[],e._pf.empty=!0;var t,i,n,s,o,a=T(e._l),r=""+e._i,l=r.length,c=0;for(n=M(e._f,a).match(vt)||[],t=0;t<n.length;t++)s=n[t],i=(N(s,e).exec(r)||[])[0],i&&(o=r.substr(0,r.indexOf(i)),o.length>0&&e._pf.unusedInput.push(o),r=r.slice(r.indexOf(i)+i.length),c+=i.length),Ht[s]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(s),I(s,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(s);e._pf.charsLeftOver=l-c,r.length>0&&e._pf.unusedInput.push(r),e._isPm&&e._a[lt]<12&&(e._a[lt]+=12),e._isPm===!1&&12===e._a[lt]&&(e._a[lt]=0),D(e),_(e)}function V(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,s){return t||i||n||s})}function F(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function B(e){var t,i,n,s,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(s=0;s<e._f.length;s++)o=0,t=a({},e),w(t),t._f=e._f[s],L(t),x(t)&&(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,(null==n||n>o)&&(n=o,i=t));a(e,i||t)}function H(e){var t,i=e._i,n=$t.exec(i);if(n){for(e._pf.iso=!0,t=4;t>0;t--)if(n[t]){e._f=Nt[t-1]+(n[6]||" ");break}for(t=0;4>t;t++)if(Ot[t][1].exec(i)){e._f+=Ot[t][0];break}Tt.exec(i)&&(e._f+="Z"),L(e)}else e._d=new Date(i)}function z(t){var i=t._i,n=ft.exec(i);i===e?t._d=new Date:n?t._d=new Date(+n[1]):"string"==typeof i?H(t):u(i)?(t._a=i.slice(0),D(t)):d(i)?t._d=new Date(+i):"object"==typeof i?R(t):t._d=new Date(i)}function j(e,t,i,n,s,o,a){var r=new Date(e,t,i,n,s,o,a);return 1970>e&&r.setFullYear(e),r
}function q(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function U(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function W(e,t,i,n,s){return s.relativeTime(t||1,!!i,e,n)}function Y(e,t,i){var n=st(Math.abs(e)/1e3),s=st(n/60),o=st(s/60),a=st(o/24),r=st(a/365),l=45>n&&["s",n]||1===s&&["m"]||45>s&&["mm",s]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",st(a/30)]||1===r&&["y"]||["yy",r];return l[2]=t,l[3]=e>0,l[4]=i,W.apply({},l)}function G(e,t,i){var n,s=i-t,o=i-e.day();return o>s&&(o-=7),s-7>o&&(o+=7),n=tt(e).add("d",o),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function J(e,t,i,n,s){var o,a,r=new Date(Date.UTC(e,0)).getUTCDay();return i=null!=i?i:s,o=s-r+(r>n?7:0),a=7*(t-1)+(i-s)+o+1,{year:a>0?e:e-1,dayOfYear:a>0?a:b(e-1)+a}}function K(e){var t=e._i,i=e._f;return"undefined"==typeof e._pf&&w(e),null===t?tt.invalid({nullInput:!0}):("string"==typeof t&&(e._i=t=T().preparse(t)),tt.isMoment(t)?(e=a({},t),e._d=new Date(+t._d)):i?u(i)?B(e):L(e):z(e),new s(e))}function Q(e,t){tt.fn[e]=tt.fn[e+"s"]=function(e){var i=this._isUTC?"UTC":"";return null!=e?(this._d["set"+i+t](e),tt.updateOffset(this),this):this._d["get"+i+t]()}}function X(e){tt.duration.fn[e]=function(){return this._data[e]}}function Z(e,t){tt.duration.fn["as"+e]=function(){return+this/t}}function et(e){var t=!1,i=tt;"undefined"==typeof ender&&(this.moment=e?function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)}:tt)}for(var tt,it,nt="2.4.0",st=Math.round,ot=0,at=1,rt=2,lt=3,ct=4,ut=5,dt=6,ht={},pt="undefined"!=typeof module&&module.exports,ft=/^\/?Date\((\-?\d+)/i,mt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,gt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,vt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,bt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,yt=/\d\d?/,_t=/\d{1,3}/,wt=/\d{3}/,xt=/\d{1,4}/,kt=/[+\-]?\d{1,6}/,Ct=/\d+/,St=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Tt=/Z|[\+\-]\d\d:?\d\d/i,Et=/T/i,At=/[\+\-]?\d+(\.\d{1,3})?/,$t=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,Mt="YYYY-MM-DDTHH:mm:ssZ",Nt=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Ot=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],It=/([\+\-]|\d\d)/gi,Dt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Rt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Pt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Lt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Vt={},Ft="DDD w W M D d".split(" "),Bt="M D H h m s w W".split(" "),Ht={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return g(this.milliseconds()/100)},SS:function(){return l(g(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},SSSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(e/60),2)+":"+l(g(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},zt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Ft.length;)it=Ft.pop(),Ht[it+"o"]=i(Ht[it],it);for(;Bt.length;)it=Bt.pop(),Ht[it+it]=t(Ht[it],2);for(Ht.DDDD=t(Ht.DDD,3),a(n.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=tt.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=tt([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var s=this._relativeTime[i];return"function"==typeof s?s(e,t,i,n):s.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return G(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),tt=function(t,i,n,s){return"boolean"==typeof n&&(s=n,n=e),K({_i:t,_f:i,_l:n,_strict:s,_isUTC:!1})},tt.utc=function(t,i,n,s){var o;return"boolean"==typeof n&&(s=n,n=e),o=K({_useUTC:!0,_isUTC:!0,_l:n,_i:t,_f:i,_strict:s}).utc()},tt.unix=function(e){return tt(1e3*e)},tt.duration=function(e,t){var i,n,s,a=tt.isDuration(e),r="number"==typeof e,l=a?e._input:r?{}:e,c=null;return r?t?l[t]=e:l.milliseconds=e:(c=mt.exec(e))?(i="-"===c[1]?-1:1,l={y:0,d:g(c[rt])*i,h:g(c[lt])*i,m:g(c[ct])*i,s:g(c[ut])*i,ms:g(c[dt])*i}):(c=gt.exec(e))&&(i="-"===c[1]?-1:1,s=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},l={y:s(c[2]),M:s(c[3]),d:s(c[4]),h:s(c[5]),m:s(c[6]),s:s(c[7]),w:s(c[8])}),n=new o(l),a&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},tt.version=nt,tt.defaultFormat=Mt,tt.updateOffset=function(){},tt.lang=function(e,t){var i;return e?(t?C(k(e),t):null===t?(S(e),e="en"):ht[e]||T(e),i=tt.duration.fn._lang=tt.fn._lang=T(e),i._abbr):tt.fn._lang._abbr},tt.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),T(e)},tt.isMoment=function(e){return e instanceof s},tt.isDuration=function(e){return e instanceof o},it=zt.length-1;it>=0;--it)m(zt[it]);for(tt.normalizeUnits=function(e){return p(e)},tt.invalid=function(e){var t=tt.utc(0/0);return null!=e?a(t._pf,e):t._pf.userInvalidated=!0,t},tt.parseZone=function(e){return tt(e).parseZone()},a(tt.fn=s.prototype,{clone:function(){return tt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return $(tt(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return x(this)},isDSTShifted:function(){return this._a?this.isValid()&&h(this._a,(this._isUTC?tt.utc(this._a):tt(this._a)).toArray())>0:!1},parsingFlags:function(){return a({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=$(this,e||tt.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),c(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),c(this,i,-1),this},diff:function(e,t,i){var n,s,o=this._isUTC?tt(e).zone(this._offset||0):tt(e).local(),a=6e4*(this.zone()-o.zone());return t=p(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+o.daysInMonth()),s=12*(this.year()-o.year())+(this.month()-o.month()),s+=(this-tt(this).startOf("month")-(o-tt(o).startOf("month")))/n,s-=6e4*(this.zone()-tt(this).startOf("month").zone()-(o.zone()-tt(o).startOf("month").zone()))/n,"year"===t&&(s/=12)):(n=this-o,s="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-a)/864e5:"week"===t?(n-a)/6048e5:n),i?s:r(s)},from:function(e,t){return tt.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(tt(),e)},calendar:function(){var e=this.diff(tt().zone(this.zone()).startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){return y(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=U(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,i=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+i+"Month"](e),this.date(Math.min(t,this.daysInMonth())),tt.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(e){switch(e=p(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=p(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+tt(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+tt(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+tt(e).startOf(t)},min:function(e){return e=tt.apply(null,arguments),this>e?this:e},max:function(e){return e=tt.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=O(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&c(this,tt.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?tt(e).zone():0,0===(this.zone()-e)%60},daysInMonth:function(){return v(this.year(),this.month())},dayOfYear:function(e){var t=st((tt(this).startOf("day")-tt(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=G(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=G(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=G(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=p(e),this[e]()},set:function(e,t){return e=p(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=T(t),this)}}),it=0;it<Dt.length;it++)Q(Dt[it].toLowerCase().replace(/s$/,""),Dt[it]);Q("year","FullYear"),tt.fn.days=tt.fn.day,tt.fn.months=tt.fn.month,tt.fn.weeks=tt.fn.week,tt.fn.isoWeeks=tt.fn.isoWeek,tt.fn.toJSON=tt.fn.toISOString,a(tt.duration.fn=o.prototype,{_bubble:function(){var e,t,i,n,s=this._milliseconds,o=this._days,a=this._months,l=this._data;l.milliseconds=s%1e3,e=r(s/1e3),l.seconds=e%60,t=r(e/60),l.minutes=t%60,i=r(t/60),l.hours=i%24,o+=r(i/24),l.days=o%30,a+=r(o/30),l.months=a%12,n=r(a/12),l.years=n},weeks:function(){return r(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*g(this._months/12)},humanize:function(e){var t=+this,i=Y(t,!e,this.lang());return e&&(i=this.lang().pastFuture(t,i)),this.lang().postformat(i)},add:function(e,t){var i=tt.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=tt.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=p(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=p(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:tt.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),s=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||s||o?"T":"")+(n?n+"H":"")+(s?s+"M":"")+(o?o+"S":""):"P0D"}});for(it in Rt)Rt.hasOwnProperty(it)&&(Z(it,Rt[it]),X(it.toLowerCase()));Z("Weeks",6048e5),tt.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},tt.lang("en",{ordinal:function(e){var t=e%10,i=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),pt?(module.exports=tt,et(!0)):"function"==typeof define&&define.amd?define("moment",["require","exports","module"],function(t,i,n){return n.config().noGlobal!==!0&&et(n.config().noGlobal===e),tt}):et()}.call(this),define("typetools",["moment"],function(e){var t={numberWithCommas:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},capitalize:function(e,i,n){var s;if(!e)return"";void 0===i&&(i="_");var o=e.indexOf("directus_");0!==o||n||(e=e.substring(9)),s=e.lastIndexOf("_id"),e.length>2&&e.length-s===3&&(e=e.substring(0,s));var a=_.map(e.split(i),function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" ");return _.each(t.caseSpecial,function(e){a=a.replace(new RegExp("\\b"+e+"\\b","gi"),e)}),_.each(t.caseLower,function(e){a=a.replace(new RegExp(" "+e+"\\b","gi")," "+e)}),a},caseSpecial:["CMS","FAQ","iPhone","iPad","iPod","iOS","iMac","PDF","PDFs","URL","IP","UI","FTP","DB","WYSIWYG","CV","ID","pH","PHP","HTML","JS","CSS","SKU","DateTime","RNGR","CC","CCV"],caseLower:["a","an","the","and","of","but","or","for","nor","with","on","at","to","from","by"],actionMap:{ADD:"added",DELETE:"deleted",UPDATE:"updated"},prepositionMap:{ADD:"to",DELETE:"from",UPDATE:"within"},bytesToSize:function(e,t){var i=["Bytes","KB","MB","GB","TB"],n=0;if(e=parseInt(e,10),0===e)return"n/a";for(;e>=1024;)n++,e/=1024;return e.toFixed(t)+" "+i[n]},seconds_convert:function(e){var t=Math.floor(e/60);return e%=60,e=10>e?"0"+e:e,t+":"+e},contextualDate:function(t){return void 0===t?"":(t="z"==t.substr(-1).toLowerCase()?t:t+"z",e(t).fromNow())},dateYYYYMMDD:function(e){return e.toISOString().slice(0,10)},replaceAll:function(e,t,i){return i.replace(new RegExp(e,"g"),t)}};return t}),function(){var e=this,t=e._,i={},n=Array.prototype,s=Object.prototype,o=Function.prototype,a=n.push,r=n.slice,l=n.concat,c=s.toString,u=s.hasOwnProperty,d=n.forEach,h=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,b=n.indexOf,y=n.lastIndexOf,_=Array.isArray,w=Object.keys,x=o.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.4.4";var C=k.each=k.forEach=function(e,t,n){if(null!=e)if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var s=0,o=e.length;o>s;s++)if(t.call(n,e[s],s,e)===i)return}else for(var a in e)if(k.has(e,a)&&t.call(n,e[a],a,e)===i)return};k.map=k.collect=function(e,t,i){var n=[];return null==e?n:h&&e.map===h?e.map(t,i):(C(e,function(e,s,o){n[n.length]=t.call(i,e,s,o)}),n)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=k.bind(t,n)),s?e.reduce(t,i):e.reduce(t);if(C(e,function(e,o,a){s?i=t.call(n,i,e,o,a):(i=e,s=!0)}),!s)throw new TypeError(S);return i},k.reduceRight=k.foldr=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=k.bind(t,n)),s?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var a=k.keys(e);o=a.length}if(C(e,function(r,l,c){l=a?a[--o]:--o,s?i=t.call(n,i,e[l],l,c):(i=e[l],s=!0)}),!s)throw new TypeError(S);return i},k.find=k.detect=function(e,t,i){var n;return T(e,function(e,s,o){return t.call(i,e,s,o)?(n=e,!0):void 0}),n},k.filter=k.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(C(e,function(e,s,o){t.call(i,e,s,o)&&(n[n.length]=e)}),n)},k.reject=function(e,t,i){return k.filter(e,function(e,n,s){return!t.call(i,e,n,s)},i)},k.every=k.all=function(e,t,n){t||(t=k.identity);var s=!0;return null==e?s:g&&e.every===g?e.every(t,n):(C(e,function(e,o,a){return(s=s&&t.call(n,e,o,a))?void 0:i}),!!s)};var T=k.some=k.any=function(e,t,n){t||(t=k.identity);var s=!1;return null==e?s:v&&e.some===v?e.some(t,n):(C(e,function(e,o,a){return s||(s=t.call(n,e,o,a))?i:void 0}),!!s)};k.contains=k.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):T(e,function(e){return e===t})},k.invoke=function(e,t){var i=r.call(arguments,2),n=k.isFunction(t);return k.map(e,function(e){return(n?t:e[t]).apply(e,i)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,i){return k.isEmpty(t)?i?void 0:[]:k[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return C(e,function(e,s,o){var a=t?t.call(i,e,s,o):e;a>=n.computed&&(n={value:e,computed:a})}),n.value},k.min=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return C(e,function(e,s,o){var a=t?t.call(i,e,s,o):e;a<n.computed&&(n={value:e,computed:a})}),n.value},k.shuffle=function(e){var t,i=0,n=[];return C(e,function(e){t=k.random(i++),n[i-1]=n[t],n[t]=e}),n};var E=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,i){var n=E(t);return k.pluck(k.map(e,function(e,t,s){return{value:e,index:t,criteria:n.call(i,e,t,s)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var A=function(e,t,i,n){var s={},o=E(t||k.identity);return C(e,function(t,a){var r=o.call(i,t,a,e);n(s,r,t)}),s};k.groupBy=function(e,t,i){return A(e,t,i,function(e,t,i){(k.has(e,t)?e[t]:e[t]=[]).push(i)})},k.countBy=function(e,t,i){return A(e,t,i,function(e,t){k.has(e,t)||(e[t]=0),e[t]++})},k.sortedIndex=function(e,t,i,n){i=null==i?k.identity:E(i);for(var s=i.call(n,t),o=0,a=e.length;a>o;){var r=o+a>>>1;i.call(n,e[r])<s?o=r+1:a=r}return o},k.toArray=function(e){return e?k.isArray(e)?r.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:r.call(e,0,t)},k.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},k.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,i){return r.call(e,null==t||i?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var $=function(e,t,i){return C(e,function(e){k.isArray(e)?t?a.apply(i,e):$(e,t,i):i.push(e)}),i};k.flatten=function(e,t){return $(e,t,[])},k.without=function(e){return k.difference(e,r.call(arguments,1))},k.uniq=k.unique=function(e,t,i,n){k.isFunction(t)&&(n=i,i=t,t=!1);var s=i?k.map(e,i,n):e,o=[],a=[];return C(s,function(i,n){(t?n&&a[a.length-1]===i:k.contains(a,i))||(a.push(i),o.push(e[n]))}),o},k.union=function(){return k.uniq(l.apply(n,arguments))},k.intersection=function(e){var t=r.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=l.apply(n,r.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=r.call(arguments),t=k.max(k.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=k.pluck(e,""+n);return i},k.object=function(e,t){if(null==e)return{};for(var i={},n=0,s=e.length;s>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},k.indexOf=function(e,t,i){if(null==e)return-1;var n=0,s=e.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,s+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;s>n;n++)if(e[n]===t)return n;return-1},k.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(y&&e.lastIndexOf===y)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var s=n?i:e.length;s--;)if(e[s]===t)return s;return-1},k.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=0,o=new Array(n);n>s;)o[s++]=e,e+=i;return o},k.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}},k.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}},k.bindAll=function(e){var t=r.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var i={};return t||(t=k.identity),function(){var n=t.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},k.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(r.call(arguments,1)))},k.throttle=function(e,t){var i,n,s,o,a=0,r=function(){a=new Date,s=null,o=e.apply(i,n)};return function(){var l=new Date,c=t-(l-a);return i=this,n=arguments,0>=c?(clearTimeout(s),s=null,a=l,o=e.apply(i,n)):s||(s=setTimeout(r,c)),o}},k.debounce=function(e,t,i){var n,s;return function(){var o=this,a=arguments,r=function(){n=null,i||(s=e.apply(o,a))},l=i&&!n;return clearTimeout(n),n=setTimeout(r,t),l&&(s=e.apply(o,a)),s}},k.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var i=[e];return a.apply(i,arguments),t.apply(this,i)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},k.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)k.has(e,i)&&(t[t.length]=i);return t},k.values=function(e){var t=[];for(var i in e)k.has(e,i)&&t.push(e[i]);return t},k.pairs=function(e){var t=[];for(var i in e)k.has(e,i)&&t.push([i,e[i]]);return t},k.invert=function(e){var t={};for(var i in e)k.has(e,i)&&(t[e[i]]=i);return t},k.functions=k.methods=function(e){var t=[];for(var i in e)k.isFunction(e[i])&&t.push(i);return t.sort()},k.extend=function(e){return C(r.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},k.pick=function(e){var t={},i=l.apply(n,r.call(arguments,1));return C(i,function(i){i in e&&(t[i]=e[i])}),t},k.omit=function(e){var t={},i=l.apply(n,r.call(arguments,1));for(var s in e)k.contains(i,s)||(t[s]=e[s]);return t},k.defaults=function(e){return C(r.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var M=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var s=c.call(e);if(s!=c.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;i.push(e),n.push(t);var a=0,r=!0;if("[object Array]"==s){if(a=e.length,r=a==t.length)for(;a--&&(r=M(e[a],t[a],i,n)););}else{var l=e.constructor,u=t.constructor;if(l!==u&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(u)&&u instanceof u))return!1;for(var d in e)if(k.has(e,d)&&(a++,!(r=k.has(t,d)&&M(e[d],t[d],i,n))))break;if(r){for(d in t)if(k.has(t,d)&&!a--)break;r=!a}}return i.pop(),n.pop(),r};k.isEqual=function(e,t){return M(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=_||function(e){return"[object Array]"==c.call(e)},k.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return u.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,i){for(var n=Array(e),s=0;e>s;s++)n[s]=t.call(i,s);return n},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=k.invert(N.escape);var O={escape:new RegExp("["+k.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(N.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(O[e],function(t){return N[e][t]})}}),k.result=function(e,t){if(null==e)return void 0;var i=e[t];return k.isFunction(i)?i.call(e):i},k.mixin=function(e){C(k.functions(e),function(t){var i=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),L.call(this,i.apply(k,e))}})};var I=0;k.uniqueId=function(e){var t=++I+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,i){var n;i=k.defaults({},i,k.templateSettings);var s=new RegExp([(i.escape||D).source,(i.interpolate||D).source,(i.evaluate||D).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(s,function(t,i,n,s,r){return a+=e.slice(o,r).replace(P,function(e){return"\\"+R[e]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(a+="';\n"+s+"\n__p+='"),o=r+t.length,t}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(r){throw r.source=a,r}if(t)return n(t,k);var l=function(e){return n.call(this,e,k)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},k.chain=function(e){return k(e).chain()};var L=function(e){return this._chain?k(e).chain():e};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];k.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],L.call(this,i)}}),C(["concat","join","slice"],function(e){var t=n[e];k.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t;return t||e._}}(this)),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t=e.length,i=ot.type(e);
return"function"===i||ot.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(ot.isFunction(t))return ot.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ot.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(pt.test(t))return ot.filter(t,e,i);t=ot.filter(t,e)}return ot.grep(e,function(e){return ot.inArray(e,t)>=0!==i})}function s(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function o(e){var t=wt[e]={};return ot.each(e.match(_t)||[],function(e,i){t[i]=!0}),t}function a(){mt.addEventListener?(mt.removeEventListener("DOMContentLoaded",r,!1),e.removeEventListener("load",r,!1)):(mt.detachEvent("onreadystatechange",r),e.detachEvent("onload",r))}function r(){(mt.addEventListener||"load"===event.type||"complete"===mt.readyState)&&(a(),ot.ready())}function l(e,t,i){if(void 0===i&&1===e.nodeType){var n="data-"+t.replace(Tt,"-$1").toLowerCase();if(i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:St.test(i)?ot.parseJSON(i):i}catch(s){}ot.data(e,t,i)}else i=void 0}return i}function c(e){var t;for(t in e)if(("data"!==t||!ot.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function u(e,t,i,n){if(ot.acceptData(e)){var s,o,a=ot.expando,r=e.nodeType,l=r?ot.cache:e,c=r?e[a]:e[a]&&a;if(c&&l[c]&&(n||l[c].data)||void 0!==i||"string"!=typeof t)return c||(c=r?e[a]=G.pop()||ot.guid++:a),l[c]||(l[c]=r?{}:{toJSON:ot.noop}),("object"==typeof t||"function"==typeof t)&&(n?l[c]=ot.extend(l[c],t):l[c].data=ot.extend(l[c].data,t)),o=l[c],n||(o.data||(o.data={}),o=o.data),void 0!==i&&(o[ot.camelCase(t)]=i),"string"==typeof t?(s=o[t],null==s&&(s=o[ot.camelCase(t)])):s=o,s}}function d(e,t,i){if(ot.acceptData(e)){var n,s,o=e.nodeType,a=o?ot.cache:e,r=o?e[ot.expando]:ot.expando;if(a[r]){if(t&&(n=i?a[r]:a[r].data)){ot.isArray(t)?t=t.concat(ot.map(t,ot.camelCase)):t in n?t=[t]:(t=ot.camelCase(t),t=t in n?[t]:t.split(" ")),s=t.length;for(;s--;)delete n[t[s]];if(i?!c(n):!ot.isEmptyObject(n))return}(i||(delete a[r].data,c(a[r])))&&(o?ot.cleanData([e],!0):nt.deleteExpando||a!=a.window?delete a[r]:a[r]=null)}}}function h(){return!0}function p(){return!1}function f(){try{return mt.activeElement}catch(e){}}function m(e){var t=Lt.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function g(e,t){var i,n,s=0,o=typeof e.getElementsByTagName!==Ct?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==Ct?e.querySelectorAll(t||"*"):void 0;if(!o)for(o=[],i=e.childNodes||e;null!=(n=i[s]);s++)!t||ot.nodeName(n,t)?o.push(n):ot.merge(o,g(n,t));return void 0===t||t&&ot.nodeName(e,t)?ot.merge([e],o):o}function v(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t){return ot.nodeName(e,"table")&&ot.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function y(e){return e.type=(null!==ot.find.attr(e,"type"))+"/"+e.type,e}function _(e){var t=Gt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function w(e,t){for(var i,n=0;null!=(i=e[n]);n++)ot._data(i,"globalEval",!t||ot._data(t[n],"globalEval"))}function x(e,t){if(1===t.nodeType&&ot.hasData(e)){var i,n,s,o=ot._data(e),a=ot._data(t,o),r=o.events;if(r){delete a.handle,a.events={};for(i in r)for(n=0,s=r[i].length;s>n;n++)ot.event.add(t,i,r[i][n])}a.data&&(a.data=ot.extend({},a.data))}}function k(e,t){var i,n,s;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!nt.noCloneEvent&&t[ot.expando]){s=ot._data(t);for(n in s.events)ot.removeEvent(t,n,s.handle);t.removeAttribute(ot.expando)}"script"===i&&t.text!==e.text?(y(t).text=e.text,_(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),nt.html5Clone&&e.innerHTML&&!ot.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function C(t,i){var n=ot(i.createElement(t)).appendTo(i.body),s=e.getDefaultComputedStyle?e.getDefaultComputedStyle(n[0]).display:ot.css(n[0],"display");return n.detach(),s}function S(e){var t=mt,i=ei[e];return i||(i=C(e,t),"none"!==i&&i||(Zt=(Zt||ot("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Zt[0].contentWindow||Zt[0].contentDocument).document,t.write(),t.close(),i=C(e,t),Zt.detach()),ei[e]=i),i}function T(e,t){return{get:function(){var i=e();return null!=i?i?void delete this.get:(this.get=t).apply(this,arguments):void 0}}}function E(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,s=pi.length;s--;)if(t=pi[s]+i,t in e)return t;return n}function A(e,t){for(var i,n,s,o=[],a=0,r=e.length;r>a;a++)n=e[a],n.style&&(o[a]=ot._data(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&$t(n)&&(o[a]=ot._data(n,"olddisplay",S(n.nodeName)))):o[a]||(s=$t(n),(i&&"none"!==i||!s)&&ot._data(n,"olddisplay",s?i:ot.css(n,"display"))));for(a=0;r>a;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function $(e,t,i){var n=ci.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function M(e,t,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=ot.css(e,i+At[o],!0,s)),n?("content"===i&&(a-=ot.css(e,"padding"+At[o],!0,s)),"margin"!==i&&(a-=ot.css(e,"border"+At[o]+"Width",!0,s))):(a+=ot.css(e,"padding"+At[o],!0,s),"padding"!==i&&(a+=ot.css(e,"border"+At[o]+"Width",!0,s)));return a}function N(e,t,i){var n=!0,s="width"===t?e.offsetWidth:e.offsetHeight,o=ti(e),a=nt.boxSizing()&&"border-box"===ot.css(e,"boxSizing",!1,o);if(0>=s||null==s){if(s=ii(e,t,o),(0>s||null==s)&&(s=e.style[t]),si.test(s))return s;n=a&&(nt.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+M(e,t,i||(a?"border":"content"),n,o)+"px"}function O(e,t,i,n,s){return new O.prototype.init(e,t,i,n,s)}function I(){return setTimeout(function(){fi=void 0}),fi=ot.now()}function D(e,t){var i,n={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)i=At[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function R(e,t,i){for(var n,s=(_i[t]||[]).concat(_i["*"]),o=0,a=s.length;a>o;o++)if(n=s[o].call(i,t,e))return n}function P(e,t,i){var n,s,o,a,r,l,c,u,d=this,h={},p=e.style,f=e.nodeType&&$t(e),m=ot._data(e,"fxshow");i.queue||(r=ot._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always(function(){d.always(function(){r.unqueued--,ot.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],c=ot.css(e,"display"),u=S(e.nodeName),"none"===c&&(c=u),"inline"===c&&"none"===ot.css(e,"float")&&(nt.inlineBlockNeedsLayout&&"inline"!==u?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",nt.shrinkWrapBlocks()||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in t)if(s=t[n],gi.exec(s)){if(delete t[n],o=o||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;f=!0}h[n]=m&&m[n]||ot.style(e,n)}if(!ot.isEmptyObject(h)){m?"hidden"in m&&(f=m.hidden):m=ot._data(e,"fxshow",{}),o&&(m.hidden=!f),f?ot(e).show():d.done(function(){ot(e).hide()}),d.done(function(){var t;ot._removeData(e,"fxshow");for(t in h)ot.style(e,t,h[t])});for(n in h)a=R(f?m[n]:0,n,d),n in m||(m[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function L(e,t){var i,n,s,o,a;for(i in e)if(n=ot.camelCase(i),s=t[n],o=e[i],ot.isArray(o)&&(s=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),a=ot.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=s)}else t[n]=s}function V(e,t,i){var n,s,o=0,a=yi.length,r=ot.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=fi||I(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,o=1-n,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(o);return r.notifyWith(e,[c,o,i]),1>o&&l?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:ot.extend({},t),opts:ot.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:fi||I(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ot.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)c.tweens[i].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),u=c.props;for(L(u,c.opts.specialEasing);a>o;o++)if(n=yi[o].call(c,e,u,c.opts))return n;return ot.map(u,R,c),ot.isFunction(c.opts.start)&&c.opts.start.call(e,c),ot.fx.timer(ot.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function F(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,o=t.toLowerCase().match(_t)||[];if(ot.isFunction(i))for(;n=o[s++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function B(e,t,i,n){function s(r){var l;return o[r]=!0,ot.each(e[r]||[],function(e,r){var c=r(t,i,n);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),l}var o={},a=e===qi;return s(t.dataTypes[0])||!o["*"]&&s("*")}function H(e,t){var i,n,s=ot.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((s[n]?e:i||(i={}))[n]=t[n]);return i&&ot.extend(!0,e,i),e}function z(e,t,i){for(var n,s,o,a,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(a in r)if(r[a]&&r[a].test(s)){l.unshift(a);break}if(l[0]in i)o=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){o=a;break}n||(n=a)}o=o||n}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function j(e,t,i,n){var s,o,a,r,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=c[l+" "+o]||c["* "+o],!a)for(s in c)if(r=s.split(" "),r[1]===o&&(a=c[l+" "+r[0]]||c["* "+r[0]])){a===!0?a=c[s]:c[s]!==!0&&(o=r[0],u.unshift(r[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function q(e,t,i,n){var s;if(ot.isArray(t))ot.each(t,function(t,s){i||Gi.test(e)?n(e,s):q(e+"["+("object"==typeof s?t:"")+"]",s,i,n)});else if(i||"object"!==ot.type(t))n(e,t);else for(s in t)q(e+"["+s+"]",t[s],i,n)}function U(){try{return new e.XMLHttpRequest}catch(t){}}function W(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Y(e){return ot.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var G=[],J=G.slice,K=G.concat,Q=G.push,X=G.indexOf,Z={},et=Z.toString,tt=Z.hasOwnProperty,it="".trim,nt={},st="1.11.0",ot=function(e,t){return new ot.fn.init(e,t)},at=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^-ms-/,lt=/-([\da-z])/gi,ct=function(e,t){return t.toUpperCase()};ot.fn=ot.prototype={jquery:st,constructor:ot,selector:"",length:0,toArray:function(){return J.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:J.call(this)},pushStack:function(e){var t=ot.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ot.each(this,e,t)},map:function(e){return this.pushStack(ot.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(J.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Q,sort:G.sort,splice:G.splice},ot.extend=ot.fn.extend=function(){var e,t,i,n,s,o,a=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[r]||{},r++),"object"==typeof a||ot.isFunction(a)||(a={}),r===l&&(a=this,r--);l>r;r++)if(null!=(s=arguments[r]))for(n in s)e=a[n],i=s[n],a!==i&&(c&&i&&(ot.isPlainObject(i)||(t=ot.isArray(i)))?(t?(t=!1,o=e&&ot.isArray(e)?e:[]):o=e&&ot.isPlainObject(e)?e:{},a[n]=ot.extend(c,o,i)):void 0!==i&&(a[n]=i));return a},ot.extend({expando:"jQuery"+(st+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ot.type(e)},isArray:Array.isArray||function(e){return"array"===ot.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==ot.type(e)||e.nodeType||ot.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(nt.ownLast)for(t in e)return tt.call(e,t);for(t in e);return void 0===t||tt.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[et.call(e)]||"object":typeof e},globalEval:function(t){t&&ot.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(rt,"ms-").replace(lt,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var s,o=0,a=e.length,r=i(e);if(n){if(r)for(;a>o&&(s=t.apply(e[o],n),s!==!1);o++);else for(o in e)if(s=t.apply(e[o],n),s===!1)break}else if(r)for(;a>o&&(s=t.call(e[o],o,e[o]),s!==!1);o++);else for(o in e)if(s=t.call(e[o],o,e[o]),s===!1)break;return e},trim:it&&!it.call("﻿ ")?function(e){return null==e?"":it.call(e)}:function(e){return null==e?"":(e+"").replace(at,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?ot.merge(n,"string"==typeof e?[e]:e):Q.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(X)return X.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;i>n;)e[s++]=t[n++];if(i!==i)for(;void 0!==t[n];)e[s++]=t[n++];return e.length=s,e},grep:function(e,t,i){for(var n,s=[],o=0,a=e.length,r=!i;a>o;o++)n=!t(e[o],o),n!==r&&s.push(e[o]);return s},map:function(e,t,n){var s,o=0,a=e.length,r=i(e),l=[];if(r)for(;a>o;o++)s=t(e[o],o,n),null!=s&&l.push(s);else for(o in e)s=t(e[o],o,n),null!=s&&l.push(s);return K.apply([],l)},guid:1,proxy:function(e,t){var i,n,s;return"string"==typeof t&&(s=e[t],t=e,e=s),ot.isFunction(e)?(i=J.call(arguments,2),n=function(){return e.apply(t||this,i.concat(J.call(arguments)))},n.guid=e.guid=e.guid||ot.guid++,n):void 0},now:function(){return+new Date},support:nt}),ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var ut=function(e){function t(e,t,i,n){var s,o,a,r,l,c,d,f,m,g;if((t?t.ownerDocument||t:B)!==O&&N(t),t=t||O,i=i||[],!e||"string"!=typeof e)return i;if(1!==(r=t.nodeType)&&9!==r)return[];if(D&&!n){if(s=bt.exec(e))if(a=s[1]){if(9===r){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&V(t,o)&&o.id===a)return i.push(o),i}else{if(s[2])return Z.apply(i,t.getElementsByTagName(e)),i;if((a=s[3])&&k.getElementsByClassName&&t.getElementsByClassName)return Z.apply(i,t.getElementsByClassName(a)),i}if(k.qsa&&(!R||!R.test(e))){if(f=d=F,m=t,g=9===r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(d=t.getAttribute("id"))?f=d.replace(_t,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+p(c[l]);m=yt.test(e)&&u(t.parentNode)||t,g=c.join(",")}if(g)try{return Z.apply(i,m.querySelectorAll(g)),i}catch(v){}finally{d||t.removeAttribute("id")}}}return w(e.replace(lt,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[F]=!0,e}function s(e){var t=O.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=e.length;n--;)C.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(i,n){for(var s,o=e([],i.length,t),a=o.length;a--;)i[s=o[a]]&&(i[s]=!(n[s]=i[s]))})})}function u(e){return e&&typeof e.getElementsByTagName!==Y&&e}function d(){}function h(e,i){var n,s,o,a,r,l,c,u=q[e+" "];if(u)return i?0:u.slice(0);for(r=e,l=[],c=C.preFilter;r;){(!n||(s=ct.exec(r)))&&(s&&(r=r.slice(s[0].length)||r),l.push(o=[])),n=!1,(s=ut.exec(r))&&(n=s.shift(),o.push({value:n,type:s[0].replace(lt," ")}),r=r.slice(n.length));for(a in C.filter)!(s=ft[a].exec(r))||c[a]&&!(s=c[a](s))||(n=s.shift(),o.push({value:n,type:a,matches:s}),r=r.slice(n.length));if(!n)break}return i?r.length:r?t.error(e):q(e,l).slice(0)}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function f(e,t,i){var n=t.dir,s=i&&"parentNode"===n,o=z++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o)}:function(t,i,a){var r,l,c=[H,o];if(a){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||s){if(l=t[F]||(t[F]={}),(r=l[n])&&r[0]===H&&r[1]===o)return c[2]=r[2];if(l[n]=c,c[2]=e(t,i,a))return!0}}}function m(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function g(e,t,i,n,s){for(var o,a=[],r=0,l=e.length,c=null!=t;l>r;r++)(o=e[r])&&(!i||i(o,n,s))&&(a.push(o),c&&t.push(r));return a}function v(e,t,i,s,o,a){return s&&!s[F]&&(s=v(s)),o&&!o[F]&&(o=v(o,a)),n(function(n,a,r,l){var c,u,d,h=[],p=[],f=a.length,m=n||_(t||"*",r.nodeType?[r]:r,[]),v=!e||!n&&t?m:g(m,h,e,r,l),b=i?o||(n?e:f||s)?[]:a:v;if(i&&i(v,b,r,l),s)for(c=g(b,p),s(c,[],r,l),u=c.length;u--;)(d=c[u])&&(b[p[u]]=!(v[p[u]]=d));if(n){if(o||e){if(o){for(c=[],u=b.length;u--;)(d=b[u])&&c.push(v[u]=d);o(null,b=[],c,l)}for(u=b.length;u--;)(d=b[u])&&(c=o?tt.call(n,d):h[u])>-1&&(n[c]=!(a[c]=d))}}else b=g(b===a?b.splice(f,b.length):b),o?o(null,a,b,l):Z.apply(a,b)})}function b(e){for(var t,i,n,s=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],r=o?1:0,l=f(function(e){return e===t},a,!0),c=f(function(e){return tt.call(t,e)>-1},a,!0),u=[function(e,i,n){return!o&&(n||i!==A)||((t=i).nodeType?l(e,i,n):c(e,i,n))}];s>r;r++)if(i=C.relative[e[r].type])u=[f(m(u),i)];else{if(i=C.filter[e[r].type].apply(null,e[r].matches),i[F]){for(n=++r;s>n&&!C.relative[e[n].type];n++);return v(r>1&&m(u),r>1&&p(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(lt,"$1"),i,n>r&&b(e.slice(r,n)),s>n&&b(e=e.slice(n)),s>n&&p(e))}u.push(i)}return m(u)}function y(e,i){var s=i.length>0,o=e.length>0,a=function(n,a,r,l,c){var u,d,h,p=0,f="0",m=n&&[],v=[],b=A,y=n||o&&C.find.TAG("*",c),_=H+=null==b?1:Math.random()||.1,w=y.length;for(c&&(A=a!==O&&a);f!==w&&null!=(u=y[f]);f++){if(o&&u){for(d=0;h=e[d++];)if(h(u,a,r)){l.push(u);break}c&&(H=_)}s&&((u=!h&&u)&&p--,n&&m.push(u))}if(p+=f,s&&f!==p){for(d=0;h=i[d++];)h(m,v,a,r);if(n){if(p>0)for(;f--;)m[f]||v[f]||(v[f]=Q.call(l));v=g(v)}Z.apply(l,v),c&&!n&&v.length>0&&p+i.length>1&&t.uniqueSort(l)}return c&&(H=_,A=b),m};return s?n(a):a}function _(e,i,n){for(var s=0,o=i.length;o>s;s++)t(e,i[s],n);return n}function w(e,t,i,n){var s,o,a,r,l,c=h(e);if(!n&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&k.getById&&9===t.nodeType&&D&&C.relative[o[1].type]){if(t=(C.find.ID(a.matches[0].replace(wt,xt),t)||[])[0],!t)return i;e=e.slice(o.shift().value.length)}for(s=ft.needsContext.test(e)?0:o.length;s--&&(a=o[s],!C.relative[r=a.type]);)if((l=C.find[r])&&(n=l(a.matches[0].replace(wt,xt),yt.test(o[0].type)&&u(t.parentNode)||t))){if(o.splice(s,1),e=n.length&&p(o),!e)return Z.apply(i,n),i;break}}return E(e,c)(n,t,!D,i,yt.test(e)&&u(t.parentNode)||t),i}var x,k,C,S,T,E,A,$,M,N,O,I,D,R,P,L,V,F="sizzle"+-new Date,B=e.document,H=0,z=0,j=i(),q=i(),U=i(),W=function(e,t){return e===t&&(M=!0),0},Y="undefined",G=1<<31,J={}.hasOwnProperty,K=[],Q=K.pop,X=K.push,Z=K.push,et=K.slice,tt=K.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},it="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=st.replace("w","w#"),at="\\["+nt+"*("+st+")"+nt+"*(?:([*^$|!~]?=)"+nt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ot+")|)|)"+nt+"*\\]",rt=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+at.replace(3,8)+")*)|.*)\\)|)",lt=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=new RegExp("^"+nt+"*,"+nt+"*"),ut=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),dt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(rt),pt=new RegExp("^"+ot+"$"),ft={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+at),PSEUDO:new RegExp("^"+rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+it+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,_t=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),xt=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Z.apply(K=et.call(B.childNodes),B.childNodes),K[B.childNodes.length].nodeType}catch(kt){Z={apply:K.length?function(e,t){X.apply(e,et.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}k=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},N=t.setDocument=function(e){var t,i=e?e.ownerDocument||e:B,n=i.defaultView;return i!==O&&9===i.nodeType&&i.documentElement?(O=i,I=i.documentElement,D=!T(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){N()},!1):n.attachEvent&&n.attachEvent("onunload",function(){N()})),k.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),k.getElementsByTagName=s(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),k.getElementsByClassName=vt.test(i.getElementsByClassName)&&s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),k.getById=s(function(e){return I.appendChild(e).id=F,!i.getElementsByName||!i.getElementsByName(F).length}),k.getById?(C.find.ID=function(e,t){if(typeof t.getElementById!==Y&&D){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(wt,xt);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(wt,xt);return function(e){var i=typeof e.getAttributeNode!==Y&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=k.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==Y?t.getElementsByTagName(e):void 0}:function(e,t){var i,n=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[s++];)1===i.nodeType&&n.push(i);return n}return o},C.find.CLASS=k.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==Y&&D?t.getElementsByClassName(e):void 0},P=[],R=[],(k.qsa=vt.test(i.querySelectorAll))&&(s(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&R.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+nt+"*(?:value|"+it+")"),e.querySelectorAll(":checked").length||R.push(":checked")}),s(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+nt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(k.matchesSelector=vt.test(L=I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&s(function(e){k.disconnectedMatch=L.call(e,"div"),L.call(e,"[s!='']:x"),P.push("!=",rt)}),R=R.length&&new RegExp(R.join("|")),P=P.length&&new RegExp(P.join("|")),t=vt.test(I.compareDocumentPosition),V=t||vt.test(I.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return M=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!k.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===B&&V(B,e)?-1:t===i||t.ownerDocument===B&&V(B,t)?1:$?tt.call($,e)-tt.call($,t):0:4&n?-1:1)}:function(e,t){if(e===t)return M=!0,0;var n,s=0,o=e.parentNode,r=t.parentNode,l=[e],c=[t];if(!o||!r)return e===i?-1:t===i?1:o?-1:r?1:$?tt.call($,e)-tt.call($,t):0;if(o===r)return a(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[s]===c[s];)s++;return s?a(l[s],c[s]):l[s]===B?-1:c[s]===B?1:0},i):O},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==O&&N(e),i=i.replace(dt,"='$1']"),!(!k.matchesSelector||!D||P&&P.test(i)||R&&R.test(i)))try{var n=L.call(e,i);if(n||k.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(s){}return t(i,O,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==O&&N(e),V(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==O&&N(e);var i=C.attrHandle[t.toLowerCase()],n=i&&J.call(C.attrHandle,t.toLowerCase())?i(e,t,!D):void 0;return void 0!==n?n:k.attributes||!D?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,s=0;if(M=!k.detectDuplicates,$=!k.sortStable&&e.slice(0),e.sort(W),M){for(;t=e[s++];)t===e[s]&&(n=i.push(s));for(;n--;)e.splice(i[n],1)}return $=null,e},S=t.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n++];)i+=S(t);return i},C=t.selectors={cacheLength:50,createPseudo:n,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(wt,xt),e[3]=(e[4]||e[5]||"").replace(wt,xt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:i&&ht.test(i)&&(t=h(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(wt,xt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=new RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&j(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Y&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(s){var o=t.attr(s,e);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,s){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var c,u,d,h,p,f,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r;if(g){if(o){for(;m;){for(d=t;d=d[m];)if(r?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&b){for(u=g[F]||(g[F]={}),c=u[e]||[],p=c[0]===H&&c[1],h=c[0]===H&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(h=p=0)||f.pop();)if(1===d.nodeType&&++h&&d===t){u[e]=[H,p,h];break}}else if(b&&(c=(t[F]||(t[F]={}))[e])&&c[0]===H)h=c[1];else for(;(d=++p&&d&&d[m]||(h=p=0)||f.pop())&&((r?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(b&&((d[F]||(d[F]={}))[e]=[H,h]),d!==t)););return h-=s,h===n||h%n===0&&h/n>=0}}},PSEUDO:function(e,i){var s,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[F]?o(i):o.length>1?(s=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,s=o(e,i),a=s.length;a--;)n=tt.call(e,s[a]),e[n]=!(t[n]=s[a])}):function(e){return o(e,0,s)}):o}},pseudos:{not:n(function(e){var t=[],i=[],s=E(e.replace(lt,"$1"));return s[F]?n(function(e,t,i,n){for(var o,a=s(e,null,n,[]),r=e.length;r--;)(o=a[r])&&(e[r]=!(t[r]=o))}):function(e,n,o){return t[0]=e,s(t,null,o,i),!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:n(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(wt,xt).toLowerCase(),function(t){var i;do if(i=D?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===I},focus:function(e){return e===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);
return e})}},C.pseudos.nth=C.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[x]=r(x);for(x in{submit:!0,reset:!0})C.pseudos[x]=l(x);return d.prototype=C.filters=C.pseudos,C.setFilters=new d,E=t.compile=function(e,t){var i,n=[],s=[],o=U[e+" "];if(!o){for(t||(t=h(e)),i=t.length;i--;)o=b(t[i]),o[F]?n.push(o):s.push(o);o=U(e,y(s,n))}return o},k.sortStable=F.split("").sort(W).join("")===F,k.detectDuplicates=!!M,N(),k.sortDetached=s(function(e){return 1&e.compareDocumentPosition(O.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),k.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(it,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);ot.find=ut,ot.expr=ut.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=ut.uniqueSort,ot.text=ut.getText,ot.isXMLDoc=ut.isXML,ot.contains=ut.contains;var dt=ot.expr.match.needsContext,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pt=/^.[^:#\[\.,]*$/;ot.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ot.find.matchesSelector(n,e)?[n]:[]:ot.find.matches(e,ot.grep(t,function(e){return 1===e.nodeType}))},ot.fn.extend({find:function(e){var t,i=[],n=this,s=n.length;if("string"!=typeof e)return this.pushStack(ot(e).filter(function(){for(t=0;s>t;t++)if(ot.contains(n[t],this))return!0}));for(t=0;s>t;t++)ot.find(e,n[t],i);return i=this.pushStack(s>1?ot.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&dt.test(e)?ot(e):e||[],!1).length}});var ft,mt=e.document,gt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,vt=ot.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:gt.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||ft).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof ot?t[0]:t,ot.merge(this,ot.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:mt,!0)),ht.test(i[1])&&ot.isPlainObject(t))for(i in t)ot.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if(n=mt.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return ft.find(e);this.length=1,this[0]=n}return this.context=mt,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ot.isFunction(e)?"undefined"!=typeof ft.ready?ft.ready(e):e(ot):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),ot.makeArray(e,this))};vt.prototype=ot.fn,ft=ot(mt);var bt=/^(?:parents|prev(?:Until|All))/,yt={children:!0,contents:!0,next:!0,prev:!0};ot.extend({dir:function(e,t,i){for(var n=[],s=e[t];s&&9!==s.nodeType&&(void 0===i||1!==s.nodeType||!ot(s).is(i));)1===s.nodeType&&n.push(s),s=s[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),ot.fn.extend({has:function(e){var t,i=ot(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(ot.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,s=this.length,o=[],a=dt.test(e)||"string"!=typeof e?ot(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&ot.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(e){return e?"string"==typeof e?ot.inArray(this[0],ot(e)):ot.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ot.unique(ot.merge(this.get(),ot(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ot.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ot.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ot.dir(e,"parentNode",i)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return ot.dir(e,"nextSibling")},prevAll:function(e){return ot.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ot.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ot.dir(e,"previousSibling",i)},siblings:function(e){return ot.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ot.sibling(e.firstChild)},contents:function(e){return ot.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ot.merge([],e.childNodes)}},function(e,t){ot.fn[e]=function(i,n){var s=ot.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=ot.filter(n,s)),this.length>1&&(yt[e]||(s=ot.unique(s)),bt.test(e)&&(s=s.reverse())),this.pushStack(s)}});var _t=/\S+/g,wt={};ot.Callbacks=function(e){e="string"==typeof e?wt[e]||o(e):ot.extend({},e);var t,i,n,s,a,r,l=[],c=!e.once&&[],u=function(o){for(i=e.memory&&o,n=!0,a=r||0,r=0,s=l.length,t=!0;l&&s>a;a++)if(l[a].apply(o[0],o[1])===!1&&e.stopOnFalse){i=!1;break}t=!1,l&&(c?c.length&&u(c.shift()):i?l=[]:d.disable())},d={add:function(){if(l){var n=l.length;!function o(t){ot.each(t,function(t,i){var n=ot.type(i);"function"===n?e.unique&&d.has(i)||l.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),t?s=l.length:i&&(r=n,u(i))}return this},remove:function(){return l&&ot.each(arguments,function(e,i){for(var n;(n=ot.inArray(i,l,n))>-1;)l.splice(n,1),t&&(s>=n&&s--,a>=n&&a--)}),this},has:function(e){return e?ot.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=i=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,i||d.disable(),this},locked:function(){return!c},fireWith:function(e,i){return!l||n&&!c||(i=i||[],i=[e,i.slice?i.slice():i],t?c.push(i):u(i)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},ot.extend({Deferred:function(e){var t=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ot.Deferred(function(i){ot.each(t,function(t,o){var a=ot.isFunction(e[t])&&e[t];s[o[1]](function(){var e=a&&a.apply(this,arguments);e&&ot.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ot.extend(e,n):n}},s={};return n.pipe=n.then,ot.each(t,function(e,o){var a=o[2],r=o[3];n[o[1]]=a.add,r&&a.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=a.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,o=J.call(arguments),a=o.length,r=1!==a||e&&ot.isFunction(e.promise)?a:0,l=1===r?e:ot.Deferred(),c=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?J.call(arguments):s,n===t?l.notifyWith(i,n):--r||l.resolveWith(i,n)}};if(a>1)for(t=new Array(a),i=new Array(a),n=new Array(a);a>s;s++)o[s]&&ot.isFunction(o[s].promise)?o[s].promise().done(c(s,n,o)).fail(l.reject).progress(c(s,i,t)):--r;return r||l.resolveWith(n,o),l.promise()}});var xt;ot.fn.ready=function(e){return ot.ready.promise().done(e),this},ot.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ot.readyWait++:ot.ready(!0)},ready:function(e){if(e===!0?!--ot.readyWait:!ot.isReady){if(!mt.body)return setTimeout(ot.ready);ot.isReady=!0,e!==!0&&--ot.readyWait>0||(xt.resolveWith(mt,[ot]),ot.fn.trigger&&ot(mt).trigger("ready").off("ready"))}}}),ot.ready.promise=function(t){if(!xt)if(xt=ot.Deferred(),"complete"===mt.readyState)setTimeout(ot.ready);else if(mt.addEventListener)mt.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",r,!1);else{mt.attachEvent("onreadystatechange",r),e.attachEvent("onload",r);var i=!1;try{i=null==e.frameElement&&mt.documentElement}catch(n){}i&&i.doScroll&&!function s(){if(!ot.isReady){try{i.doScroll("left")}catch(e){return setTimeout(s,50)}a(),ot.ready()}}()}return xt.promise(t)};var kt,Ct="undefined";for(kt in ot(nt))break;nt.ownLast="0"!==kt,nt.inlineBlockNeedsLayout=!1,ot(function(){var e,t,i=mt.getElementsByTagName("body")[0];i&&(e=mt.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=mt.createElement("div"),i.appendChild(e).appendChild(t),typeof t.style.zoom!==Ct&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(nt.inlineBlockNeedsLayout=3===t.offsetWidth)&&(i.style.zoom=1)),i.removeChild(e),e=t=null)}),function(){var e=mt.createElement("div");if(null==nt.deleteExpando){nt.deleteExpando=!0;try{delete e.test}catch(t){nt.deleteExpando=!1}}e=null}(),ot.acceptData=function(e){var t=ot.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return 1!==i&&9!==i?!1:!t||t!==!0&&e.getAttribute("classid")===t};var St=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;ot.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ot.cache[e[ot.expando]]:e[ot.expando],!!e&&!c(e)},data:function(e,t,i){return u(e,t,i)},removeData:function(e,t){return d(e,t)},_data:function(e,t,i){return u(e,t,i,!0)},_removeData:function(e,t){return d(e,t,!0)}}),ot.fn.extend({data:function(e,t){var i,n,s,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(s=ot.data(o),1===o.nodeType&&!ot._data(o,"parsedAttrs"))){for(i=a.length;i--;)n=a[i].name,0===n.indexOf("data-")&&(n=ot.camelCase(n.slice(5)),l(o,n,s[n]));ot._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){ot.data(this,e)}):arguments.length>1?this.each(function(){ot.data(this,e,t)}):o?l(o,e,ot.data(o,e)):void 0},removeData:function(e){return this.each(function(){ot.removeData(this,e)})}}),ot.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=ot._data(e,t),i&&(!n||ot.isArray(i)?n=ot._data(e,t,ot.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=ot.queue(e,t),n=i.length,s=i.shift(),o=ot._queueHooks(e,t),a=function(){ot.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete o.stop,s.call(e,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ot._data(e,i)||ot._data(e,i,{empty:ot.Callbacks("once memory").add(function(){ot._removeData(e,t+"queue"),ot._removeData(e,i)})})}}),ot.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?ot.queue(this[0],e):void 0===t?this:this.each(function(){var i=ot.queue(this,e,t);ot._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&ot.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ot.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=ot.Deferred(),o=this,a=this.length,r=function(){--n||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=ot._data(o[a],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(r));return r(),s.promise(t)}});var Et=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=["Top","Right","Bottom","Left"],$t=function(e,t){return e=t||e,"none"===ot.css(e,"display")||!ot.contains(e.ownerDocument,e)},Mt=ot.access=function(e,t,i,n,s,o,a){var r=0,l=e.length,c=null==i;if("object"===ot.type(i)){s=!0;for(r in i)ot.access(e,t,r,i[r],!0,o,a)}else if(void 0!==n&&(s=!0,ot.isFunction(n)||(a=!0),c&&(a?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(ot(e),i)})),t))for(;l>r;r++)t(e[r],i,a?n:n.call(e[r],r,t(e[r],i)));return s?e:c?t.call(e):l?t(e[0],i):o},Nt=/^(?:checkbox|radio)$/i;!function(){var e=mt.createDocumentFragment(),t=mt.createElement("div"),i=mt.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",nt.leadingWhitespace=3===t.firstChild.nodeType,nt.tbody=!t.getElementsByTagName("tbody").length,nt.htmlSerialize=!!t.getElementsByTagName("link").length,nt.html5Clone="<:nav></:nav>"!==mt.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,e.appendChild(i),nt.appendChecked=i.checked,t.innerHTML="<textarea>x</textarea>",nt.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",nt.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,nt.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){nt.noCloneEvent=!1}),t.cloneNode(!0).click()),null==nt.deleteExpando){nt.deleteExpando=!0;try{delete t.test}catch(n){nt.deleteExpando=!1}}e=t=i=null}(),function(){var t,i,n=mt.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})i="on"+t,(nt[t+"Bubbles"]=i in e)||(n.setAttribute(i,"t"),nt[t+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var Ot=/^(?:input|select|textarea)$/i,It=/^key/,Dt=/^(?:mouse|contextmenu)|click/,Rt=/^(?:focusinfocus|focusoutblur)$/,Pt=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(e,t,i,n,s){var o,a,r,l,c,u,d,h,p,f,m,g=ot._data(e);if(g){for(i.handler&&(l=i,i=l.handler,s=l.selector),i.guid||(i.guid=ot.guid++),(a=g.events)||(a=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof ot===Ct||e&&ot.event.triggered===e.type?void 0:ot.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(_t)||[""],r=t.length;r--;)o=Pt.exec(t[r])||[],p=m=o[1],f=(o[2]||"").split(".").sort(),p&&(c=ot.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,c=ot.event.special[p]||{},d=ot.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&ot.expr.match.needsContext.test(s),namespace:f.join(".")},l),(h=a[p])||(h=a[p]=[],h.delegateCount=0,c.setup&&c.setup.call(e,n,f,u)!==!1||(e.addEventListener?e.addEventListener(p,u,!1):e.attachEvent&&e.attachEvent("on"+p,u))),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),s?h.splice(h.delegateCount++,0,d):h.push(d),ot.event.global[p]=!0);e=null}},remove:function(e,t,i,n,s){var o,a,r,l,c,u,d,h,p,f,m,g=ot.hasData(e)&&ot._data(e);if(g&&(u=g.events)){for(t=(t||"").match(_t)||[""],c=t.length;c--;)if(r=Pt.exec(t[c])||[],p=m=r[1],f=(r[2]||"").split(".").sort(),p){for(d=ot.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,h=u[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=h.length;o--;)a=h[o],!s&&m!==a.origType||i&&i.guid!==a.guid||r&&!r.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(h.splice(o,1),a.selector&&h.delegateCount--,d.remove&&d.remove.call(e,a));l&&!h.length&&(d.teardown&&d.teardown.call(e,f,g.handle)!==!1||ot.removeEvent(e,p,g.handle),delete u[p])}else for(p in u)ot.event.remove(e,p+t[c],i,n,!0);ot.isEmptyObject(u)&&(delete g.handle,ot._removeData(e,"events"))}},trigger:function(t,i,n,s){var o,a,r,l,c,u,d,h=[n||mt],p=tt.call(t,"type")?t.type:t,f=tt.call(t,"namespace")?t.namespace.split("."):[];if(r=u=n=n||mt,3!==n.nodeType&&8!==n.nodeType&&!Rt.test(p+ot.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),a=p.indexOf(":")<0&&"on"+p,t=t[ot.expando]?t:new ot.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:ot.makeArray(i,[t]),c=ot.event.special[p]||{},s||!c.trigger||c.trigger.apply(n,i)!==!1)){if(!s&&!c.noBubble&&!ot.isWindow(n)){for(l=c.delegateType||p,Rt.test(l+p)||(r=r.parentNode);r;r=r.parentNode)h.push(r),u=r;u===(n.ownerDocument||mt)&&h.push(u.defaultView||u.parentWindow||e)}for(d=0;(r=h[d++])&&!t.isPropagationStopped();)t.type=d>1?l:c.bindType||p,o=(ot._data(r,"events")||{})[t.type]&&ot._data(r,"handle"),o&&o.apply(r,i),o=a&&r[a],o&&o.apply&&ot.acceptData(r)&&(t.result=o.apply(r,i),t.result===!1&&t.preventDefault());if(t.type=p,!s&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(h.pop(),i)===!1)&&ot.acceptData(n)&&a&&n[p]&&!ot.isWindow(n)){u=n[a],u&&(n[a]=null),ot.event.triggered=p;try{n[p]()}catch(m){}ot.event.triggered=void 0,u&&(n[a]=u)}return t.result}},dispatch:function(e){e=ot.event.fix(e);var t,i,n,s,o,a=[],r=J.call(arguments),l=(ot._data(this,"events")||{})[e.type]||[],c=ot.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(a=ot.event.handlers.call(this,e,l),t=0;(s=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,o=0;(n=s.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(n.namespace))&&(e.handleObj=n,e.data=n.data,i=((ot.event.special[n.origType]||{}).handle||n.handler).apply(s.elem,r),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,s,o,a=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(s=[],o=0;r>o;o++)n=t[o],i=n.selector+" ",void 0===s[i]&&(s[i]=n.needsContext?ot(i,this).index(l)>=0:ot.find(i,this,null,[l]).length),s[i]&&s.push(n);s.length&&a.push({elem:l,handlers:s})}return r<t.length&&a.push({elem:this,handlers:t.slice(r)}),a},fix:function(e){if(e[ot.expando])return e;var t,i,n,s=e.type,o=e,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=Dt.test(s)?this.mouseHooks:It.test(s)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new ot.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=o.srcElement||mt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,s,o=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||mt,s=n.documentElement,i=n.body,e.pageX=t.clientX+(s&&s.scrollLeft||i&&i.scrollLeft||0)-(s&&s.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||i&&i.scrollTop||0)-(s&&s.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ot.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return ot.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var s=ot.extend(new ot.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ot.event.trigger(s,null,t):ot.event.dispatch.call(t,s),s.isDefaultPrevented()&&i.preventDefault()}},ot.removeEvent=mt.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===Ct&&(e[n]=null),e.detachEvent(n,i))},ot.Event=function(e,t){return this instanceof ot.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault())?h:p):this.type=e,t&&ot.extend(this,t),this.timeStamp=e&&e.timeStamp||ot.now(),void(this[ot.expando]=!0)):new ot.Event(e,t)},ot.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ot.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,o=e.handleObj;return(!s||s!==n&&!ot.contains(n,s))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),nt.submitBubbles||(ot.event.special.submit={setup:function(){return ot.nodeName(this,"form")?!1:void ot.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=ot.nodeName(t,"input")||ot.nodeName(t,"button")?t.form:void 0;i&&!ot._data(i,"submitBubbles")&&(ot.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),ot._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ot.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ot.nodeName(this,"form")?!1:void ot.event.remove(this,"._submit")}}),nt.changeBubbles||(ot.event.special.change={setup:function(){return Ot.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ot.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ot.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ot.event.simulate("change",this,e,!0)})),!1):void ot.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ot.test(t.nodeName)&&!ot._data(t,"changeBubbles")&&(ot.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ot.event.simulate("change",this.parentNode,e,!0)}),ot._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ot.event.remove(this,"._change"),!Ot.test(this.nodeName)}}),nt.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){ot.event.simulate(t,e.target,ot.event.fix(e),!0)};ot.event.special[t]={setup:function(){var n=this.ownerDocument||this,s=ot._data(n,t);s||n.addEventListener(e,i,!0),ot._data(n,t,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=ot._data(n,t)-1;s?ot._data(n,t,s):(n.removeEventListener(e,i,!0),ot._removeData(n,t))}}}),ot.fn.extend({on:function(e,t,i,n,s){var o,a;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(o in e)this.on(o,t,i,e[o],s);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=p;else if(!n)return this;return 1===s&&(a=n,n=function(e){return ot().off(e),a.apply(this,arguments)},n.guid=a.guid||(a.guid=ot.guid++)),this.each(function(){ot.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ot(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=p),this.each(function(){ot.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){ot.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?ot.event.trigger(e,t,i,!0):void 0}});var Lt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Vt=/ jQuery\d+="(?:null|\d+)"/g,Ft=new RegExp("<(?:"+Lt+")[\\s/>]","i"),Bt=/^\s+/,Ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,zt=/<([\w:]+)/,jt=/<tbody/i,qt=/<|&#?\w+;/,Ut=/<(?:script|style|link)/i,Wt=/checked\s*(?:[^=]|=\s*.checked.)/i,Yt=/^$|\/(?:java|ecma)script/i,Gt=/^true\/(.*)/,Jt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Kt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:nt.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Qt=m(mt),Xt=Qt.appendChild(mt.createElement("div"));Kt.optgroup=Kt.option,Kt.tbody=Kt.tfoot=Kt.colgroup=Kt.caption=Kt.thead,Kt.th=Kt.td,ot.extend({clone:function(e,t,i){var n,s,o,a,r,l=ot.contains(e.ownerDocument,e);if(nt.html5Clone||ot.isXMLDoc(e)||!Ft.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Xt.innerHTML=e.outerHTML,Xt.removeChild(o=Xt.firstChild)),!(nt.noCloneEvent&&nt.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ot.isXMLDoc(e)))for(n=g(o),r=g(e),a=0;null!=(s=r[a]);++a)n[a]&&k(s,n[a]);if(t)if(i)for(r=r||g(e),n=n||g(o),a=0;null!=(s=r[a]);a++)x(s,n[a]);else x(e,o);return n=g(o,"script"),n.length>0&&w(n,!l&&g(e,"script")),n=r=s=null,o},buildFragment:function(e,t,i,n){for(var s,o,a,r,l,c,u,d=e.length,h=m(t),p=[],f=0;d>f;f++)if(o=e[f],o||0===o)if("object"===ot.type(o))ot.merge(p,o.nodeType?[o]:o);else if(qt.test(o)){for(r=r||h.appendChild(t.createElement("div")),l=(zt.exec(o)||["",""])[1].toLowerCase(),u=Kt[l]||Kt._default,r.innerHTML=u[1]+o.replace(Ht,"<$1></$2>")+u[2],s=u[0];s--;)r=r.lastChild;if(!nt.leadingWhitespace&&Bt.test(o)&&p.push(t.createTextNode(Bt.exec(o)[0])),!nt.tbody)for(o="table"!==l||jt.test(o)?"<table>"!==u[1]||jt.test(o)?0:r:r.firstChild,s=o&&o.childNodes.length;s--;)ot.nodeName(c=o.childNodes[s],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(ot.merge(p,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=h.lastChild}else p.push(t.createTextNode(o));for(r&&h.removeChild(r),nt.appendChecked||ot.grep(g(p,"input"),v),f=0;o=p[f++];)if((!n||-1===ot.inArray(o,n))&&(a=ot.contains(o.ownerDocument,o),r=g(h.appendChild(o),"script"),a&&w(r),i))for(s=0;o=r[s++];)Yt.test(o.type||"")&&i.push(o);return r=null,h},cleanData:function(e,t){for(var i,n,s,o,a=0,r=ot.expando,l=ot.cache,c=nt.deleteExpando,u=ot.event.special;null!=(i=e[a]);a++)if((t||ot.acceptData(i))&&(s=i[r],o=s&&l[s])){if(o.events)for(n in o.events)u[n]?ot.event.remove(i,n):ot.removeEvent(i,n,o.handle);l[s]&&(delete l[s],c?delete i[r]:typeof i.removeAttribute!==Ct?i.removeAttribute(r):i[r]=null,G.push(s))}}}),ot.fn.extend({text:function(e){return Mt(this,function(e){return void 0===e?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||mt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?ot.filter(e,this):this,s=0;null!=(i=n[s]);s++)t||1!==i.nodeType||ot.cleanData(g(i)),i.parentNode&&(t&&ot.contains(i.ownerDocument,i)&&w(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ot.cleanData(g(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ot.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ot.clone(this,e,t)})},html:function(e){return Mt(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Vt,""):void 0;if(!("string"!=typeof e||Ut.test(e)||!nt.htmlSerialize&&Ft.test(e)||!nt.leadingWhitespace&&Bt.test(e)||Kt[(zt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ht,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(ot.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,ot.cleanData(g(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=K.apply([],e);var i,n,s,o,a,r,l=0,c=this.length,u=this,d=c-1,h=e[0],p=ot.isFunction(h);if(p||c>1&&"string"==typeof h&&!nt.checkClone&&Wt.test(h))return this.each(function(i){var n=u.eq(i);p&&(e[0]=h.call(this,i,n.html())),n.domManip(e,t)});if(c&&(r=ot.buildFragment(e,this[0].ownerDocument,!1,this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=ot.map(g(r,"script"),y),s=o.length;c>l;l++)n=r,l!==d&&(n=ot.clone(n,!0,!0),s&&ot.merge(o,g(n,"script"))),t.call(this[l],n,l);if(s)for(a=o[o.length-1].ownerDocument,ot.map(o,_),l=0;s>l;l++)n=o[l],Yt.test(n.type||"")&&!ot._data(n,"globalEval")&&ot.contains(a,n)&&(n.src?ot._evalUrl&&ot._evalUrl(n.src):ot.globalEval((n.text||n.textContent||n.innerHTML||"").replace(Jt,"")));r=i=null}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ot.fn[e]=function(e){for(var i,n=0,s=[],o=ot(e),a=o.length-1;a>=n;n++)i=n===a?this:this.clone(!0),ot(o[n])[t](i),Q.apply(s,i.get());return this.pushStack(s)}});var Zt,ei={};!function(){var e,t,i=mt.createElement("div"),n="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=i.getElementsByTagName("a")[0],e.style.cssText="float:left;opacity:.5",nt.opacity=/^0.5/.test(e.style.opacity),nt.cssFloat=!!e.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===i.style.backgroundClip,e=i=null,nt.shrinkWrapBlocks=function(){var e,i,s,o;if(null==t){if(e=mt.getElementsByTagName("body")[0],!e)return;o="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",i=mt.createElement("div"),s=mt.createElement("div"),e.appendChild(i).appendChild(s),t=!1,typeof s.style.zoom!==Ct&&(s.style.cssText=n+";width:1px;padding:1px;zoom:1",s.innerHTML="<div></div>",s.firstChild.style.width="5px",t=3!==s.offsetWidth),e.removeChild(i),e=i=s=null}return t}}();var ti,ii,ni=/^margin/,si=new RegExp("^("+Et+")(?!px)[a-z%]+$","i"),oi=/^(top|right|bottom|left)$/;e.getComputedStyle?(ti=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},ii=function(e,t,i){var n,s,o,a,r=e.style;return i=i||ti(e),a=i?i.getPropertyValue(t)||i[t]:void 0,i&&(""!==a||ot.contains(e.ownerDocument,e)||(a=ot.style(e,t)),si.test(a)&&ni.test(t)&&(n=r.width,s=r.minWidth,o=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=s,r.maxWidth=o)),void 0===a?a:a+""}):mt.documentElement.currentStyle&&(ti=function(e){return e.currentStyle},ii=function(e,t,i){var n,s,o,a,r=e.style;return i=i||ti(e),a=i?i[t]:void 0,null==a&&r&&r[t]&&(a=r[t]),si.test(a)&&!oi.test(t)&&(n=r.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),r.left="fontSize"===t?"1em":a,a=r.pixelLeft+"px",r.left=n,o&&(s.left=o)),void 0===a?a:a+""||"auto"
}),!function(){function t(){var t,i,n=mt.getElementsByTagName("body")[0];n&&(t=mt.createElement("div"),i=mt.createElement("div"),t.style.cssText=c,n.appendChild(t).appendChild(i),i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",ot.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){s=4===i.offsetWidth}),o=!0,a=!1,r=!0,e.getComputedStyle&&(a="1%"!==(e.getComputedStyle(i,null)||{}).top,o="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width),n.removeChild(t),i=n=null)}var i,n,s,o,a,r,l=mt.createElement("div"),c="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",u="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=l.getElementsByTagName("a")[0],i.style.cssText="float:left;opacity:.5",nt.opacity=/^0.5/.test(i.style.opacity),nt.cssFloat=!!i.style.cssFloat,l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===l.style.backgroundClip,i=l=null,ot.extend(nt,{reliableHiddenOffsets:function(){if(null!=n)return n;var e,t,i,s=mt.createElement("div"),o=mt.getElementsByTagName("body")[0];return o?(s.setAttribute("className","t"),s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=mt.createElement("div"),e.style.cssText=c,o.appendChild(e).appendChild(s),s.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=s.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",i=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",n=i&&0===t[0].offsetHeight,o.removeChild(e),s=o=null,n):void 0},boxSizing:function(){return null==s&&t(),s},boxSizingReliable:function(){return null==o&&t(),o},pixelPosition:function(){return null==a&&t(),a},reliableMarginRight:function(){var t,i,n,s;if(null==r&&e.getComputedStyle){if(t=mt.getElementsByTagName("body")[0],!t)return;i=mt.createElement("div"),n=mt.createElement("div"),i.style.cssText=c,t.appendChild(i).appendChild(n),s=n.appendChild(mt.createElement("div")),s.style.cssText=n.style.cssText=u,s.style.marginRight=s.style.width="0",n.style.width="1px",r=!parseFloat((e.getComputedStyle(s,null)||{}).marginRight),t.removeChild(i)}return r}})}(),ot.swap=function(e,t,i,n){var s,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];s=i.apply(e,n||[]);for(o in t)e.style[o]=a[o];return s};var ai=/alpha\([^)]*\)/i,ri=/opacity\s*=\s*([^)]*)/,li=/^(none|table(?!-c[ea]).+)/,ci=new RegExp("^("+Et+")(.*)$","i"),ui=new RegExp("^([+-])=("+Et+")","i"),di={position:"absolute",visibility:"hidden",display:"block"},hi={letterSpacing:0,fontWeight:400},pi=["Webkit","O","Moz","ms"];ot.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ii(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":nt.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,a,r=ot.camelCase(t),l=e.style;if(t=ot.cssProps[r]||(ot.cssProps[r]=E(l,r)),a=ot.cssHooks[t]||ot.cssHooks[r],void 0===i)return a&&"get"in a&&void 0!==(s=a.get(e,!1,n))?s:l[t];if(o=typeof i,"string"===o&&(s=ui.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(ot.css(e,t)),o="number"),null!=i&&i===i&&("number"!==o||ot.cssNumber[r]||(i+="px"),nt.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(e,i,n)))))try{l[t]="",l[t]=i}catch(c){}}},css:function(e,t,i,n){var s,o,a,r=ot.camelCase(t);return t=ot.cssProps[r]||(ot.cssProps[r]=E(e.style,r)),a=ot.cssHooks[t]||ot.cssHooks[r],a&&"get"in a&&(o=a.get(e,!0,i)),void 0===o&&(o=ii(e,t,n)),"normal"===o&&t in hi&&(o=hi[t]),""===i||i?(s=parseFloat(o),i===!0||ot.isNumeric(s)?s||0:o):o}}),ot.each(["height","width"],function(e,t){ot.cssHooks[t]={get:function(e,i,n){return i?0===e.offsetWidth&&li.test(ot.css(e,"display"))?ot.swap(e,di,function(){return N(e,t,n)}):N(e,t,n):void 0},set:function(e,i,n){var s=n&&ti(e);return $(e,i,n?M(e,t,n,nt.boxSizing()&&"border-box"===ot.css(e,"boxSizing",!1,s),s):0)}}}),nt.opacity||(ot.cssHooks.opacity={get:function(e,t){return ri.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,s=ot.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===ot.trim(o.replace(ai,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=ai.test(o)?o.replace(ai,s):o+" "+s)}}),ot.cssHooks.marginRight=T(nt.reliableMarginRight,function(e,t){return t?ot.swap(e,{display:"inline-block"},ii,[e,"marginRight"]):void 0}),ot.each({margin:"",padding:"",border:"Width"},function(e,t){ot.cssHooks[e+t]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];4>n;n++)s[e+At[n]+t]=o[n]||o[n-2]||o[0];return s}},ni.test(e)||(ot.cssHooks[e+t].set=$)}),ot.fn.extend({css:function(e,t){return Mt(this,function(e,t,i){var n,s,o={},a=0;if(ot.isArray(t)){for(n=ti(e),s=t.length;s>a;a++)o[t[a]]=ot.css(e,t[a],!1,n);return o}return void 0!==i?ot.style(e,t,i):ot.css(e,t)},e,t,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){$t(this)?ot(this).show():ot(this).hide()})}}),ot.Tween=O,O.prototype={constructor:O,init:function(e,t,i,n,s,o){this.elem=e,this.prop=i,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ot.cssNumber[i]?"":"px")},cur:function(){var e=O.propHooks[this.prop];return e&&e.get?e.get(this):O.propHooks._default.get(this)},run:function(e){var t,i=O.propHooks[this.prop];return this.pos=t=this.options.duration?ot.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):O.propHooks._default.set(this),this}},O.prototype.init.prototype=O.prototype,O.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ot.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ot.fx.step[e.prop]?ot.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ot.cssProps[e.prop]]||ot.cssHooks[e.prop])?ot.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ot.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ot.fx=O.prototype.init,ot.fx.step={};var fi,mi,gi=/^(?:toggle|show|hide)$/,vi=new RegExp("^(?:([+-])=|)("+Et+")([a-z%]*)$","i"),bi=/queueHooks$/,yi=[P],_i={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),s=vi.exec(t),o=s&&s[3]||(ot.cssNumber[e]?"":"px"),a=(ot.cssNumber[e]||"px"!==o&&+n)&&vi.exec(ot.css(i.elem,e)),r=1,l=20;if(a&&a[3]!==o){o=o||a[3],s=s||[],a=+n||1;do r=r||".5",a/=r,ot.style(i.elem,e,a+o);while(r!==(r=i.cur()/n)&&1!==r&&--l)}return s&&(a=i.start=+a||+n||0,i.unit=o,i.end=s[1]?a+(s[1]+1)*s[2]:+s[2]),i}]};ot.Animation=ot.extend(V,{tweener:function(e,t){ot.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,s=e.length;s>n;n++)i=e[n],_i[i]=_i[i]||[],_i[i].unshift(t)},prefilter:function(e,t){t?yi.unshift(e):yi.push(e)}}),ot.speed=function(e,t,i){var n=e&&"object"==typeof e?ot.extend({},e):{complete:i||!i&&t||ot.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ot.isFunction(t)&&t};return n.duration=ot.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ot.fx.speeds?ot.fx.speeds[n.duration]:ot.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ot.isFunction(n.old)&&n.old.call(this),n.queue&&ot.dequeue(this,n.queue)},n},ot.fn.extend({fadeTo:function(e,t,i,n){return this.filter($t).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=ot.isEmptyObject(e),o=ot.speed(t,i,n),a=function(){var t=V(this,ot.extend({},e),o);(s||ot._data(this,"finish"))&&t.stop(!0)};return a.finish=a,s||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",o=ot.timers,a=ot._data(this);if(s)a[s]&&a[s].stop&&n(a[s]);else for(s in a)a[s]&&a[s].stop&&bi.test(s)&&n(a[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(i),t=!1,o.splice(s,1));(t||!i)&&ot.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ot._data(this),n=i[e+"queue"],s=i[e+"queueHooks"],o=ot.timers,a=n?n.length:0;for(i.finish=!0,ot.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ot.each(["toggle","show","hide"],function(e,t){var i=ot.fn[t];ot.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(D(t,!0),e,n,s)}}),ot.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ot.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ot.timers=[],ot.fx.tick=function(){var e,t=ot.timers,i=0;for(fi=ot.now();i<t.length;i++)e=t[i],e()||t[i]!==e||t.splice(i--,1);t.length||ot.fx.stop(),fi=void 0},ot.fx.timer=function(e){ot.timers.push(e),e()?ot.fx.start():ot.timers.pop()},ot.fx.interval=13,ot.fx.start=function(){mi||(mi=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(mi),mi=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fn.delay=function(e,t){return e=ot.fx?ot.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e,t,i,n,s=mt.createElement("div");s.setAttribute("className","t"),s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=s.getElementsByTagName("a")[0],i=mt.createElement("select"),n=i.appendChild(mt.createElement("option")),t=s.getElementsByTagName("input")[0],e.style.cssText="top:1px",nt.getSetAttribute="t"!==s.className,nt.style=/top/.test(e.getAttribute("style")),nt.hrefNormalized="/a"===e.getAttribute("href"),nt.checkOn=!!t.value,nt.optSelected=n.selected,nt.enctype=!!mt.createElement("form").enctype,i.disabled=!0,nt.optDisabled=!n.disabled,t=mt.createElement("input"),t.setAttribute("value",""),nt.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),nt.radioValue="t"===t.value,e=t=i=n=s=null}();var wi=/\r/g;ot.fn.extend({val:function(e){var t,i,n,s=this[0];return arguments.length?(n=ot.isFunction(e),this.each(function(i){var s;1===this.nodeType&&(s=n?e.call(this,i,ot(this).val()):e,null==s?s="":"number"==typeof s?s+="":ot.isArray(s)&&(s=ot.map(s,function(e){return null==e?"":e+""})),t=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))})):s?(t=ot.valHooks[s.type]||ot.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:(i=s.value,"string"==typeof i?i.replace(wi,""):null==i?"":i)):void 0}}),ot.extend({valHooks:{option:{get:function(e){var t=ot.find.attr(e,"value");return null!=t?t:ot.text(e)}},select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,a=o?null:[],r=o?s+1:n.length,l=0>s?r:o?s:0;r>l;l++)if(i=n[l],!(!i.selected&&l!==s||(nt.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ot.nodeName(i.parentNode,"optgroup"))){if(t=ot(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,n,s=e.options,o=ot.makeArray(t),a=s.length;a--;)if(n=s[a],ot.inArray(ot.valHooks.option.get(n),o)>=0)try{n.selected=i=!0}catch(r){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),s}}}}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(e,t){return ot.isArray(t)?e.checked=ot.inArray(ot(e).val(),t)>=0:void 0}},nt.checkOn||(ot.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var xi,ki,Ci=ot.expr.attrHandle,Si=/^(?:checked|selected)$/i,Ti=nt.getSetAttribute,Ei=nt.input;ot.fn.extend({attr:function(e,t){return Mt(this,ot.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ot.removeAttr(this,e)})}}),ot.extend({attr:function(e,t,i){var n,s,o=e.nodeType;return e&&3!==o&&8!==o&&2!==o?typeof e.getAttribute===Ct?ot.prop(e,t,i):(1===o&&ot.isXMLDoc(e)||(t=t.toLowerCase(),n=ot.attrHooks[t]||(ot.expr.match.bool.test(t)?ki:xi)),void 0===i?n&&"get"in n&&null!==(s=n.get(e,t))?s:(s=ot.find.attr(e,t),null==s?void 0:s):null!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:(e.setAttribute(t,i+""),i):void ot.removeAttr(e,t)):void 0},removeAttr:function(e,t){var i,n,s=0,o=t&&t.match(_t);if(o&&1===e.nodeType)for(;i=o[s++];)n=ot.propFix[i]||i,ot.expr.match.bool.test(i)?Ei&&Ti||!Si.test(i)?e[n]=!1:e[ot.camelCase("default-"+i)]=e[n]=!1:ot.attr(e,i,""),e.removeAttribute(Ti?i:n)},attrHooks:{type:{set:function(e,t){if(!nt.radioValue&&"radio"===t&&ot.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),ki={set:function(e,t,i){return t===!1?ot.removeAttr(e,i):Ei&&Ti||!Si.test(i)?e.setAttribute(!Ti&&ot.propFix[i]||i,i):e[ot.camelCase("default-"+i)]=e[i]=!0,i}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(e,t){var i=Ci[t]||ot.find.attr;Ci[t]=Ei&&Ti||!Si.test(t)?function(e,t,n){var s,o;return n||(o=Ci[t],Ci[t]=s,s=null!=i(e,t,n)?t.toLowerCase():null,Ci[t]=o),s}:function(e,t,i){return i?void 0:e[ot.camelCase("default-"+t)]?t.toLowerCase():null}}),Ei&&Ti||(ot.attrHooks.value={set:function(e,t,i){return ot.nodeName(e,"input")?void(e.defaultValue=t):xi&&xi.set(e,t,i)}}),Ti||(xi={set:function(e,t,i){var n=e.getAttributeNode(i);return n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i)?t:void 0}},Ci.id=Ci.name=Ci.coords=function(e,t,i){var n;return i?void 0:(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},ot.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);return i&&i.specified?i.value:void 0},set:xi.set},ot.attrHooks.contenteditable={set:function(e,t,i){xi.set(e,""===t?!1:t,i)}},ot.each(["width","height"],function(e,t){ot.attrHooks[t]={set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}}})),nt.style||(ot.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Ai=/^(?:input|select|textarea|button|object)$/i,$i=/^(?:a|area)$/i;ot.fn.extend({prop:function(e,t){return Mt(this,ot.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ot.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),ot.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,s,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(o=1!==a||!ot.isXMLDoc(e),o&&(t=ot.propFix[t]||t,s=ot.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]):void 0},propHooks:{tabIndex:{get:function(e){var t=ot.find.attr(e,"tabindex");return t?parseInt(t,10):Ai.test(e.nodeName)||$i.test(e.nodeName)&&e.href?0:-1}}}}),nt.hrefNormalized||ot.each(["href","src"],function(e,t){ot.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),nt.optSelected||(ot.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),nt.enctype||(ot.propFix.enctype="encoding");var Mi=/[\t\r\n\f]/g;ot.fn.extend({addClass:function(e){var t,i,n,s,o,a,r=0,l=this.length,c="string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(_t)||[];l>r;r++)if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Mi," "):" ")){for(o=0;s=t[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a=ot.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,n,s,o,a,r=0,l=this.length,c=0===arguments.length||"string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(_t)||[];l>r;r++)if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Mi," "):"")){for(o=0;s=t[o++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");a=e?ot.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(ot.isFunction(e)?function(i){ot(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,n=0,s=ot(this),o=e.match(_t)||[];t=o[n++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(i===Ct||"boolean"===i)&&(this.className&&ot._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ot._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Mi," ").indexOf(t)>=0)return!0;return!1}}),ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ot.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ot.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var Ni=ot.now(),Oi=/\?/,Ii=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;ot.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var i,n=null,s=ot.trim(t+"");return s&&!ot.trim(s.replace(Ii,function(e,t,s,o){return i&&t&&(n=0),0===n?e:(i=s||t,n+=!o-!s,"")}))?Function("return "+s)():ot.error("Invalid JSON: "+t)},ot.parseXML=function(t){var i,n;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(n=new DOMParser,i=n.parseFromString(t,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t))}catch(s){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||ot.error("Invalid XML: "+t),i};var Di,Ri,Pi=/#.*$/,Li=/([?&])_=[^&]*/,Vi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Fi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Bi=/^(?:GET|HEAD)$/,Hi=/^\/\//,zi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ji={},qi={},Ui="*/".concat("*");try{Ri=location.href}catch(Wi){Ri=mt.createElement("a"),Ri.href="",Ri=Ri.href}Di=zi.exec(Ri.toLowerCase())||[],ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ri,type:"GET",isLocal:Fi.test(Di[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ui,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?H(H(e,ot.ajaxSettings),t):H(ot.ajaxSettings,e)},ajaxPrefilter:F(ji),ajaxTransport:F(qi),ajax:function(e,t){function i(e,t,i,n){var s,u,v,b,_,x=t;2!==y&&(y=2,r&&clearTimeout(r),c=void 0,a=n||"",w.readyState=e>0?4:0,s=e>=200&&300>e||304===e,i&&(b=z(d,w,i)),b=j(d,b,w,s),s?(d.ifModified&&(_=w.getResponseHeader("Last-Modified"),_&&(ot.lastModified[o]=_),_=w.getResponseHeader("etag"),_&&(ot.etag[o]=_)),204===e||"HEAD"===d.type?x="nocontent":304===e?x="notmodified":(x=b.state,u=b.data,v=b.error,s=!v)):(v=x,(e||!x)&&(x="error",0>e&&(e=0))),w.status=e,w.statusText=(t||x)+"",s?f.resolveWith(h,[u,x,w]):f.rejectWith(h,[w,x,v]),w.statusCode(g),g=void 0,l&&p.trigger(s?"ajaxSuccess":"ajaxError",[w,d,s?u:v]),m.fireWith(h,[w,x]),l&&(p.trigger("ajaxComplete",[w,d]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,s,o,a,r,l,c,u,d=ot.ajaxSetup({},t),h=d.context||d,p=d.context&&(h.nodeType||h.jquery)?ot(h):ot.event,f=ot.Deferred(),m=ot.Callbacks("once memory"),g=d.statusCode||{},v={},b={},y=0,_="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!u)for(u={};t=Vi.exec(a);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return y||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)g[t]=[g[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||_;return c&&c.abort(t),i(0,t),this}};if(f.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,d.url=((e||d.url||Ri)+"").replace(Pi,"").replace(Hi,Di[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=ot.trim(d.dataType||"*").toLowerCase().match(_t)||[""],null==d.crossDomain&&(n=zi.exec(d.url.toLowerCase()),d.crossDomain=!(!n||n[1]===Di[1]&&n[2]===Di[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Di[3]||("http:"===Di[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ot.param(d.data,d.traditional)),B(ji,d,t,w),2===y)return w;l=d.global,l&&0===ot.active++&&ot.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Bi.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(Oi.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Li.test(o)?o.replace(Li,"$1_="+Ni++):o+(Oi.test(o)?"&":"?")+"_="+Ni++)),d.ifModified&&(ot.lastModified[o]&&w.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&w.setRequestHeader("If-None-Match",ot.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ui+"; q=0.01":""):d.accepts["*"]);for(s in d.headers)w.setRequestHeader(s,d.headers[s]);if(d.beforeSend&&(d.beforeSend.call(h,w,d)===!1||2===y))return w.abort();_="abort";for(s in{success:1,error:1,complete:1})w[s](d[s]);if(c=B(qi,d,t,w)){w.readyState=1,l&&p.trigger("ajaxSend",[w,d]),d.async&&d.timeout>0&&(r=setTimeout(function(){w.abort("timeout")},d.timeout));try{y=1,c.send(v,i)}catch(x){if(!(2>y))throw x;i(-1,x)}}else i(-1,"No Transport");return w},getJSON:function(e,t,i){return ot.get(e,t,i,"json")},getScript:function(e,t){return ot.get(e,void 0,t,"script")}}),ot.each(["get","post"],function(e,t){ot[t]=function(e,i,n,s){return ot.isFunction(i)&&(s=s||n,n=i,i=void 0),ot.ajax({url:e,type:t,dataType:s,data:i,success:n})}}),ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ot.fn[t]=function(e){return this.on(t,e)}}),ot._evalUrl=function(e){return ot.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ot.fn.extend({wrapAll:function(e){if(ot.isFunction(e))return this.each(function(t){ot(this).wrapAll(e.call(this,t))});if(this[0]){var t=ot(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(ot.isFunction(e)?function(t){ot(this).wrapInner(e.call(this,t))}:function(){var t=ot(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ot.isFunction(e);return this.each(function(i){ot(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}}),ot.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!nt.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||ot.css(e,"display"))},ot.expr.filters.visible=function(e){return!ot.expr.filters.hidden(e)};var Yi=/%20/g,Gi=/\[\]$/,Ji=/\r?\n/g,Ki=/^(?:submit|button|image|reset|file)$/i,Qi=/^(?:input|select|textarea|keygen)/i;ot.param=function(e,t){var i,n=[],s=function(e,t){t=ot.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(e)||e.jquery&&!ot.isPlainObject(e))ot.each(e,function(){s(this.name,this.value)});else for(i in e)q(i,e[i],t,s);return n.join("&").replace(Yi,"+")},ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ot.prop(this,"elements");return e?ot.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ot(this).is(":disabled")&&Qi.test(this.nodeName)&&!Ki.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var i=ot(this).val();return null==i?null:ot.isArray(i)?ot.map(i,function(e){return{name:t.name,value:e.replace(Ji,"\r\n")}}):{name:t.name,value:i.replace(Ji,"\r\n")}}).get()}}),ot.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&U()||W()}:U;var Xi=0,Zi={},en=ot.ajaxSettings.xhr();e.ActiveXObject&&ot(e).on("unload",function(){for(var e in Zi)Zi[e](void 0,!0)}),nt.cors=!!en&&"withCredentials"in en,en=nt.ajax=!!en,en&&ot.ajaxTransport(function(e){if(!e.crossDomain||nt.cors){var t;return{send:function(i,n){var s,o=e.xhr(),a=++Xi;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)o[s]=e.xhrFields[s];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)void 0!==i[s]&&o.setRequestHeader(s,i[s]+"");o.send(e.hasContent&&e.data||null),t=function(i,s){var r,l,c;if(t&&(s||4===o.readyState))if(delete Zi[a],t=void 0,o.onreadystatechange=ot.noop,s)4!==o.readyState&&o.abort();else{c={},r=o.status,"string"==typeof o.responseText&&(c.text=o.responseText);try{l=o.statusText}catch(u){l=""}r||!e.isLocal||e.crossDomain?1223===r&&(r=204):r=c.text?200:404}c&&n(r,l,c,o.getAllResponseHeaders())},e.async?4===o.readyState?setTimeout(t):o.onreadystatechange=Zi[a]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ot.globalEval(e),e}}}),ot.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ot.ajaxTransport("script",function(e){if(e.crossDomain){var t,i=mt.head||ot("head")[0]||mt.documentElement;return{send:function(n,s){t=mt.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,i){(i||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,i||s(200,"success"))},i.insertBefore(t,i.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var tn=[],nn=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||ot.expando+"_"+Ni++;return this[e]=!0,e}}),ot.ajaxPrefilter("json jsonp",function(t,i,n){var s,o,a,r=t.jsonp!==!1&&(nn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=ot.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(nn,"$1"+s):t.jsonp!==!1&&(t.url+=(Oi.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return a||ot.error(s+" was not called"),a[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){a=arguments},n.always(function(){e[s]=o,t[s]&&(t.jsonpCallback=i.jsonpCallback,tn.push(s)),a&&ot.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),ot.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||mt;var n=ht.exec(e),s=!i&&[];return n?[t.createElement(n[1])]:(n=ot.buildFragment([e],t,s),s&&s.length&&ot(s).remove(),ot.merge([],n.childNodes))};var sn=ot.fn.load;ot.fn.load=function(e,t,i){if("string"!=typeof e&&sn)return sn.apply(this,arguments);var n,s,o,a=this,r=e.indexOf(" ");return r>=0&&(n=e.slice(r,e.length),e=e.slice(0,r)),ot.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&ot.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){s=arguments,a.html(n?ot("<div>").append(ot.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,s||[e.responseText,t,e])}),this},ot.expr.filters.animated=function(e){return ot.grep(ot.timers,function(t){return e===t.elem}).length};var on=e.document.documentElement;ot.offset={setOffset:function(e,t,i){var n,s,o,a,r,l,c,u=ot.css(e,"position"),d=ot(e),h={};"static"===u&&(e.style.position="relative"),r=d.offset(),o=ot.css(e,"top"),l=ot.css(e,"left"),c=("absolute"===u||"fixed"===u)&&ot.inArray("auto",[o,l])>-1,c?(n=d.position(),a=n.top,s=n.left):(a=parseFloat(o)||0,s=parseFloat(l)||0),ot.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(h.top=t.top-r.top+a),null!=t.left&&(h.left=t.left-r.left+s),"using"in t?t.using.call(e,h):d.css(h)}},ot.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ot.offset.setOffset(this,e,t)});var t,i,n={top:0,left:0},s=this[0],o=s&&s.ownerDocument;return o?(t=o.documentElement,ot.contains(t,s)?(typeof s.getBoundingClientRect!==Ct&&(n=s.getBoundingClientRect()),i=Y(o),{top:n.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===ot.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ot.nodeName(e[0],"html")||(i=e.offset()),i.top+=ot.css(e[0],"borderTopWidth",!0),i.left+=ot.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ot.css(n,"marginTop",!0),left:t.left-i.left-ot.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||on;e&&!ot.nodeName(e,"html")&&"static"===ot.css(e,"position");)e=e.offsetParent;return e||on})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i=/Y/.test(t);ot.fn[e]=function(n){return Mt(this,function(e,n,s){var o=Y(e);return void 0===s?o?t in o?o[t]:o.document.documentElement[n]:e[n]:void(o?o.scrollTo(i?ot(o).scrollLeft():s,i?s:ot(o).scrollTop()):e[n]=s)},e,n,arguments.length,null)}}),ot.each(["top","left"],function(e,t){ot.cssHooks[t]=T(nt.pixelPosition,function(e,i){return i?(i=ii(e,t),si.test(i)?ot(e).position()[t]+"px":i):void 0})}),ot.each({Height:"height",Width:"width"},function(e,t){ot.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){ot.fn[n]=function(n,s){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||s===!0?"margin":"border");
return Mt(this,function(t,i,n){var s;return ot.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===n?ot.css(t,i,a):ot.style(t,i,n,a)},t,o?n:void 0,o,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot});var an=e.jQuery,rn=e.$;return ot.noConflict=function(t){return e.$===ot&&(e.$=rn),t&&e.jQuery===ot&&(e.jQuery=an),ot},typeof t===Ct&&(e.jQuery=e.$=ot),ot}),function(){var e,t=this,i=t.Backbone,n=[],s=n.push,o=n.slice,a=n.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var r=t._;r||"undefined"==typeof require||(r=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=e.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var n=this,s=r.once(function(){n.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,i)},off:function(e,t,i){var n,s,o,a,l,c,d,h;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:r.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=n=[],t||i)for(d=0,h=o.length;h>d;d++)s=o[d],(t&&t!==s.callback&&t!==s.callback._callback||i&&i!==s.context)&&n.push(s);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&d(i,t),n&&d(n,arguments),this},stopListening:function(e,t,i){var n=this._listeners;if(!n)return this;var s=!t&&!i;"object"==typeof t&&(i=this),e&&((n={})[e._listenerId]=e);for(var o in n)n[o].off(t,i,this),s&&delete this._listeners[o];return this}},c=/\s+/,u=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)e[t].apply(e,[s,i[s]].concat(n));return!1}if(c.test(i)){for(var o=i.split(c),a=0,r=o.length;r>a;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},d=function(e,t){var i,n=-1,s=e.length,o=t[0],a=t[1],r=t[2];switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a,r);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};r.each(h,function(e,t){l[t]=function(t,i,n){var s=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=r.uniqueId("l"));return s[o]=t,"object"==typeof i&&(n=this),t[e](i,n,this),this}}),l.bind=l.on,l.unbind=l.off,r.extend(e,l);var p=e.Model=function(e,t){var i,n=e||{};t||(t={}),this.cid=r.uniqueId("c"),this.attributes={},r.extend(this,r.pick(t,f)),t.parse&&(n=this.parse(n,t)||{}),(i=r.result(this,"defaults"))&&(n=r.defaults({},n,i)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)},f=["url","urlRoot","collection"];r.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,s,o,a,l,c,u,d;if(null==e)return this;if("object"==typeof e?(s=e,i=t):(s={})[e]=t,i||(i={}),!this._validate(s,i))return!1;o=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=r.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(n in s)t=s[n],r.isEqual(d[n],t)||a.push(n),r.isEqual(u[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete d[n]:d[n]=t;if(!l){a.length&&(this._pending=!0);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,d[a[h]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!r.isEmpty(this.changed):r.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?r.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var s in e)r.isEqual(n[s],t=e[s])||((i||(i={}))[s]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},L(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,s,o,a=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,!(!n||i&&i.wait||this.set(n,i)))return!1;if(i=r.extend({validate:!0},i),!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=r.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=r.extend(n||{},t)),r.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},L(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=n),o=this.sync(s,this,i),n&&i.wait&&(this.attributes=a),o},destroy:function(e){e=e?r.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(s){(e.wait||t.isNew())&&n(),i&&i(t,s,e),t.isNew()||t.trigger("sync",t,s,e)},this.isNew())return e.success(),!1;L(this,e);var s=this.sync("delete",this,e);return e.wait||n(),s},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||P();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},r.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,r.extend(t||{},{validationError:i})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];r.each(m,function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),r[e].apply(r,t)}});var g=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,r.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};r.extend(g.prototype,l,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.defaults(t||{},b))},remove:function(e,t){e=r.isArray(e)?e.slice():[e],t||(t={});var i,n,s,o;for(i=0,n=e.length;n>i;i++)o=this.get(e[i]),o&&(delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=r.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),r.isArray(e)||(e=e?[e]:[]);var i,n,o,l,c,u=t.at,d=this.comparator&&null==u&&t.sort!==!1,h=r.isString(this.comparator)?this.comparator:null,p=[],f=[],m={};for(i=0,n=e.length;n>i;i++)(o=this._prepareModel(e[i],t))&&((l=this.get(o))?(t.remove&&(m[l.cid]=!0),t.merge&&(l.set(o.attributes,t),d&&!c&&l.hasChanged(h)&&(c=!0))):t.add&&(p.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(i=0,n=this.length;n>i;++i)m[(o=this.models[i]).cid]||f.push(o);f.length&&this.remove(f,t)}if(p.length&&(d&&(c=!0),this.length+=p.length,null!=u?a.apply(this.models,[u,0].concat(p)):s.apply(this.models,p)),c&&this.sort({silent:!0}),t.silent)return this;for(i=0,n=p.length;n>i;i++)(o=p[i]).trigger("add",o,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),this.add(e,r.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,r.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,r.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return r.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=r.isFunction(t)?t:function(e){return e.get(t)};return r.sortedIndex(this.models,e,n,i)},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var s=e.reset?"reset":"set";i[s](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},L(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?r.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(s){t.wait&&i.add(e,t),n&&n(e,s,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(y,function(e){g.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),r[e].apply(r,t)}});var _=["groupBy","countBy","sortBy"];r.each(_,function(e){g.prototype[e]=function(t,i){var n=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,n,i)}});var w=e.View=function(e){this.cid=r.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];r.extend(w.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=r.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(r.isFunction(i)||(i=this[e[t]]),i){var n=t.match(x),s=n[1],o=n[2];i=r.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=r.extend({},r.result(this,"options"),e)),r.extend(this,r.pick(e,k)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"),!1);else{var t=r.extend({},r.result(this,"attributes"));this.id&&(t.id=r.result(this,"id")),this.className&&(t["class"]=r.result(this,"className"));var i=e.$("<"+r.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,n){var s=C[t];r.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(n.url||(o.url=r.result(i,"url")||P()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",n.emulateJSON&&(o.data._method=s);var a=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(r.extend(o,n));return i.trigger("request",i,l,n),l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,A=/\*\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(S.prototype,l,{initialize:function(){},route:function(t,i,n){r.isRegExp(t)||(t=this._routeToRegExp(t)),r.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var s=this;return e.history.route(t,function(o){var a=s._extractParameters(t,o);n&&n.apply(s,a),s.trigger.apply(s,["route:"+i].concat(a)),s.trigger("route",i,a),e.history.trigger("route",s,i,a)}),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var e,t=r.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace($,"\\$&").replace(T,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return r.map(i,function(e){return e?decodeURIComponent(e):null})}});var M=e.History=function(){this.handlers=[],r.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,I=/msie [\w.]+/,D=/\/$/;M.started=!1,r.extend(M.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(D,"");e.indexOf(i)||(e=e.substr(i.length))}else e=this.getHash();return e.replace(N,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=r.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,s=I.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(O,"/"),s&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),i=r.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return i},navigate:function(e,t){if(!M.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var i=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),e.history=new M;var R=function(e,t){var i,n=this;i=e&&r.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},r.extend(i,n,t);var s=function(){this.constructor=i};return s.prototype=n.prototype,i.prototype=new s,e&&r.extend(i.prototype,e),i.__super__=n.prototype,i};p.extend=g.extend=S.extend=w.extend=M.extend=R;var P=function(){throw new Error('A "url" property or function must be specified')},L=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t;return t||e.Backbone}}(this)),define("core-ui/textinput",["app","backbone"],function(e,t){var i={};i.id="textinput",i.dataTypes=["VARCHAR","DATE","TIME","ENUM"],i.variables=[{id:"readonly",ui:"checkbox"},{id:"size",ui:"select",options:{options:{large:"Large",medium:"Medium",small:"Small"}}},{id:"placeholder_text",ui:"textinput",char_length:200},{id:"validation_type",ui:"select",options:{options:{bl:"Character Blacklist",wl:"Character Whitelist",rgx:"Regex"}},def:"rgx"},{id:"validation_string",ui:"textinput",char_length:200,comment:"All Characters below will be enforced"},{id:"validation_message",ui:"textinput",char_length:200}];var n='<div class="char-count-container {{size}}">                     <input type="text" placeholder="{{placeholder}}" value="{{value}}" name="{{name}}" id="{{name}}" maxLength="{{maxLength}}" class="{{size}}" {{#if readonly}}readonly{{/if}}/>                   <span class="char-count hide">{{characters}}</span></div>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"focus input":function(){this.$el.find(".char-count").removeClass("hide")},"input input":"updateMaxLength","keypress input":"validateString","blur input":function(){this.$el.find(".char-count").addClass("hide")}},updateMaxLength:function(e){var t=this.options.schema.get("char_length")-e.target.value.length;this.$el.find(".char-count").html(t)},afterRender:function(){"on"===this.options.settings.get("readonly")&&this.$("input").prop("readonly",!0)},serialize:function(){var e=this.options.schema.get("char_length"),t=this.options.value||"";return!t&&this.options.model.isNew()&&this.options.schema.has("default_value")&&(t=this.options.schema.get("default_value")),{size:this.options.settings&&this.options.settings.has("size")?this.options.settings.get("size"):"large",value:t,name:this.options.name,maxLength:e,characters:e-t.toString().length,comment:this.options.schema.get("comment"),readonly:this.options.settings&&"1"===this.options.settings.get("readonly")||!this.options.canWrite,placeholder:this.options.settings?this.options.settings.get("placeholder_text"):""}},validateString:function(t){{var i;this.options.settings.get("validation_message")||e.DEFAULT_VALIDATION_MESSAGE}switch(this.options.settings.get("validation_type")){case"bl":return i=this.options.settings.get("validation_string").split(""),-1==$.inArray(String.fromCharCode(t.which),i);case"wl":return i=this.options.settings.get("validation_string").split(""),-1!=$.inArray(String.fromCharCode(t.which),i)}return!0}}),i.validate=function(t,i){var n=i.settings.get("validation_message")||e.DEFAULT_VALIDATION_MESSAGE;if(i.schema.get("required")&&_.isEmpty(t))return n;switch(i.settings.get("validation_type")){case"wl":var s=new RegExp("^["+i.settings.get("validation_string")+"]+$");if(!t.match(s))return n;break;case"bl":var o=i.settings.get("validation_string").split("");if(o.length>0&&t.match(o.join("|")))return n;break;case"rgx":var a=new RegExp(i.settings.get("validation_string"));if(!a.test(t))return n}},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/directus_columns",["app","backbone"],function(e,t){var i={};i.id="directus_columns",i.dataTypes=["VARCHAR"],i.variables=[];var n='{{#columns}}<label><input type="checkbox" name="{{../name}}" value="{{columnName}}" {{#if selected}}checked{{/if}}>{{title}}</label>{{/columns}}';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{},serialize:function(){return{name:this.options.name,note:this.options.schema.get("comment"),columns:this.columns}},initialize:function(t){var i=t.model.getTable(),n=i.id,s=e.schemaManager.getColumns[n].pluck("column_name"),o=this.options.value?this.options.value.split(","):[];this.columns=_.map(s,function(t){var i={columnName:t,title:e.capitalize(t)};return _.contains(o,t)&&(i.selected=!0),i})}}),i.validate=function(){},i.list=function(e){return e.value},i}),define("core-ui/instructions",["app","backbone"],function(e,t){var i={};i.id="instructions",i.dataTypes=["VARCHAR","TEXT"],i.variables=[{id:"instructions",ui:"wysiwyg",options:{h1:!0,ul:!0,ol:!0}}];var n='<style type="text/css">                   .instructions-ui-content {                     line-height: 20px;                     max-width: 675px;                   }                   .instructions-ui-content h1 {                     margin: 10px 0 10px 0;                   }                   </style>                   <div class="instructions-ui-content">{{{instructions}}}</div>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{},afterRender:function(){},serialize:function(){var e=this.options.value||"";return{value:e,name:this.options.name,comment:this.options.schema.get("comment"),instructions:this.options.settings&&this.options.settings.has("instructions")?this.options.settings.get("instructions"):"Please have your admin setup this field."}},initialize:function(){}}),i.validate=function(){},i.list=function(e){var t=e.settings&&e.settings.has("instructions")?e.settings.get("instructions"):"...",i=/(<([^>]+)>)/gi;return t.replace(i,"")},i}),define("core-ui/checkbox",["app","backbone"],function(e,t){var i={},n='<input style="height: 34px;" type="checkbox" {{#if readonly}}disabled{{/if}} {{#if selected}}checked{{/if}}/>                   <input type="hidden" name="{{name}}" value="{{#if selected}}1{{else}}0{{/if}}">';return i.id="checkbox",i.dataTypes=["TINYINT"],i.variables=[],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"change input[type=checkbox]":function(){var e=void 0===this.$el.find("input[type=checkbox]:checked").val()?0:1;this.$el.find("input[type=hidden]").val(e)}},serialize:function(){var e=this.options.value;void 0===e&&this.options.schema.has("def")&&(e=this.options.schema.get("def"));var t=1===parseInt(e,10)?!0:!1;return this.options.model.isNew()&&this.options.schema.has("default_value")&&(t=1===parseInt(this.options.schema.get("default_value"),10)),{name:this.options.name,selected:t,comment:this.options.schema.get("comment"),readonly:!this.options.canWrite}}}),i.validate=function(e,t){return t.schema.isRequired()&&0==e?"This field is required":void 0},i.list=function(e){var t=e.value?'<input type="checkbox" checked="true" disabled>':'<input type="checkbox" disabled>';return t},i}),define("core-ui/color",["app","backbone"],function(e,t){var i={};i.id="color",i.dataTypes=["VARCHAR"],i.variables=[{id:"readonly",ui:"checkbox"},{id:"show_color_on_list",ui:"checkbox"}];var n='<style type="text/css">                   .position-offset {                     position: relative;                   }                   input.color-box {                     margin-left: 10px;                     width: 24px;                     padding-top: 6px;                     padding-bottom: 6px;                     height: 26px;                     display: inline-block;                     top: -11px;                     left: 0;                     position: absolute;                   }                   input.color-text.invalid {                     border-color: #EB2A49;                   }                   input.color-text.invalid:focus {                     -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(235,42,73,.3);                     -moz-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(235,42,73,.3);                     box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(235,42,73,.3);                   }                   span.invalid {                     color: #EB2A49;                     margin-left: 10px;                   }                   </style>                   <input type="text" class="color-text small" value="{{value}}" maxlength="7" placeholder="#bbbbbb"><span class="position-offset"><input type="color" class="color-box" value="{{value}}" name="{{name}}" id="{{name}}" placeholder="e.g. #bbbbbb"></span> <span class="invalid"></span>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"change .color-text":function(e){var t=e.target.value;null!==t.match(/^#[a-f0-9]{6}$/i)?(this.$el.find("input.color-box").val(t),this.$el.find("span.invalid").html(""),this.$el.find("input.color-text").removeClass("invalid")):(this.$el.find("span.invalid").html("Invalid color <i>e.g. #bbbbbb</i>"),this.$el.find("input.color-text").addClass("invalid"))},"change .color-box":function(e){var t=e.target.value;this.$el.find("input.color-text").val(t),this.$el.find("span.invalid").html(""),this.$el.find("input.color-text").removeClass("invalid")}},afterRender:function(){},serialize:function(){var e=this.options.value||"";return{value:e,name:this.options.name,comment:this.options.schema.get("comment")}},initialize:function(){}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){var t=e.settings&&e.settings.has("show_color_on_list")&&"1"==e.settings.get("show_color_on_list")?!0:!1;return t?'<div style="background-color:'+e.value+'; height:20px; width:40px; border:1px solid #ffffff;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;">&nbsp;</div>':e.value},i}),define("core-ui/numeric",["app","backbone"],function(e,t){var i={},n='<input type="text" value="{{value}}" name="{{name}}" id="{{name}}" class="{{size}}" {{#if readonly}}readonly{{/if}}/>';return i.id="numeric",i.dataTypes=["TINYINT","INT","NUMERIC","FLOAT","YEAR","VARCHAR","CHAR","DOUBLE","BIGINT"],i.variables=[{id:"size",ui:"select",options:{options:{large:"Large",medium:"Medium",small:"Small"}}},{id:"allow_null",ui:"checkbox",def:"0"}],i.Input=t.Layout.extend({template:Handlebars.compile(n),tagName:"div",attributes:{"class":"field"},events:{"keyup input":"checkChars","blur input":"checkChars"},checkChars:function(){var e=this.$el.find("input"),t=e.val();t=t.replace(/[^0-9-.]/gi,""),e.val(t)},serialize:function(){var e="";return isNaN(this.options.value)||(e=this.options.value),void 0===this.options.value&&this.options.schema.has("default_value")&&(e=this.options.schema.get("default_value")),{value:e,name:this.options.name,size:this.options.settings&&this.options.settings.has("size")?this.options.settings.get("size"):"large",comment:this.options.schema.get("comment"),readonly:!this.options.canWrite}},initialize:function(){}}),i.validate=function(e,t){return t.schema.isRequired()&&!e?"This field is required":void 0},i.list=function(e){var t=e.value;return t},i}),define("core-ui/slider",["app","backbone"],function(e,t){var i={};i.id="slider",i.dataTypes=["INT"],i.variables=[{id:"minimum",ui:"numeric"},{id:"maximum",ui:"numeric"},{id:"step",ui:"numeric",comment:"Specifies the allowed number intervals"}];var n='<style type="text/css">                   span.slider-value {                     margin-left: 10px;                   }                   </style>                   <input type="range" class="slider" value="{{value}}" name="{{name}}" id="{{name}}" min="{{min}}" max="{{max}}" step="{{step}}"> <span class="slider-value">{{value}}</span>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"change .slider":function(e){var t=e.target.value;this.$el.find("span.slider-value").html(t)}},afterRender:function(){},serialize:function(){return{value:this.options.value||"0",name:this.options.name,min:this.options.settings&&this.options.settings.has("minimum")?this.options.settings.get("minimum"):"0",max:this.options.settings&&this.options.settings.has("maximum")?this.options.settings.get("maximum"):"100",step:this.options.settings&&this.options.settings.has("step")?this.options.settings.get("step"):"1",comment:this.options.schema.get("comment")}},initialize:function(){}}),i.validate=function(e,t){return t.schema.isRequired()&&!e?"This field is required":void 0},i.list=function(e){return e.value},i}),define("core/table/table.headview",["app","backbone"],function(e,t){var i=t.Layout.extend({template:"tables/table-head",tagName:"thead",events:{"click th.check > input":function(){$("td.check > input").prop("checked",void 0!==$("#check-all:checked").prop("checked")).trigger("changed"),this.collection.trigger("select")},"click th:not(.check, .visible-columns-cell)":function(e){var t=$(e.target).closest("th").attr("data-id"),i=this.collection.getOrder(),n="ASC",s=i.sort===t&&i.sort_order!=n,o=this.collection.junctionStructure||this.collection.structure,a=o.where({column_name:"sort"}).length?"sort":"id";
return"sort"==t||s?void this.collection.setOrder(a,n):void(t!=i.sort?this.collection.setOrder(t,n):(i.sort_order==n&&(n="DESC"),this.collection.setOrder(t,n)))},"click #set-visible-columns":function(){if(this.visibleColumnsView)return this.visibleColumnsView=null,void this.removeView("#visible_columns_entry");var e=this.options.collection.structure,i=this.collection.preferences,n=this.collection,s=i.get("columns_visible").split(","),o={},a=0;o.columns=e.chain().filter(function(e){return!e.get("system")&&!e.get("hidden_list")}).map(function(e){var t=_.contains(s,e.id),i=_.contains(["MANYTOMANY","ONETOMANY"],e.getRelationshipType());return t&&a++,{name:e.id,visible:t,disabled:i,isForeign:i}},this).value(),a>=this.maxColumns&&(o.columns=_.map(o.columns,function(e){return e.visible||(e.disabled=!0),e})),o.maxColumns=this.maxColumns;var r=t.Layout.extend({events:{"click input":function(){var e=this.$el.find("input:checked"),t=this.options.data.maxColumns;e.length>=t?this.disableNonSelected():this.enableNonSelected()},"click #saveVisibleColumnsBtn":function(){this.save()},"click #cancelVisibleColumnsBtn":function(){this.cancelSelection()}},disableNonSelected:function(){this.$el.find("input:not(:checked)").each(function(e,t){$(t).prop("disabled",!0)})},enableNonSelected:function(){this.$el.find("input:disabled").each(function(e,t){var i=$(t);i.attr("data-foreign")||i.prop("disabled",!1)})},template:"tables/table-set-columns",serialize:function(){return this.options.data}});this.visibleColumnsView=new r({data:o});var l=this;this.visibleColumnsView.cancelSelection=function(){l.visibleColumnsView=null,this.remove()},this.visibleColumnsView.save=function(){var e=this.$el.find("form").serializeObject(),t=_.isArray(e.columns_visible)?e.columns_visible.join(","):e.columns_visible,s=this;i.save({columns_visible:t},{success:function(){n.trigger("visibility"),s.cancelSelection()}}),l.collection.filters.columns_visible=e.columns_visible,l.collection.fetch()},this.render()},"click .sortableHeader":function(){this.parentView.sortableWidget.options.sort?(this.$el.closest("table").addClass("disable-sorting"),this.parentView.sortableWidget.options.sort=!1,noty({text:"<b>Sorting Disabled</b><br><i>Drag-and-drop sorting is now disabled</i>",type:"information",timeout:3e3,theme:"directus"})):(this.$el.closest("table").removeClass("disable-sorting"),this.parentView.sortableWidget.options.sort=!0,noty({text:"<b>Sorting Enabled</b><br><i>You can now sort items with drag-and-drop</i>",type:"information",timeout:3e3,theme:"directus"}))},"click th:not(.sortableHeader)":function(){this.parentView.sortableWidget&&this.parentView.sortableWidget.options.sort&&(this.$el.closest("table").addClass("disable-sorting"),this.parentView.sortableWidget.options.sort=!1,noty({text:"<b>Sorting Disabled</b><br><i>Drag-and-drop sorting is now disabled</i>",type:"information",timeout:3e3,theme:"directus"}))}},beforeRender:function(){this.visibleColumnsView&&this.setView("#visible_columns_entry",this.visibleColumnsView)},serialize:function(){var e=this.collection.getOrder(),t=_.map(this.options.columns,function(t){return{name:t,orderBy:t===e.sort,desc:"DESC"===e.sort_order}});return{selectable:this.options.selectable,sortable:this.options.sort,columns:t,deleteColumn:this.options.deleteColumn,hideColumnPreferences:this.options.hideColumnPreferences}},initialize:function(e){this.parentView=e.parentView,this.maxColumns=this.options.maxColumns||8;var t=this;this.collection.preferences&&(this.collection.filters.columns_visible=[],this.collection.preferences.get("columns_visible").split(",").forEach(function(e){void 0!==t.collection.structure.get(e)&&t.collection.filters.columns_visible.push(e)})),this.collection.on("sort",this.render,this)}});return i}),function(e){"function"==typeof define&&define.amd?define("sortable",e):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e():"undefined"!=typeof Package?Sortable=e():window.Sortable=e()}(function(){function e(e,i){this.el=e,this.options=i=i||{};var n={group:Math.random(),sort:!0,store:null,handle:null,draggable:e.children[0]&&e.children[0].nodeName||(/[uo]l/i.test(e.nodeName)?"li":"*"),ghostClass:"sortable-ghost",ignore:"a, img",filter:null,animation:0,setData:function(e,t){e.setData("Text",t.textContent)}};for(var o in n)!(o in i)&&(i[o]=n[o]);i.group.name||(i.group={name:i.group}),["pull","put"].forEach(function(e){e in i.group||(i.group[e]=!0)}),M.forEach(function(n){i[n]=t(this,i[n]||N),s(e,n.substr(2).toLowerCase(),i[n])},this),e[k]=i.group.name;for(var a in this)"_"===a.charAt(0)&&(this[a]=t(this,this[a]));s(e,"mousedown",this._onTapStart),s(e,"touchstart",this._onTapStart),E&&s(e,"selectstart",this._onTapStart),s(e,"dragover",this._onDragOver),s(e,"dragenter",this._onDragOver),I.push(this._onDragOver),i.store&&this.sort(i.store.get(this))}function t(e,t){var i=O.call(arguments,2);return t.bind?t.bind.apply(t,[e].concat(i)):function(){return t.apply(e,i.concat(O.call(arguments)))}}function i(e,t,i){if("*"===t)return e;if(e){i=i||S,t=t.split(".");var n=t.shift().toUpperCase(),s=new RegExp("\\s("+t.join("|")+")\\s","g");do if(!(""!==n&&e.nodeName!=n||t.length&&((" "+e.className+" ").match(s)||[]).length!=t.length))return e;while(e!==i&&(e=e.parentNode))}return null}function n(e){e.dataTransfer.dropEffect="move",e.preventDefault()}function s(e,t,i){e.addEventListener(t,i,!1)}function o(e,t,i){e.removeEventListener(t,i,!1)}function a(e,t,i){if(e)if(e.classList)e.classList[i?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(/\s+/g," ").replace(" "+t+" ","");e.className=n+(i?" "+t:"")}}function r(e,t,i){var n=e&&e.style;if(n){if(void 0===i)return S.defaultView&&S.defaultView.getComputedStyle?i=S.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in n||(t="-webkit-"+t),n[t]=i+("string"==typeof i?"":"px")}}function l(e,t,i){if(e){var n=e.getElementsByTagName(t),s=0,o=n.length;if(i)for(;o>s;s++)i(n[s],s);return n}return[]}function c(e){e.draggable=!1}function u(){A=!1}function d(e,t){var i=e.lastElementChild,n=i.getBoundingClientRect();return t.clientY-(n.top+n.height)>5&&i}function h(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,n=0;i--;)n+=t.charCodeAt(i);return n.toString(36)}var p,f,m,g,v,b,y,_,w,x,k="Sortable"+(new Date).getTime(),C=window,S=C.document,T=C.parseInt,E=!!S.createElement("div").dragDrop,A=!1,$=function(e,t,i,n){var s=S.createEvent("Event");s.initEvent(t,!0,!0),s.item=i||e,s.from=n||e,e.dispatchEvent(s)},M="onAdd onUpdate onRemove onStart onEnd onFilter onSort".split(" "),N=function(){},O=[].slice,I=[];return e.prototype={constructor:e,_applyEffects:function(){a(p,this.options.ghostClass,!0)},_onTapStart:function(e){var t=e.touches&&e.touches[0],o=(t||e).target,a=this.options,u=this.el,d=a.filter;if("mousedown"!==e.type||0===e.button){if("function"==typeof d){if(d.call(this,o,this))return void $(u,"filter",o)}else if(d&&(d=d.split(",").filter(function(e){return i(o,e.trim(),u)}),d.length))return void $(u,"filter",o);if(a.handle&&(o=i(o,a.handle,u)),o=i(o,a.draggable,u),o&&"selectstart"==e.type&&"A"!=o.tagName&&"IMG"!=o.tagName&&o.dragDrop(),o&&!p&&o.parentNode===u){w=e,g=this.el,p=o,v=p.nextSibling,_=this.options.group,p.draggable=!0,a.ignore.split(",").forEach(function(e){l(o,e.trim(),c)}),t&&(w={target:o,clientX:t.clientX,clientY:t.clientY},this._onDragStart(w,!0),e.preventDefault()),s(S,"mouseup",this._onDrop),s(S,"touchend",this._onDrop),s(S,"touchcancel",this._onDrop),s(this.el,"dragstart",this._onDragStart),s(this.el,"dragend",this._onDrop),s(S,"dragover",n);try{S.selection?S.selection.empty():window.getSelection().removeAllRanges()}catch(h){}$(p,"start"),"clone"==_.pull&&(m=p.cloneNode(!0),r(m,"display","none"),g.insertBefore(m,p))}}},_emulateDragOver:function(){if(x){r(f,"display","none");var e=S.elementFromPoint(x.clientX,x.clientY),t=e,i=this.options.group.name,n=I.length;if(t)do{if(t[k]===i){for(;n--;)I[n]({clientX:x.clientX,clientY:x.clientY,target:e,rootEl:t});break}e=t}while(t=t.parentNode);r(f,"display","")}},_onTouchMove:function(e){if(w){var t=e.touches[0],i=t.clientX-w.clientX,n=t.clientY-w.clientY,s="translate3d("+i+"px,"+n+"px,0)";x=t,r(f,"webkitTransform",s),r(f,"mozTransform",s),r(f,"msTransform",s),r(f,"transform",s),e.preventDefault()}},_onDragStart:function(e,t){var i=e.dataTransfer,n=this.options;if(this.isDragging=!0,this._offUpEvents(),t){var o,a=p.getBoundingClientRect(),l=r(p);f=p.cloneNode(!0),r(f,"top",a.top-T(l.marginTop,10)),r(f,"left",a.left-T(l.marginLeft,10)),r(f,"width",a.width),r(f,"height",a.height),r(f,"opacity","0.8"),r(f,"position","fixed"),r(f,"zIndex","100000"),g.appendChild(f),o=f.getBoundingClientRect(),r(f,"width",2*a.width-o.width),r(f,"height",2*a.height-o.height),s(S,"touchmove",this._onTouchMove),s(S,"touchend",this._onDrop),s(S,"touchcancel",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else i.effectAllowed="move",n.setData&&n.setData.call(this,i,p),s(S,"drop",this._onDrop);setTimeout(this._applyEffects)},_onDragOver:function(e){var t,n,s,o=this.el,a=this.options,l=a.group,c=l.put,h=_===l,w=a.sort;if(h&&!A&&(h?w||(s=!g.contains(p)):_.pull&&c&&(_.name===l.name||c.indexOf&&~c.indexOf(_.name)))&&(void 0===e.rootEl||e.rootEl===this.el)){if(t=i(e.target,a.draggable,o),n=p.getBoundingClientRect(),m&&m.state!==h&&(r(m,"display",h?"none":""),!h&&m.state&&g.insertBefore(m,p),m.state=h),s)return void(m||v?g.insertBefore(p,m||v):w||g.appendChild(p));if(0===o.children.length||o.children[0]===f||o===e.target&&(t=d(o,e))){if(t){if(t.animated)return;C=t.getBoundingClientRect()}o.appendChild(p),this._animate(n,p),t&&this._animate(C,t)}else if(t&&!t.animated&&t!==p&&void 0!==t.parentNode[k]){b!==t&&(b=t,y=r(t));var x,C=t.getBoundingClientRect(),S=C.right-C.left,T=C.bottom-C.top,E=/left|right|inline/.test(y.cssFloat+y.display),$=t.offsetWidth>p.offsetWidth,M=t.offsetHeight>p.offsetHeight,N=(E?(e.clientX-C.left)/S:(e.clientY-C.top)/T)>.5,O=t.nextElementSibling;A=!0,setTimeout(u,30),x=E?t.previousElementSibling===p&&!$||N&&$:O!==p&&!M||N&&M,x&&!O?o.appendChild(p):t.parentNode.insertBefore(p,x?O:t),this._animate(n,p),this._animate(C,t)}}},_animate:function(e,t){var i=this.options.animation;if(i){var n=t.getBoundingClientRect();r(t,"transition","none"),r(t,"transform","translate3d("+(e.left-n.left)+"px,"+(e.top-n.top)+"px,0)"),t.offsetWidth,r(t,"transition","all "+i+"ms"),r(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=setTimeout(function(){r(t,"transition",""),t.animated=!1},i)}},_offUpEvents:function(){o(S,"mouseup",this._onDrop),o(S,"touchmove",this._onTouchMove),o(S,"touchend",this._onDrop),o(S,"touchcancel",this._onDrop)},_onDrop:function(e){clearInterval(this._loopId),o(S,"drop",this._onDrop),o(S,"dragover",n),o(this.el,"dragend",this._onDrop),o(this.el,"dragstart",this._onDragStart),o(this.el,"selectstart",this._onTapStart),this._offUpEvents(),e&&(e.preventDefault(),e.stopPropagation(),f&&f.parentNode.removeChild(f),p&&(c(p),a(p,this.options.ghostClass,!1),g.contains(p)?p.nextSibling!==v&&($(p,"update"),$(p,"sort"),m&&m.parentNode.removeChild(m)):($(p,"sort"),$(g,"sort"),$(p,"add",p,g),$(g,"remove",p)),$(g,"end")),g=p=f=v=m=w=x=b=y=_=null,this.options.store&&this.options.store.set(this))},toArray:function(){for(var e,t=[],n=this.el.children,s=0,o=n.length;o>s;s++)e=n[s],i(e,this.options.draggable,this.el)&&t.push(e.getAttribute("data-id")||h(e));return t},sort:function(e){var t={},n=this.el;this.toArray().forEach(function(e,s){var o=n.children[s];i(o,this.options.draggable,n)&&(t[e]=o)},this),e.forEach(function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))})},closest:function(e,t){return i(e,t||this.options.draggable,this.el)},option:function(e,t){var i=this.options;return void 0===t?i[e]:void(i[e]=t)},destroy:function(){var e=this.el,t=this.options;M.forEach(function(i){o(e,i.substr(2).toLowerCase(),t[i])}),o(e,"mousedown",this._onTapStart),o(e,"touchstart",this._onTapStart),o(e,"selectstart",this._onTapStart),o(e,"dragover",this._onDragOver),o(e,"dragenter",this._onDragOver),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),I.splice(I.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},e.utils={on:s,off:o,css:r,find:l,bind:t,closest:i,toggleClass:a,dispatchEvent:$},e.version="0.7.1",e.create=function(t,i){return new e(t,i)},e}),define("core/table/table.bodyview",["app","backbone","sortable"],function(e,t,i){var n=t.Layout.extend({tagName:"tbody",template:"tables/table-body",events:{"change td.check > input":"select","click td.check > input":function(){this.collection.trigger("select")},"click .sort":function(e){return e.cancelBubble=!0,e.stopPropagation(),e.preventDefault(),!1},"mousedown .sort":function(e){$(e.target).closest(".disable-sorting").length>0&&noty({text:"<b>Sorting Disabled</b><br><i>Click the reordering icon to enable</i>",type:"information",timeout:4e3,theme:"directus"})}},select:function(e){var t=$(e.target);void 0!==t.attr("checked")?t.closest("tr").addClass("selected"):t.closest("tr").removeClass("selected")},serialize:function(){var t,i,n,s,o=this.collection.getFilter("active")||"1,2",a=this.options.highlight||[];t=this.options.rowIdentifiers,i=_.map(o,Number),n=this.collection.filter(function(t){return t.has(e.statusMapping.status_name)?_.indexOf(i,Number(t.get(e.statusMapping.status_name)))>-1:!0});var r=this.options.filters.expressions,l=this.options.filters.booleanOperator||"AND";void 0!==r&&(n=_.filter(n,function(t){var i=[];switch(_.each(r,function(n){var s=t.get(n.column,{flatten:!0});i.push(e.evaluateExpression(s,n.operator,n.value))}),l){case"||":return _.contains(i,!0);case"&&":return _.every(i,_.identity)}})),s=_.map(n,function(e){var i=_.map(t,function(t){return"row-"+t+"-"+e.get(t)}),n=_.contains(a,e.id);return{model:e,classes:i,highlight:n}});var c={columns:this.options.columns,rows:s,sortable:this.options.sort,selectable:this.options.selectable,deleteColumn:this.options.deleteColumn},u=this.options.blacklist;return c.columns=_.difference(c.columns,u),c},drop:function(){var e=this.collection;this.$("tr").each(function(t){e.get($(this).attr("data-id")).set({sort:t},{silent:!0})}),this.options.saveAfterDrop&&e.save({columns:["id","sort"]}),this.collection.setOrder("sort","ASC",{silent:!0})},initialize:function(e){if(this.options.filters=this.options.filters||{},this.sort=this.options.structure.get("sort")||e.sort,this.collection.on("sort",this.render,this),this.sort){var t=this.$el[0],n=this;e.parentView.sortableWidget=new i(t,{animation:150,handle:".sort",draggable:"tr",ghostClass:"sortable-ghost",sort:!1,onStart:function(){var e=jQuery(t);e.addClass("remove-hover-state"),e.removeClass("disable-transform")},onEnd:function(){var e=jQuery(t);e.removeClass("remove-hover-state"),e.addClass("disable-transform")},onUpdate:function(){n.drop()}})}}});return n}),define("core/table/table.footerview",["app","backbone"],function(e,t){var i=t.Layout.extend({tagName:"tfoot",template:"tables/table-foot",functions:{},events:{"change select":function(e){var t=$(e.target),i=t.find(":selected").val().toLowerCase(),n=$(e.target).attr("data-id"),s=this.collection.pluck(n),o=this.calculate(s,i);t.next("p").html(o)},"mouseover .footer-function":function(e){$(e.target).closest(".footer-function").find("ul").removeClass("hide")},"mouseout .footer-function":function(e){$(e.target).closest(".footer-function").find("ul").addClass("hide")},"click .footer-function li":function(e){this.functions[$(e.target).closest(".footer-function").attr("data-column")]=$(e.target).text(),this.render()}},calculate:function(e,t){var i=_.reduce(e,function(e,t){return e+t},0);switch(t){case"MIN":return String(_.min(e)).replace(/\B(?=(\d{3})+(?!\d))/g,",");case"MAX":return String(_.max(e)).replace(/\B(?=(\d{3})+(?!\d))/g,",");case"AVG":return String(Math.round(100*i/e.length)/100).replace(/\B(?=(\d{3})+(?!\d))/g,",");case"SUM":return String(i).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},serialize:function(){var e=_.map(this.collection.getColumns(),function(e){var t={title:e,isNumeric:"numeric"===this.collection.structure.get(e).get("ui"),selectedFunction:this.functions.hasOwnProperty(e)?this.functions[e]:"SUM"};return t.otherFunctions=_.without(["MIN","MAX","AVG","SUM"],t.selectedFunction),t.isNumeric&&(t.value=this.calculate(this.collection.pluck(e),t.selectedFunction)),t},this);return{columns:e,selectable:this.options.selectable,sortable:this.options.sortable}}});return i}),define("core/table/table.view",["app","backbone","core/table/table.headview","core/table/table.bodyview","core/table/table.footerview"],function(e,t,i,n,s){var o=t.Layout.extend({tagname:"div",attributes:{"class":"directus-table-container"},template:"tables/table",TableBody:n,serialize:function(){return{columns:this.options.columns,id:this.collection.table.id,selectable:this.options.selectable,sortable:this.options.sortable,showEmptyMessage:0===this.collection.length&&!this.options.hideEmptyMessage}},events:{"click tbody td:not(.check):not(.status):not(.sort)":function(e){var t=$(e.target).closest("tr").attr("data-id");this.options.navigate&&($(document).scrollTop(0),this.collection.off(),this.navigate(t))}},navigate:function(i){var n=t.history.fragment.split("/");n.push(i),e.router.go(n)},selection:function(){var e=[];return $("td.check > input:checked").each(function(){e.push(parseInt(this.value,10))}),e},beforeRender:function(){var e;this.startRenderTime=(new Date).getTime(),this.tableHead&&(e=this.options,e.parentView=this,this.insertView("table",new i(e))),this.collection.length>0&&(e=_.pick(this.options,"collection","selectable","filters","preferences","structure","sort","deleteColumn","rowIdentifiers","saveAfterDrop","blacklist","highlight","columns"),e.parentView=this,this.insertView("table",new this.TableBody(e))),this.collection.length>0&&this.collection.table.get("footer")&&this.options.footer!==!1&&(e=this.options,this.insertView("table",new s(e)))},afterRender:function(){(new Date).getTime()},initializeDrop:function(){var t,i=this.$el,n=this.collection,s=this.saveAfterDrop;i.on("dragover",function(e){clearInterval(t),e.stopPropagation(),e.preventDefault(),i.addClass("dragover")}),i.on("dragleave",function(){clearInterval(t),t=setInterval(function(){i.removeClass("dragover"),console.log("leave"),clearInterval(t)},50)}),this.el.ondrop=_.bind(function(t){t.stopPropagation(),t.preventDefault(),e.sendFiles(t.dataTransfer.files,function(t){_.each(t,function(t){t.user=e.users.getCurrentUser().id,t[e.statusMapping.status_name]=e.statusMapping.active_num,s?n.create(t):(console.log("ADD"),n.add(t,{nest:!0,parse:!0}))})}),i.removeClass("dragover")},this)},initialize:function(e){var t=this.collection,i=this.collection.structure,n=this.options.blacklist||[];this.listenTo(t,"sync",function(e,t,i){i.silent||this.render()}),this.listenTo(t,"visibility",function(){this.render()}),this.options.preferences=this.options.preferences||this.collection.preferences,this.options.structure=this.options.structure||this.collection.structure,this.options.table=this.options.table||this.collection.table,this.options.columns=_.filter(this.collection.getColumns(),function(e){var t=i.get(e),s=t&&t.get("hidden_input")!==!0;return!_.contains(n,e)&&s}),this.options.tableHead!==!1&&(this.tableHead=!0),t.length>0&&(this.tableHead=!0),void 0===this.options.sort&&(this.options.sort=t.hasColumn("sort")&&t.hasPermission&&t.hasPermission("bigedit")&&!t.isWriteBlacklisted("sort")),void 0===this.options.selectable&&(this.options.selectable=!0),this.saveAfterDrop=this.options.saveAfterDrop=void 0!==e.saveAfterDrop?e.saveAfterDrop:!0,(this.options.droppable||t.droppable)&&this.initializeDrop()},constructor:function(e){this.events&&(this.events=_.defaults(this.events,o.prototype.events)),t.Layout.__super__.constructor.call(this,e)}});return o}),define("core/baseHeaderView",["app","backbone"],function(e,t){return t.Layout.extend({template:"header/header",tagName:"div",lastHeaderHeight:0,attributes:{"class":"main-container"},serialize:function(){var e=this.options.headerOptions;return this.options.headerOptions.route.breadcrumbs&&this.options.headerOptions.route.breadcrumbs.length>1&&(e.route.lastBreadcrumbAnchor=this.options.headerOptions.route.breadcrumbs[this.options.headerOptions.route.breadcrumbs.length-1].anchor),e},beforeRender:function(){var e=this.options.headerOptions,t=this;e.leftToolbar&&e.leftToolbar.forEach(function(e){t.insertView("#tools-left-insert",e)}),e.rightToolbar&&e.rightToolbar.forEach(function(e){t.insertView("#tools-right-insert",e)}),e.leftSecondaryToolbar&&e.leftSecondaryToolbar.forEach(function(e){t.insertView("#tools-secondary-left-insert",e)}),e.rightSecondaryToolbar&&e.rightSecondaryToolbar.forEach(function(e){t.insertView("#tools-secondary-right-insert",e)})},afterRender:function(){var e=this.$el.find("#tools-secondary-left-insert").children().length+this.$el.find("#tools-secondary-right-insert").children().length;e>0&&this.$el.parent().parent().addClass("has-toolbar")},cleanup:function(){$(window).unbind("resize.app")},setMarginToHeaderHeight:function(){var e=$("#content .content-body"),t=e.scrollTop(),i=$(".header1").outerHeight(),n=i-this.lastHeaderHeight;i>0&&(e.css("margin-top",i+"px").scrollTop(t+n),this.lastHeaderHeight=i)}})}),define("core/BasePageView",["app","backbone","core/baseHeaderView"],function(e,t,i){return t.Layout.extend({template:"basePage",chooseView:function(e,t){return _.isUndefined(t)?e:e[t]},leftToolbar:function(){return[]},rightToolbar:function(){return[]},leftSecondaryToolbar:function(){return[]},rightSecondaryToolbar:function(){return[]},headerOptions:{},initToolbar:function(){this.headerOptions.leftToolbar=this.leftToolbar(),this.headerOptions.rightToolbar=this.rightToolbar(),this.headerOptions.leftSecondaryToolbar=this.leftSecondaryToolbar(),this.headerOptions.rightSecondaryToolbar=this.rightSecondaryToolbar(),this.headerView=new i({headerOptions:this.headerOptions}),this.setView("#fixedHeader",this.headerView)},reRender:function(){this.initToolbar(),this.headerView.render()},beforeRender:function(){this.initToolbar()},fetchHolding:[],tryFetch:function(){0===this.fetchHolding.length&&this.collection.fetch()},addHolding:function(e){this.fetchHolding.push(e)},removeHolding:function(e){this.fetchHolding.splice(this.fetchHolding.indexOf(e),1),this.tryFetch()}})}),define("core/ListViewManager",["require","exports","module","core/table/table.view","jquery"],function(e,t,i){var n=e("core/table/table.view"),s=e("jquery"),o={};i.exports={register:function(e){_.each(e,function(e){o[e.id]=e.View},this)},load:function(t){var i=this,n=new s.Deferred;return e(t,function(){i.register(_.values(arguments)),n.resolve()}),n},getInstance:function(e){var t,i=e.collection.table.get("list_view");return new(t=null!==i&&o.hasOwnProperty(i)?o[i]:n)(e)}}}),define("core/widgets/PaginatorWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile('{{#unless hidePages}}<div class="btn-group">   <a class="btn btn-round {{#unless pagePrev}}disabled{{/unless}} pag-prev"><span class="icon icon-triangle-left"></span></a>   <a class="btn btn-round {{#unless pageNext}}disabled{{/unless}} pag-next"><span class="icon icon-triangle-right"></span></a> </div>{{/unless}}'),events:{"click a.pag-next:not(.disabled)":function(){var e=this.collection.getFilter("currentPage")+1;this.collection.filters.currentPage=e,this.collection.fetch()},"click a.pag-prev:not(.disabled)":function(){var e=this.collection.getFilter("currentPage")-1;this.collection.filters.currentPage=e,this.collection.fetch()}},serialize:function(){return this.options.widgetOptions},updatePaginator:function(){this.options.totalCount=this.collection.getTotalCount(),this.options.widgetOptions.pageNext=this.collection.getFilter("currentPage")+1<this.options.totalCount/this.collection.getFilter("perPage"),this.options.widgetOptions.pagePrev=0!==this.collection.getFilter("currentPage"),this.collection.length!=this.collection.getFilter("perPage")&&(this.options.widgetOptions.pageNext=!1),this.options.widgetOptions.hidePages=this.options.widgetOptions.pageNext||this.options.widgetOptions.pagePrev?!1:!0,this.render()},initialize:function(){this.options.widgetOptions={},this.updatePaginator(),this.collection.on("sync",function(){this.updatePaginator(),document.body.scrollTop=document.documentElement.scrollTop=0},this)}})}),define("core/widgets/PaginationCountWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile("{{#if lBound}}{{number lBound}}–{{number uBound}} of {{number totalCount}}{{else}}No Items Found{{/if}}"),tagName:"div",attributes:{"class":"tool vertical-center pagination-number"},serialize:function(){return this.options.widgetOptions},updateCount:function(){var e={};e.totalCount=this.collection.getTotalCount(),e.lBound=Math.min(this.collection.getFilter("currentPage")*this.collection.getFilter("perPage")+1,e.totalCount),e.uBound=Math.min(e.totalCount,e.lBound+this.collection.getFilter("perPage")-1),this.collection.length<e.uBound-e.lBound+1&&(e.totalCount=this.collection.length<this.collection.getFilter("perPage")?this.collection.length:"Many",e.lBound=Math.min(this.collection.getFilter("currentPage")*this.collection.getFilter("perPage")+1,e.totalCount),e.uBound=Math.min(e.totalCount,e.lBound+this.collection.getFilter("perPage")-1)),this.collection.length>=this.collection.getFilter("perPage")&&this.collection.filters.adv_search&&this.collection.filters.adv_search.length>0&&(e.totalCount="Many"),this.options.widgetOptions=e,this.render()},initialize:function(){this.options.widgetOptions={},this.updateCount(),this.collection.on("sync",this.updateCount,this)}})}),define("core/widgets/ButtonWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile('       <button type="button" id="{{buttonId}}" class="tool-item large-circle {{buttonClass}}">         <span class="icon {{iconClass}}"></span>       </button>'),tagName:"li",attributes:{"class":"tool input-and-button"},serialize:function(){return this.options.widgetOptions},afterRender:function(){this.options.widgetOptions&&this.options.widgetOptions.active&&$(this.el).addClass("active")}})}),define("core/widgets/SearchWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile('       <button type="button" class="tool-item large-circle">         <span class="icon icon-search"></span>       </button>       <input class="font-primary" type="text" value="keyword">'),tagName:"li",attributes:{"class":"tool input-and-button"},serialize:function(){return this.options.widgetOptions},afterRender:function(){this.options.widgetOptions&&this.options.widgetOptions.active&&$(this.el).addClass("active")}})}),define("core/widgets/SaveWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:"core/widgets/save-widget",tagName:"li",attributes:{"class":"input-and-button"},serialize:function(){return this.options.widgetOptions},setSaved:function(e){this.options.widgetOptions.isUpToDate=e,this.render()},initialize:function(e){e.widgetOptions||(this.options.widgetOptions={isUpToDate:!0})}})}),define("core/PreferenceModel",["require","exports","module","backbone"],function(e,t,i){{var n=e("backbone");i.exports=n.Model.extend({fetch:function(e){this.trigger("fetch",this);var t={data:$.param(e)};this.constructor.__super__.fetch.call(this,t)}})}}),define("core/widgets/VisibilityWidget",["app","backbone","core/PreferenceModel"],function(e,t){return t.Layout.extend({template:Handlebars.compile('    <div class="left snapshotOption" id="saveSnapshotBtn"><span class="icon icon-camera"></span></div>     {{#if hasActiveColumn}}     <div class="simple-select dark-grey-color simple-gray left">       <span class="icon icon-triangle-down"></span>       <select id="visibilitySelect" name="status" class="change-visibility">         <optgroup label="Status">           <option data-status value="{{allKeys}}">View All</option>           {{#mapping}}             <option data-status value="{{id}}">View {{capitalize name}}</option>           {{/mapping}}         </optgroup>       </select>       <select id="template" style="display:none;width:auto;"><option id="templateOption"></option></select>     </div>     {{/if}}'),tagName:"div",attributes:{"class":"tool"},events:{"change #visibilitySelect":function(t){var i=$(t.target).find(":selected");if(void 0!==i.attr("data-status")&&i.attr("data-status")!==!1){var n=$(t.target).val(),s={currentPage:0};s[e.statusMapping.status_name]=n,this.collection.setFilter(s),this.listenToOnce(this.collection.preferences,"sync",function(){this.basePage&&this.basePage.removeHolding(this.cid),this.defaultId&&this.collection.preferences.set({title:null,id:this.defaultId})})}},"click #saveSnapshotBtn":"saveSnapshot"},saveSnapshot:function(){var t=this;e.router.openModal({type:"prompt",text:"Please enter a name for your Snapshot",callback:function(e){return null===e||""===e?void alert("Please Fill In a Valid Name"):(t.defaultId=t.collection.preferences.get("id"),t.collection.preferences.unset("id"),t.collection.preferences.set({title:e}),t.collection.preferences.save(),t.pinSnapshot(e),void t.listenToOnce(t.collection.preferences,"sync",function(){this.basePage&&t.basePage.removeHolding(this.cid),this.defaultId&&t.collection.preferences.set({title:null,id:t.defaultId})}))}})},pinSnapshot:function(i){var n={title:i,url:t.history.fragment+"/pref/"+i,icon_class:"icon-search",user:e.users.getCurrentUser().get("id"),section:"search"};e.getBookmarks().isBookmarked(n.title)||e.getBookmarks().addNewBookmark(n)},serialize:function(){var t={hasActiveColumn:this.options.hasActiveColumn,mapping:[]},i=e.statusMapping.mapping,n=[];for(var s in i)s!=e.statusMapping.deleted_num&&(t.mapping.push({id:s,name:i[s].name,sort:i[s].sort}),n.push(s));return t.mapping.sort(function(e,t){return e.sort<t.sort?-1:e.sort>t.sort?1:0}),t.allKeys=n.join(","),t},afterRender:function(){this.options.hasActiveColumn&&$("#visibilitySelect").val(this.collection.preferences.get(e.statusMapping.status_name))},initialize:function(){this.collection.table.id;this.basePage=this.options.basePage,this.collection.table.columns.get(e.statusMapping.status_name)&&(this.options.hasActiveColumn=!0),e.router.loadedPreference&&(this.defaultId=this.collection.preferences.get("id"),this.collection.preferences.fetch({newTitle:e.router.loadedPreference}),this.basePage&&this.basePage.addHolding(this.cid),this.listenToOnce(this.collection.preferences,"sync",function(){this.basePage&&this.basePage.removeHolding(this.cid),this.defaultId&&this.collection.preferences.set({title:null,id:this.defaultId})}))}})}),define("core/widgets/FilterWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:"core/widgets/filter-widget",tagName:"div",attributes:{"class":"tool"},filterUIMappings:{"default":'<input type="text" value="{{value}}" placeholder="Filter..." name="keywords" maxlength="100" class="filter_ui">',date:'<input type="date" value="{{value}}" class="date filter_ui" name="keywords" id="advKeywords">',checkbox:'<input type="checkbox" {{#if value}}checked{{/if}} class="filter_ui" name="keywords" id="advKeywords">'},events:{"click .removeFilterClass":function(e){var t=$(e.target).parent().index(),i=($(e.target).parent().find(".filterColumnName").attr("data-filter-id"),this.options.filters[t].filterData.value);this.options.filters.splice(t,1),this.updateFilters(),i&&this.collection.fetch(),this.saveFilterString(),this.render()},"change .adv-search-col-id":function(e){var t=$(e.target).val();""!=t&&this.addNewFilter(t)},"change .filter_ui":function(e){this.processFilterChange(e)}},processFilterChange:function(e){var t="like";"SELECT"==$(e.target).prop("tagName")&&(t="=");var i={id:this.mysql_real_escape_string($(e.target).closest("li").find(".filterColumnName").attr("data-filter-id")),type:t,value:this.mysql_real_escape_string($(e.target).val())};
$(e.target).is(":checkbox")&&(i.value=$(e.target).prop("checked")?1:0),this.selfChanged=!0,this.options.filters[$(e.target).closest("li").index()].filterData=i,this.updateFilters(),this.collection.fetch(),this.saveFilterString()},getFilterDataType:function(e){if(e&&this.collection.structure.get(e)){var t,i=this.collection.structure.get(e),n=i.get("type");switch(n){case"DATE":case"DATETIME":case"TIMESTAMP":t=this.filterUIMappings.date;break;case"TINYINT":t=this.filterUIMappings.checkbox;break;default:t=this.filterUIMappings.default}return t}},addNewFilter:function(t){var i=($(".advanced-search-fields-row"),this),n={};if(n.columnName=t,"many_to_one"==this.collection.structure.get(t).get("ui")||"many_to_many"==i.collection.structure.get(t).get("ui")||"one_to_many"==i.collection.structure.get(t).get("ui")){var s=this.collection.structure.get(t);if(s.options.has("filter_type")&&"dropdown"==s.options.get("filter_type")){n.columnModel=s,n.relatedCollection=e.getEntries(s.relationship.get("table_related"));var o={};o[e.statusMapping.status_name]=e.statusMapping.active_num,n.relatedCollection.fetch({includeFilters:!1,data:o}),this.listenTo(n.relatedCollection,"sync",this.render)}else n.filter_ui=this.getFilterDataType(t)}else if("ENUM"==this.collection.structure.get(t).get("type")){var s=this.collection.structure.get(t),a=s.get("column_type").substring(5,s.get("column_type").length-1);a=a.replace(/\'/g,"").split(","),n.dropdownValues=a}else if("multi_select"===i.collection.structure.get(t).get("ui")){var s=i.collection.structure.get(t),r=[];for(var l in JSON.parse(s.options.get("options")))r.push(l);n.dropdownValues=r}else n.filter_ui=this.getFilterDataType(t);n.filter_type=this.collection.structure.get(t).get("type"),n.filterData={id:t,type:"like",value:""},this.options.filters.push(n),this.render()},serialize:function(){var e={};e.filters=this.options.filters,e.tableColumns=this.collection.structure.pluck("id"),this.collection.table.get("filter_column_blacklist")&&(e.tableColumns=_.difference(e.tableColumns,this.collection.table.get("filter_column_blacklist").split(","))),e.tableColumns.sort(function(e,t){return t>e?-1:e>t?1:0});var t=this,i=0;return _.each(this.options.filters,function(n){if(n.relatedCollection){if(e.filters[i].relatedEntries=[],n.columnModel.options.has("filter_column")){n.columnModel.options.get("filter_column")}else{n.columnModel.options.get("visible_column")}var s=Handlebars.compile(n.columnModel.options.get("visible_column_template"));n.relatedCollection.each(function(t){e.filters[i].relatedEntries.push({visible_column:t.get("id"),visible_column_template:s(t.attributes)})}),e.filters[i].relatedEntries=_.sortBy(e.filters[i].relatedEntries,"visible_column_template")}else if(n.dropdownValues)e.filters[i].relatedEntries=[],_.each(n.dropdownValues,function(t){e.filters[i].relatedEntries.push({visible_column:t,visible_column_template:t})});else{var o=Handlebars.compile(t.getFilterDataType(e.filters[i].columnName));n.filterData?("0"==n.filterData.value&&(n.filterData=0),e.filters[i].filter_ui=o({value:n.filterData.value})):e.filters[i].filter_ui=o({})}i++}),e},afterRender:function(){$(".filter-ui").last().find("input").focus();var t=this;_.each(this.options.filters,function(i){var n=t.collection.structure.get(i.columnName),s=n.collection.table.id,o=n.id,a="<div>{{"+n.id+"}}</div>";if(n.relationship&&(s=n.relationship.get("table_related"),o=n.options.get("visible_columns"),a="<div>"+n.options.get("visible_column_template")+"</div>"),(i.relatedCollection||i.dropdownValues)&&i.filterData&&t.$el.find("span[data-filter-id="+i.columnName+"]").parent().find(".filter_ui").val(i.filterData.value),-1===["DATETIME","DATE","TIMESTAMP"].indexOf(i.filter_type)&&o){var r={datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:e.API_URL+"tables/"+s+"/typeahead/?columns="+o+"&q=%QUERY"},l=new Bloodhound(r);l.initialize();var c=t.$(".filter-form[data-filter-id-master="+n.id+"] > .filter-ui > input");c.typeahead({minLength:1,items:5,valueKey:o,template:Handlebars.compile(a)},{name:"related-items",displayKey:"value",source:l.ttAdapter()}),c.on("typeahead:selected",function(e){t.processFilterChange(e)})}})},mysql_real_escape_string:function(e){return e?e.replace(/[\0\x08\x09\x1a\n\r"'\\\%]/g,function(e){switch(e){case"\x00":return"\\0";case"\b":return"\\b";case"	":return"\\t";case"":return"\\z";case"\n":return"\\n";case"\r":return"\\r";case'"':case"'":case"\\":case"%":return"\\"+e}}):""},updateFilters:function(t){var i=this.options.filters.map(function(e){return e.filterData});this.collection.setFilter("adv_search",i),t||this.collection.setFilter("currentPage",0),e.router.loadedPreference&&this.basePage&&this.basePage.removeHolding(this.cid)},saveFilterString:function(){var e=[],t=this.options.filters.map(function(e){return e.filterData});t.forEach(function(t){t&&e.push(t.id.replace(":","\\:")+":"+t.type.replace(":","\\:")+":"+String(t.value).replace(":","\\:").replace(",","\\,"))}),e=encodeURIComponent(e.join()),this.collection.preferences.save({search_string:e})},setFilterRow:function(){var e=$(".advanced-search-fields-row"),t=$(".advanced-search-fields");t.on("click",".remove-adv-row",function(){$(this).parent().remove()}),this.getFilterRow=e},getFilterRow:"adv search fields row object",updateFiltersFromPreference:function(){this.options.filters=[];var t=this.collection.preferences.get("search_string");if(null!==t&&void 0!==t){t=decodeURIComponent(t).replace("\\,","%21").split(",");var i=this;t.forEach(function(t){if(t=t.replace("\\:","%20"),t=t.split(":"),3==t.length){var n={},s=t[0].replace("%20",":");if(n.columnName=s,!i.collection.structure.get(s))return;if("many_to_one"==i.collection.structure.get(s).get("ui")||"many_to_many"==i.collection.structure.get(s).get("ui")||"one_to_many"==i.collection.structure.get(s).get("ui")){var o=i.collection.structure.get(s);if(o.options.has("filter_type")&&"dropdown"==o.options.get("filter_type")){n.columnModel=o,n.relatedCollection=e.getEntries(o.relationship.get("table_related"));var a={};a[e.statusMapping.status_name]=e.statusMapping.active_num,n.relatedCollection.fetch({includeFilters:!1,data:a}),i.listenTo(n.relatedCollection,"sync",i.render)}else n.filter_ui=i.getFilterDataType(s)}else if("ENUM"==i.collection.structure.get(s).get("type")){var o=i.collection.structure.get(s),r=o.get("column_type").substring(5,o.get("column_type").length-1);r=r.replace(/\'/g,"").split(","),n.dropdownValues=r}else if("many_to_many"==i.collection.structure.get(s).get("ui"))n.filter_ui=i.getFilterDataType(s);else if("multi_select"===i.collection.structure.get(s).get("ui")){var o=i.collection.structure.get(s),l=[];for(var c in JSON.parse(o.options.get("options")))l.push(c);n.dropdownValues=l}n.filter_type=i.collection.structure.get(s).get("type"),n.filterData={id:s,type:t[1].replace("%20",":"),value:t[2].replace("%20",":").replace("%21",",")},i.options.filters.push(n)}})}this.updateFilters(!0),this.render()},initialize:function(){this.options.filters=[],this.listenTo(this.collection.preferences,"sync",function(){this.updateFiltersFromPreference()}),this.basePage=this.options.basePage,e.router.loadedPreference?this.basePage&&this.basePage.addHolding(this.cid):this.updateFiltersFromPreference()}})}),define("core/widgets/SelectionActionWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile('       <ul class="tools left big-space">         {{#mapping}}           <li class="tool"><span data-value="{{id}}" style="color: {{color}}" class="action actionBtn">{{name}}</span></li>         {{/mapping}}         {{#if batchEdit}}         <li class="tool div-left"><span id="batchEditBtn" class="action">Batch Edit</span></li>         {{/if}}       </ul>     '),tagName:"li",attributes:{"class":"input-and-button"},events:{"click .actionBtn":function(t){var i=$(t.target).closest("span").attr("data-value");if(0==i){var n=this;e.router.openModal({type:"confirm",text:"Are you sure? This item will be removed from the system.",callback:function(){n.doAction(t)}})}else this.doAction(t)},"click #batchEditBtn":function(){var i=$(".select-row:checked"),n=i.map(function(){return this.value}).toArray().join(),s=t.history.fragment.split("/");s.push(n),e.router.go(s)}},doAction:function(t){var i=$(t.target).closest("span").attr("data-value"),n=this.collection,s=n.getFilter("active"),o=$(".select-row:checked"),a=o.length;if(!isNaN(s)){var r={};r[e.statusMapping.status_name]=parseInt(s);var l=n.where(r).length}var c=function(){if(a--,0===a&&(n.trigger("visibility"),n.trigger("select"),l)){var t={};t[e.statusMapping.status_name]=parseInt(s),n.where(t).length!=l&&n.updateActiveCount(l-n.where({name:parseInt(s)}).length)}};o.each(function(){var t=this.value,s=n.get(t),o={silent:!0,patch:!0,validate:!1,success:c};try{e.changeItemStatus(s,i,o)}catch(a){setTimeout(function(){e.router.openModal({type:"alert",text:a.message})},0)}})},serialize:function(){var t=this.options.widgetOptions,i=this.collection.hasPermission("harddelete")||this.collection.hasPermission("bigharddelete"),n=this.collection.hasPermission("delete")||this.collection.hasPermission("bigdelete"),s=this.collection.table.columns.get(e.statusMapping.status_name);if(s){var o=e.statusMapping.mapping;t.mapping=[];for(var a in o)if(a!=e.statusMapping.deleted_num||i||n){var r=o[a];r.id=a,t.mapping.push(r)}t.mapping.sort(function(e,t){return e.sort<t.sort?-1:e.sort>t.sort?1:0})}return this.options.widgetOptions},beforeRender:function(){this.stopListening(this.collection,"select"),this.listenTo(this.collection,"select",function(){var e=$(".select-row:checked").length>1;this.options.widgetOptions.batchEdit!=e&&(this.options.widgetOptions.batchEdit=e,this.render())},this)},initialize:function(){this.options.widgetOptions||(this.options.widgetOptions={})}})}),define("core/widgets/SelectedCountWidget",["app","backbone"],function(e,t){return t.Layout.extend({template:Handlebars.compile("{{#if count}}{{number count}} Selected{{/if}}"),tagName:"div",attributes:{"class":"tool vertical-center pagination-number"},serialize:function(){return this.options.widgetOptions},updateCount:function(){this.options.widgetOptions.count=$(".select-row:checked").length,this.render()},initialize:function(){this.options.widgetOptions={},this.updateCount(),this.collection.on("select",this.updateCount,this)}})}),define("core/widgets/widgets",["core/widgets/PaginatorWidget","core/widgets/PaginationCountWidget","core/widgets/ButtonWidget","core/widgets/SearchWidget","core/widgets/SaveWidget","core/widgets/VisibilityWidget","core/widgets/FilterWidget","core/widgets/SelectionActionWidget","core/widgets/SelectedCountWidget"],function(e,t,i,n,s,o,a,r,l){return{PaginatorWidget:e,PaginationCountWidget:t,ButtonWidget:i,SearchWidget:n,SaveWidget:s,VisibilityWidget:o,FilterWidget:a,SelectionActionWidget:r,SelectedCountWidget:l}}),define("core/overlays/ListSelect",["app","backbone","core/BasePageView","core/ListViewManager","core/widgets/widgets"],function(e,t,i,n,s){return i.extend({headerOptions:{route:{title:"Table View",isOverlay:!0}},leftToolbar:function(){return[new s.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-check",buttonClass:"add-color-background"}})]},rightToolbar:function(){return[new s.PaginatorWidget({collection:this.collection})]},leftSecondaryToolbar:function(){return[new s.VisibilityWidget({collection:this.collection,basePage:this}),new s.FilterWidget({collection:this.collection,basePage:this})]},rightSecondaryToolbar:function(){return[new s.PaginationCountWidget({collection:this.collection})]},events:{"click #removeOverlay":function(){e.router.removeOverlayPage(this)},"click #addBtn":function(){this.save()}},save:function(){console.log("Save")},afterRender:function(){this.setView("#page-content",this.table)},itemClicked:function(e){var t=$(e.target),i=t.closest("tr").find("td.check > input");i.prop("checked")?i.prop("checked",!1):i.prop("checked",!0)},initialize:function(e){void 0===e.selectable&&(e.selectable=!0),this.table=n.getInstance({collection:this.collection,selectable:e.selectable});var t=this;this.table.events={"click tbody td":function(e){t.itemClicked(e)}},this.headerOptions.route.title=this.collection.table.id}})}),define("core/overlays/VisibleColumnSelect",["app","backbone","core/BasePageView","core/ListViewManager","core/widgets/widgets"],function(e,t,i,n,s){return i.extend({headerOptions:{route:{title:"Table View",isOverlay:!0}},leftToolbar:function(){return[new s.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})]},events:{"click #removeOverlay":function(){e.router.removeOverlayPage(this)},"click #addBtn":function(){this.save()}},save:function(){console.log("Save")},afterRender:function(){this.setView("#page-content",this.table),this.table.render()},initialize:function(e){this.table=e.contentView,this.headerOptions.route.title=this.collection.table.id+" Visible Columns"}})}),define("core/overlays/overlays",["core/overlays/ListSelect","core/overlays/VisibleColumnSelect"],function(e,t){return{ListSelect:e,VisibleColumnSelect:t}}),define("core-ui/single_file",["app","backbone","core/table/table.view","core/overlays/overlays"],function(e,t,i,n){var s={};s.id="single_file",s.dataTypes=["INT"],s.variables=[{id:"allowed_filetypes",ui:"textinput",char_length:200}];var o='<style type="text/css">                   div.single-image-thumbnail {                     float: left;                     max-height: 200px;                     background-color: #ffffff;                     color: #ededed;                     text-align: center;                     cursor: pointer;                     height: 160px;                   }                   div.single-image-thumbnail.empty {                     width: 156px;                     height: 156px;                     background-color: #ffffff;                     border: 2px dashed #bbbbbb;                     font-size: 12px;                     font-weight: 600;                     line-height: 14px;                     color: #bbbbbb;                   }                   div.single-image-thumbnail.empty span {                     margin-top: 0;                     display: inline-block;                     line-height: 18px;                   }                   div.single-image-thumbnail.empty span div.icon {                     display: block;                     font-size: 100px;                     line-height: 90px;                   }                   div.single-image-thumbnail.empty.dragover,                   div.single-image-thumbnail.empty:hover {                     background-color: #BBBBBB;                     color: #ffffff;                     cursor: pointer;                   }                   div.single-image-thumbnail img {                     max-width: 160px;                     display: block;                   }                   div.ui-img-details {                     height: 120px;                     width: 220px;                     float: left;                     position: relative;                     line-height: 18px;                     padding:20px;                     background-color: #ececec;                   }                   div.ui-img-details .btn {                     position: absolute;                     bottom: 20px;                     left: 20px;                   }                   div.ui-img-details a.title {                     font-size: 16px;                     height: 20px;                     overflow: hidden;                     display: block;                     text-overflow: ellipsis;                     white-space: nowrap;                   }                   div.ui-img-details div {                     display: inline;                   }                   div.ui-img-details i {                     font-weight: 400;                     font-style: italic;                     color: #ccc;                     margin-top: 5px;                     display: block;                   }                   button.btn-right {                     margin-top: 8px;                     margin-right: 10px;                   }                   .swap-method-btn {                     display:block;                     clear: both;                     padding-top: 5px;                     cursor: pointer;                   }                   .single-image-actions {                     margin: 2px 20px 0 20px;                     float: left;                     width: 160px;                     text-align: center;                     font-size: 12px;                     color: #bbbbbb;                   }                   .single-image-actions .btn {                     margin: 0;                     display: block;                     margin-top: 8px;                     width: 100%;                   }                   .single-image-actions .btn .icon {                     font-size: 300%;                     line-height: 30%;                     margin-right: 3px;                   }                   </style>                   {{#if url}}                   <div class="single-image-thumbnail has-file">                     {{#if fileModel.youtube}}<iframe width="280" height="160" src="http://www.youtube.com/embed/{{fileModel.youtube}}?showinfo=0&controls=0" frameborder="0" allowfullscreen></iframe>                     {{else}}                       {{#if fileModel.vimeo}} <iframe src="//player.vimeo.com/video/{{fileModel.vimeo}}?title=0&amp;byline=0&amp;portrait=0&amp;color=7AC943" width="280" height="160" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>                       {{else}}<a href="{{link}}" class="title" target="single_file"><img src="{{thumbUrl}}"></a>{{/if}}                     {{/if}}                   </div>                   <div class="ui-img-details">                     <a href="{{link}}" class="title" target="single_file" title="{{fileModel.title}}">{{fileModel.title}}</a>                     <!--Uploaded by {{userName fileModel.user}} {{contextualDate fileModel.date_uploaded}}<br> -->                     <i>{{#if isImage}}{{fileModel.width}} &times; {{fileModel.height}} –{{/if}} {{fileModel.size}} - {{fileModel.type}}</i><br>                     <button class="btn btn-primary" data-action="remove-single-file" type="button">Remove File</button>                   </div>                   {{else}}                   <div class="swap-method single-image-thumbnail empty ui-thumbnail-dropzone"><span><div class="icon icon-picture"></div>Drag and drop<br>file here</span></div>                   <input id="urlInput" type="text" class="hide swap-method medium" /><button class="hide swap-method btn btn-small btn-primary margin-left-small" id="retriveUrlBtn" type="button">Retrieve</button>                   <!--<div class="swap-method swap-method-btn secondary-info">Or use a URL – for embedded videos like YouTube</div><div class="hide swap-method swap-method-btn secondary-info">Or Use a File</div>-->                   {{/if}}                   <input style="display:none" id="fileAddInput" type="file" class="large" />                   <div class="single-image-actions">                     <div class="single-image-text">OR UPLOAD FROM</div>                     <button class="btn btn-primary" data-action="computer" type="button"><span class="icon icon-upload"></span> Your Computer</button>                     <button class="btn btn-primary" data-action="url" type="button"><span class="icon icon-link"></span> External URL</button>                     <button class="btn btn-primary" data-action="swap" type="button"><span class="icon icon-attach"></span> Directus Files</button>                   </div>';return s.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(o),events:{'click button[data-action="remove-single-file"]':"removeFile",'click button[data-action="swap"],.ui-thumbnail-dropzone':"swap","click .has-file":"edit","click .swap-method-btn":function(){this.$el.find(".swap-method").toggleClass("hide"),this.$el.find("#urlInput").is(":visible")&&this.$el.find("#urlInput").focus()},"click #retriveUrlBtn":function(){var t=this.$el.find("#urlInput").val(),i=this.fileModel;e.sendLink(t,function(t){_.each(t,function(t){t[e.statusMapping.status_name]=e.statusMapping.active_num,t.id=void 0,t.user=self.userId,i.set(t)})})},"change input[type=file]":function(t){var i=$(t.target)[0].files[0],n=this.fileModel;return this.verifyFile(i)?void e.sendFiles(i,function(e){n.set(e[0]),n.trigger("sync")}):!1},'click button[data-action="computer"]':function(){this.$el.find("#fileAddInput").click()},'click button[data-action="url"]':function(){var t=this;e.router.openModal({type:"prompt",text:"Enter Url",callback:function(i){if(i){var n=t.fileModel;e.sendLink(i,function(i){_.each(i,function(i){return t.verifyFile(i)?(i[e.statusMapping.status_name]=e.statusMapping.active_num,i.id=void 0,i.user=self.userId,void n.set(i)):!1})})}}})}},removeFile:function(){this.fileModel.clear(),this.fileModel.set({id:null})},swap:function(){var t,i=e.files,s=this.fileModel,o=new n.ListSelect({collection:i,selectable:!0});e.router.overlayPage(o),i.fetch();var a=this;o.itemClicked=function(n){var o=$(n.target).closest("tr").attr("data-id");return t=i.get(o),a.verifyFile(t)?(s.clear({silent:!0}),s.set(t.toJSON()),void e.router.removeOverlayPage(this)):!1}},edit:function(){var t=require("modules/tables/views/EditView"),i=this.fileModel,n=new t({model:i});n.headerOptions.route.isOverlay=!0,n.headerOptions.route.breadcrumbs=[],n.headerOptions.basicSave=!0,n.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(n),n.save=function(){i.set(i.diff(n.editView.data())),e.router.removeOverlayPage(this)},i.fetch()},verifyFile:function(t){var i,n=!0;if(this.options.settings.has("allowed_filetypes")){i=this.options.settings.get("allowed_filetypes");var s=t.type||"",n=i.split("|").some(function(e){return s.indexOf(e)>-1})}return n||e.router.openModal({type:"alert",text:"This type of file is not allowed"}),n},afterRender:function(){var t,i=this.$el.find(".single-image-thumbnail"),n=this.fileModel,s=this;i.on("dragover",function(e){clearInterval(t),e.stopPropagation(),e.preventDefault(),i.addClass("dragover")}),i.on("dragleave",function(){clearInterval(t),t=setInterval(function(){i.removeClass("dragover"),clearInterval(t)},50)}),i[0].ondrop=_.bind(function(t){return t.stopPropagation(),t.preventDefault(),t.dataTransfer.files.length>1?void alert("One file only please"):(e.sendFiles(t.dataTransfer.files,function(t){_.each(t,function(t){t[e.statusMapping.status_name]=e.statusMapping.active_num,t.id=void 0,t.user=s.userId,n.set(t)})}),void i.removeClass("dragover"))},this)},serialize:function(){var t=this.fileModel.has("name")?this.fileModel.makeFileUrl(!0):null,i=this.fileModel.has("name")?this.fileModel.makeFileUrl():null,n=this.fileModel.toJSON(),s=this.fileModel.has("type")?this.fileModel.get("type").substring(0,this.fileModel.get("type").indexOf("/")):"",o=this.fileModel.has("type")?this.fileModel.get("type").split("/").pop():"",a=_.contains(["image","embed"],s)||_.contains(["pdf"],o),r=a?t:e.PATH+"assets/img/document.png";return n.type?"embed/youtube"==n.type?(n.youtube=n.url,n.size=e.seconds_convert(n.size)):"embed/vimeo"==n.type?(n.vimeo=n.url,n.size=e.seconds_convert(n.size)):n.size=e.bytesToSize(n.size,0):n.size=e.bytesToSize(n.size,0),n={isImage:a,name:this.options.name,url:t,thumbUrl:r,comment:this.options.schema.get("comment"),allowed_filetypes:this.options.settings&&this.options.settings.has("allowed_filetypes")?this.options.settings.get("allowed_filetypes"):"0",fileModel:n,link:i}},initialize:function(){this.userId=e.users.getCurrentUser().id,this.fileModel=this.options.value,this.fileModel.on("change",this.render,this),this.collection&&this.listenTo(this.collection,"reset",this.render)}}),s.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e.attributes)?"This field is required":void 0},s.list=function(i){var n=i.model;!n.get("type")&&n.get(i.schema.id)instanceof t.Model&&(n=n.get(i.schema.id));var s=parseInt(n.get("width"),10)>parseInt(n.get("height"),10)?"landscape":"portrait",o=n.get("type")?n.get("type").substring(0,n.get("type").indexOf("/")):"",a=n.get("type")?n.get("type").split("/").pop():"",r=_.contains(["image","embed"],o)||_.contains(["pdf"],a),l=r?n.makeFileUrl(!0):e.PATH+"assets/img/document.png",c='<div class="media-thumb"><img src="'+l+'" class="img '+s+'"></div>';return c},s}),define("core-ui/slug",["app","backbone"],function(e,t){var i={};i.id="slug",i.dataTypes=["VARCHAR"],i.variables=[{id:"readonly",ui:"checkbox",def:"1"},{id:"size",ui:"select",options:{options:{large:"Large",medium:"Medium",small:"Small"}}},{id:"mirrored_field",ui:"textinput",char_length:200}];var n='<input type="text" value="{{value}}" name="{{name}}" id="{{name}}" maxLength="{{maxLength}}" class="{{size}}" {{#if readonly}}readonly{{/if}}/><span class="label char-count hide">{{characters}}</span>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"change input":function(){this.$el.find(".label").show()}},afterRender:function(){"on"===this.options.settings.get("readonly")&&this.$("input").prop("readonly",!0);var e=this.options.settings.get("mirrored_field"),t=this.$el.find("input");$("#"+e).keyup(function(){var e=$(this).val();e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var i="ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;",n="aaaaaeeeeeiiiiooooouuuunc------",s=0,o=i.length;o>s;s++)e=e.replace(new RegExp(i.charAt(s),"g"),n.charAt(s));e=e.replace(/[^a-z0-9 \-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),t.val(e)})},serialize:function(){var e=this.options.schema.get("char_length"),t=this.options.value||"";return{size:this.options.settings&&this.options.settings.has("size")?this.options.settings.get("size"):"large",value:t,name:this.options.name,maxLength:e,comment:this.options.schema.get("comment"),readonly:this.options.settings&&this.options.settings.has("readonly")?this.options.settings.get("readonly"):!0}}}),i.validate=function(e,t){if(t.schema.isRequired()&&_.isEmpty(e))return"This field is required";if(t.settings.has("validation_regex")){var i=new RegExp(t.settings.get("validation_regex"));if(!i.test(e))return t.settings.get("validation_message")}},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/textarea",["app","backbone"],function(e,t){var i={},n='<textarea rows="{{rows}}" name="{{name}}" id="{{name}}" {{#if readonly}}readonly{{/if}}>{{value}}</textarea>';return i.id="textarea",i.dataTypes=["TEXT","VARCHAR"],i.variables=[{id:"rows",ui:"numeric",char_length:3}],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),serialize:function(){return{value:this.options.value,name:this.options.name,rows:this.options.settings&&this.options.settings.has("rows")?this.options.settings.get("rows"):"12",comment:this.options.schema.get("comment"),readonly:!this.options.canWrite}}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){var t=_.isString(e.value)?e.value.replace(/<(?:.|\n)*?>/gm,"").substr(0,100):'<span class="silver">--</span>';return t},i}),define("core-ui/directus_user",["app","backbone"],function(e,t){var i={};return i.id="directus_user",i.system=!0,i.sortBy=["first_name","last_name"],i.list=function(e){var t;switch(e.settings.get("format")){case"full":t="{{userFull user}}";break;default:t="{{userShort user}}"}var i=Handlebars.compile(t);return i({user:parseInt(e.value,10)})},i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},initialize:function(t){var i=e.users.get(t.value);if(i){var n=i.getAvatar();this.$el.append('<img src="'+n+'" class="avatar"><span class="avatar-name">'+i.get("first_name")+" "+i.get("last_name")+"</span>")}}}),i}),define("core-ui/directus_activity",["app","backbone"],function(e,t){var i={};return i.id="directus_activity",i.system=!0,i.Input=t.Layout.extend({}),i.list=function(t){var i,n=t.model,s=n.get("action"),o=n.get("table_name"),a=n.get("type"),r=n.get("identifier");switch(null===r&&(r="Entry #"+n.get("row_id")),a){case"FILES":i='<a href="#" data-action="files" data-id="'+n.get("row_id")+'">'+r+"</a> has been "+e.actionMap[s]+" "+e.prepositionMap[s]+' <a href="#files">Files</a>';break;case"SETTINGS":i="The settings have been updated";break;case"UI":i="A UI has been updated";break;default:var l;l="directus_users"===o?"users/"+n.get("row_id"):"#tables/"+o+"/"+n.get("row_id"),i='<a href="'+l+'">'+r+" </a> has been "+e.actionMap[s]+" "+e.prepositionMap[s]+' <a href="#tables/'+o+'">'+e.capitalize(o)+"</a>"}return i},i}),function(e,t){var i=e.Backbone;return"function"==typeof define&&define.amd?define("plugins/backbone.layoutmanager",["backbone","underscore","jquery"],function(){return t.apply(e,arguments)}):void(i.Layout=t.call(e,i,e._,i.$))}("object"==typeof global?global:this,function(e,t,i){var n,s=this,o=e.View.prototype._configure,a=Array.prototype.push,r=Array.prototype.concat,l=Array.prototype.splice,c=e.View.extend({_render:function(e,t){var i=this,n=i.__manager__,s=t.beforeRender,o=t.deferred();return i.hasRendered&&i._removeViews(),n.callback=function(){delete n.isAsync,delete n.callback,i.trigger("beforeRender",i),e(i,t).render().then(function(){o.resolve()})},s&&s.call(i,i),n.isAsync||n.callback(),o.promise()},constructor:function(t){t=t||{},c.setupView(this,t),e.View.call(this,t)},async:function(){var e=this.__manager__;return e.isAsync=!0,e.callback},promise:function(){return this.__manager__.renderDeferred.promise()},renderViews:function(){var e=this,t=e.__manager__,i=e.getAllOptions(),n=i.deferred(),s=e.getViews().map(function(e){return e.render().__manager__.renderDeferred}).value();return t.renderDeferred=n.promise(),i.when(s).then(function(){n.resolveWith(e,[e])}),e},insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return t.isArray(e)?this.setViews({"":e}):(t.each(e,function(i,n){e[n]=t.isArray(i)?i:[i]}),this.setViews(e))},getView:function(e){return null==e&&(e=arguments[1]),this.getViews(e).first().value()},getViews:function(e){var i;return"string"==typeof e?(e=this.sections[e]||e,i=this.views[e]||[],t.chain([].concat(i))):(i=t.chain(this.views).map(function(e){return t.isArray(e)?e:[e]},this).flatten(),"object"==typeof e?i.where(e):"function"==typeof e?i.filter(e):i)},removeView:function(e){return this.getViews(e).each(function(e){e.remove()})},setView:function(e,i,n){var s,o,a,l=this;if("string"!=typeof e&&(n=i,i=e,e=""),s=i.__manager__,!s)throw new Error("The argument associated with selector '"+e+"' is defined and a View.  Set `manage` property to true for Backbone.View instances.");return o=i.getAllOptions(),s.parent=l,a=s.selector=l.sections[e]||e,t.result(i,"setup"),n?(l.views[a]=r.call([],l.views[e]||[],i),l.__manager__.insert=!0,i):(i.hasRendered&&o.partial(l.$el,i.$el,l.__manager__,s),l.removeView(e),l.views[a]=i)},setViews:function(e){return t.each(e,function(e,i){return t.isArray(e)?t.each(e,function(e){this.insertView(i,e)},this):void this.setView(i,e)},this),this},render:function(){function e(){function e(){var e=s.console,i=o.afterRender;i&&i.call(n,n),n.trigger("afterRender",n),r.noel&&n.$el.length>1&&t.isFunction(e.warn)&&!o.suppressWarnings&&(e.warn("`el: false` with multiple top level elements is not supported."),t.isFunction(e.trace)&&e.trace())}var i;return t.each(n.views,function(e,i){t.isArray(e)&&o.htmlBatch(n,e,i)}),l&&!r.insertedViaFragment&&(o.contains(l.el,n.el)||l.getAllOptions().partial(l.$el,n.$el,u,r)),n.delegateEvents(),n.hasRendered=!0,(i=r.queue.shift())?i():delete r.queue,u&&u.queue?l.once("afterRender",e):e(),d.resolveWith(n,[n])
}function i(){var i=n.getAllOptions();n._render(c._viewRender,i).done(function(){if(!t.keys(n.views).length)return e();var s=t.map(n.views,function(e){var n=t.isArray(e);return n&&e.length?i.when(t.map(e,function(e){return e.__manager__.insertedViaFragment=!0,e.render().__manager__.renderDeferred})):n?e:e.render().__manager__.renderDeferred});i.when(s).done(e)})}var n=this,o=n.getAllOptions(),r=n.__manager__,l=r.parent,u=l&&l.__manager__,d=o.deferred();return r.queue?a.call(r.queue,i):(r.queue=[],i(n,d)),n.__manager__.renderDeferred=d,n},remove:function(){return c._removeView(this,!0),this._remove.apply(this,arguments)},getAllOptions:function(){return t.extend({},this,c.prototype.options,this.options)}},{_cache:{},_viewRender:function(e,n){function s(s){t.isString(s)&&(d.noel?(s=i.trim(s),u=i(s),e.$el.slice(1).remove(),e.$el.replaceWith(u),e.setElement(u,!1)):n.html(e.$el,s)),l.resolveWith(e,[e])}function o(t,i){var o;d.callback=function(e){delete d.isAsync,delete d.callback,s(e)},c.cache(a,i),i&&(o=n.renderTemplate.call(e,i,t)),d.isAsync||s(o)}var a,r,l,u,d=e.__manager__;return{render:function(){var i=e.serialize||n.serialize,s=e.template||n.template;return l=n.deferred(),t.isFunction(i)&&(i=i.call(e)),d.callback=function(e){delete d.isAsync,delete d.callback,o(i,e)},"string"==typeof s&&(a=n.prefix+s),(r=c.cache(a))?(o(i,r,a),l):("string"==typeof s?r=n.fetchTemplate.call(e,n.prefix+s):"function"==typeof s?r=s:null!=s&&(r=n.fetchTemplate.call(e,s)),d.isAsync||o(i,r),l)}}},_removeViews:function(e,t){"boolean"==typeof e&&(t=e,e=this),e=e||this,e.getViews().each(function(e){(e.hasRendered||t)&&c._removeView(e,t)})},_removeView:function(e,i){var n,s=e.__manager__,o=s.parent&&s.parent.__manager__,a="boolean"==typeof e.keep?e.keep:e.options.keep;if(!a&&o&&o.insert===!0||i){if(c.cleanViews(e),e._removeViews(!0),e.$el.remove(),!s.parent)return;if(n=s.parent.views[s.selector],t.isArray(n))return t.each(t.clone(n),function(e,t){e&&e.__manager__===s&&l.call(n,t,1)});delete s.parent.views[s.selector]}},cache:function(e,t){return e in this._cache&&null==t?this._cache[e]:null!=e&&null!=t?this._cache[e]=t:void 0},cleanViews:function(i){t.each(r.call([],i),function(i){var n;i.unbind(),i.model instanceof e.Model&&i.model.off(null,null,i),i.collection instanceof e.Collection&&i.collection.off(null,null,i),i.stopListening(),n=i.getAllOptions().cleanup,t.isFunction(n)&&n.call(i)})},configure:function(i){t.extend(c.prototype.options,i),i.manage&&(e.View.prototype.manage=!0),i.el===!1&&(e.View.prototype.el=!1),i.suppressWarnings===!0&&(e.View.prototype.suppressWarnings=!0)},setupView:function(i,s){t.each(r.call([],i),function(i){if(!i.__manager__){var o,a,l,u=c.prototype,d=t.pick(i,n);t.defaults(i,{views:{},sections:{},__manager__:{},_removeViews:c._removeViews,_removeView:c._removeView},c.prototype),s=i.options=t.defaults(s||{},i.options,u.options),l=t.pick(s,r.call(["events","sections"],t.values(s.events))),t.extend(i,l),t.extend(s,d),i._remove=e.View.prototype.remove,i.render=c.prototype.render,i.remove!==u.remove&&(i._remove=i.remove,i.remove=u.remove),o=s.views||i.views,t.keys(o).length&&(a=o,i.views={},i.setViews(a)),i.options.template?i.options.template=s.template:i.template&&(s.template=i.template)}})}});return c.VERSION="0.9.1",e.Layout=c,e.View.prototype._configure=function(e){var t,i;return("el"in e?e.el===!1:this.el===!1)&&(t=!0),i=o.apply(this,arguments),(e.manage||this.manage)&&c.setupView(this),this.__manager__&&(this.__manager__.noel=t,this.__manager__.suppressWarnings=e.suppressWarnings),i},c.prototype.options={prefix:"",deferred:function(){return i.Deferred()},fetchTemplate:function(e){return t.template(i(e).html())},renderTemplate:function(e,t){return e(t)},partial:function(e,t,i,n){var s;n.selector&&(i.noel?(s=e.filter(n.selector),e=s.length?s:e.find(n.selector)):e=e.find(n.selector)),i.insert?this.insert(e,t):this.html(e,t)},html:function(e,t){e.html(t)},htmlBatch:function(e,n,s){var o=e.__manager__,a={selector:s},r=t.reduce(n,function(t,n){var s="boolean"==typeof n.keep?n.keep:n.options.keep,o=s&&i.contains(e.el,n.el);return n.el&&!o&&t.push(n.el),t},[]);return this.partial(e.$el,i(r),o,a)},insert:function(e,t){e.append(t)},when:function(e){return i.when.apply(null,e)},contains:function(e,t){return i.contains(e,t)}},n=t.keys(c.prototype.options),c}),define("core/UIView",["require","exports","module","backbone","plugins/backbone.layoutmanager"],function(e,t,i){var n=e("backbone");e("plugins/backbone.layoutmanager"),i.exports=n.Layout.extend({tagName:"div",name:null,columnSchema:null,model:null,settings:null,constructor:function s(e){this.name=e.name,this.columnSchema=e.model.getStructure().get(this.name),this.settings=this.columnSchema.options,this.isRelational=void 0!==this.columnSchema.relationship,s.__super__.constructor.call(this,e)}})}),define("core-ui/datetime",["app","backbone","moment","core/UIView"],function(e,t,i,n){var s={};s.id="datetime",s.dataTypes=["DATETIME"],s.variables=[{id:"readonly",ui:"checkbox"},{id:"include_seconds",ui:"checkbox"},{id:"contextual_date_in_listview",ui:"checkbox"},{id:"auto-populate_when_hidden_and_null",ui:"checkbox",def:"1"}];var o='<style type="text/css">                   input.date {                     display: inline;                     display: -webkit-inline-flex;                     width: 150px;                     padding-right: 4px;                     margin-right: 5px;                   }                   input.time {                     display: inline;                     display: -webkit-inline-flex;                     width: 110px;                     padding-right: 4px;                     margin-right: 5px;                   }                   input.seconds {                     width: 100px !important;                   }                   </style>                   <input type="date" {{#if readonly}}disabled{{/if}} class="date" {{#if hasDate}}value="{{valueDate}}"{{/if}}>                   <input type="time" {{#if readonly}}disabled{{/if}} class="time{{#if includeSeconds}} seconds{{/if}}" {{#if hasDate}}value="{{valueTime}}"{{/if}}>                   {{#unless readonly}}<a class="now secondary-info">Now</a>{{/unless}}                   <input class="merged" type="hidden" {{#if hasDate}}value="{{valueMerged}}"{{/if}} name="{{name}}" id="{{name}}">',a="YYYY-MM-DD HH:mm";return s.Input=n.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(o),events:{"blur  input.date":"updateValue","blur  input.time":"updateValue","change  input.date":"updateValue","change  input.time":"updateValue","click .now":"makeNow"},makeNow:function(){this.value=i(),this.render()},updateValue:function(){var e=this.$("input[type=time]").val(),t=this.$("input[type=date]").val(),n=t+" "+e;this.$("#"+this.name).val(i(n).isValid()?i(n).format(a):"")},serialize:function(){var e={},t=this.value;return e.hasDate=this.value.isValid(),e.valueDate=t.format("YYYY-MM-DD"),e.valueTime=t.format("HH:mm"),e.valueMerged=t.format(a),e.name=this.name,e.readonly=this.options.settings&&this.options.settings.has("readonly")?0!==this.options.settings.get("readonly"):!1,e},initialize:function(){var e=this.model.get(this.name);this.value=i(void 0===e?"0000-00-00 00:00:00":e)}}),s.validate=function(e,t){if(t.schema.isRequired()&&_.isEmpty(e))return"This field is required";var n=i(e);if(!n.isValid()&&""!==e&&null!==e&&void 0!==e)return"Not a valid date"},s.list=function(e){var t=e.value;if("1"===e.settings.get("contextual_date_in_listview")){var n=i(e.value);t=n.isValid()?n.fromNow():"-"}return t},s}),define("core-ui/date",["app","backbone","moment","core/UIView"],function(e,t,i,n){var s={};s.id="date",s.dataTypes=["DATE"],s.variables=[{id:"readonly",ui:"checkbox"}];var o='<style type="text/css">                   input.date {                     display: inline;                     display: -webkit-inline-flex;                     width: 132px;                     padding-right: 4px;                     margin-right: 5px;                   }                   </style>                   <input type="date" class="date" {{#if readonly}}disabled{{/if}} name="{{name}}" id="{{name}}" {{#if hasDate}}value="{{valueDate}}"{{/if}}>                   <a class="now secondary-info">Now</a>';return s.Input=n.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(o),events:{"click .now":"makeNow"},makeNow:function(){this.value=i(),this.render()},serialize:function(){var e={};return e.hasDate=this.value.isValid(),e.valueDate=this.value.format("YYYY-MM-DD"),e.name=this.options.name,e.note=this.options.schema.get("comment"),e.readonly=!this.options.canWrite,e},initialize:function(){var e=this.model.get(this.name);this.value=i(void 0===e?"0000-00-00":e)}}),s.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},s.list=function(e){return i(e.value).format("DD-MMM-YYYY")},s}),define("core-ui/time",["app","backbone","moment"],function(e,t,i){var n={};n.id="time",n.dataTypes=["TIME"],n.variables=[{id:"readonly",ui:"checkbox"},{id:"include_seconds",ui:"checkbox"}];var s='<style type="text/css">                   input.time {                     display: inline;                     display: -webkit-inline-flex;                     width: 110px;                     padding-right: 4px;                     margin-right: 5px;                   }                   input.seconds {                     width: 100px !important;                   }                   a.now {                                       }                   </style>                   <input type="time" {{#if readonly}}disabled{{/if}} class="time{{#if includeSeconds}} seconds{{/if}}" value="{{value}}" name="{{name}}" id="{{name}}">                   <a class="now">Now</a>';return n.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(s),events:{"click .now":"makeNow"},makeNow:function(){this.value=i().format("HH:mm"),this.render()},serialize:function(){var e={};return e.name=this.options.name,e.comment=this.options.schema.get("comment"),e.value=this.value,e.readonly=!this.options.canWrite,e},initialize:function(){this.value=this.options.value}}),n.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},n.list=function(e){if(!e.value)return"-";var t=e.settings&&e.settings.has("include_seconds")&&"1"==e.settings.get("include_seconds")?!0:!1,i=new Date,n=e.value.split(":");i.setHours(parseInt(n[0],10)+(n[2]?12:0)),i.setMinutes(parseInt(n[1],10)||0),i.setSeconds(parseInt(n[2],10)||0);var s=i.getHours(),o=i.getMinutes(),a=0===i.getSeconds()?"00":i.getSeconds(),r=t?":"+a+" ":"",l=s>=12?"pm":"am";return s=s>12?s-12:s,s="00"==s?12:s,e.value?s+":"+o+r+" "+l:""},n}),define("core-ui/directus_user_activity",["app","backbone","moment"],function(e,t,i){var n={};return n.id="directus_user_activity",n.system=!0,n.sortBy="last_login",n.Input=t.Layout.extend({}),n.list=function(t){if(null!==t.model.get("last_access")){var n="",s=$.parseJSON(t.model.get("last_page"))||{};if(void 0===s.param)n+=e.capitalize(s.route)+" index";else switch(s.route){case"entries":n+=e.capitalize(s.param)+" table index";break;case"entry":var o="edit";"new"==s.path.substr(-3)&&(o="create"),n+=e.capitalize(s.param)+" table entry "+o;break;case"user":n+="User edit form"}var a=t.model.get("last_access");return'<a href="#'+s.path+'" title="'+a+'">'+n+" "+i(a).fromNow()+"</a>"}return'<a href="#">Never logged in</a>'},n}),define("core-ui/directus_user_avatar",["app","backbone"],function(e,t){var i={};return i.id="directus_user_avatar",i.system=!0,i.sortBy=["email"],i.list=function(e){var t="{{userAvatar user}}",i=Handlebars.compile(t);return i({user:parseInt(e.model.id,10)})},i.Input=t.Layout.extend({tagName:"fieldset",initialize:function(t){var i=e.users.get(t.value);if(i){var n=i.getAvatar();this.$el.append('<img src="'+n+'" class="avatar" />')}}}),i}),define("core-ui/directus_file_size",["app","backbone"],function(e,t){var i={};return i.id="directus_file_size",i.system=!0,i.options={},i.list=function(t){return e.bytesToSize(t.value)},i.Input=t.Layout.extend({}),i}),define("core-ui/blob",["app","backbone"],function(e,t){var i={};return i.id="blob",i.dataTypes=["BLOB","MEDIUMBLOB"],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},initialize:function(){var t=document.createElement("img");t.src="data:image/png;base64,"+this.options.value,this.$el.append("<label>"+e.capitalize(this.options.name)+"</label>"),this.$el.append(t)}}),i.list=function(){return"BLOB"},i}),define("core-ui/alias",["app","backbone"],function(e,t){var i={};return i.id="alias",i.dataTypes=["ALIAS","ONETOMANY","MANYTOMANY"],i.Input=t.Layout.extend({}),i}),define("core-ui/salt",["app","backbone"],function(e,t){var i={};i.id="salt",i.dataTypes=["VARCHAR"],i.skipSerializationIfNull=!0,i.variables=[];var n='<input type="text" value="{{value}}" name="{{name}}" id="{{name}}" maxLength="{{maxLength}}" class="medium" readonly/>                  <span class="label char-count hide">{{characters}}</span>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{},initialize:function(e){this.options=e,this.value=this.options.value,_.isEmpty(this.options.value)&&(this.value=this.uniqid(),this.model.set(e.name,this.value))},serialize:function(){var e={value:this.value,name:this.options.name,comment:this.options.schema.get("comment")};return e},uniqid:function(e,t){"undefined"==typeof e&&(e="");var i,n=function(e,t){return e=parseInt(e,10).toString(16),t<e.length?e.slice(e.length-t):t>e.length?[1+(t-e.length)].join("0")+e:e};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,i=e,i+=n(parseInt((new Date).getTime()/1e3,10),8),i+=n(this.php_js.uniqidSeed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}}),i.validate=function(){},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/select",["app","backbone"],function(e,t){var i={},n='<select name="{{name}}" {{#if readonly}}disabled{{/if}}>{{#if allow_null}}<option value="">{{placeholder_text}}</option>{{/if}}{{#options}}<option value="{{key}}" {{#if selected}}selected{{/if}}>{{value}}</option>{{/options}}</select>';return i.id="select",i.dataTypes=["VARCHAR","INT"],i.variables=[{id:"options",ui:"textarea",options:{rows:25}},{id:"allow_null",ui:"checkbox"},{id:"placeholder_text",ui:"textinput",char_length:255,required:!1,comment:"Enter Placeholder Text"}],i.Input=t.Layout.extend({template:Handlebars.compile(n),tagName:"div",attributes:{"class":"field"},serialize:function(){var e=this.options.value,t=this.options.settings.get("options");return _.isString(t)&&(t=$.parseJSON(t)),t=_.map(t,function(t,i){var n={};return n.value=t,n.key=i,n.selected=n.key==e,n}),{options:t,name:this.options.name,comment:this.options.schema.get("comment"),readonly:!this.options.canWrite,allow_null:this.options.settings.get("allow_null"),placeholder_text:this.options.settings.get("placeholder_text")?this.options.settings.get("placeholder_text"):"Select from Below"}}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){var t=_.isString(e.value)?e.value.replace(/<(?:.|\n)*?>/gm,"").substr(0,100):"";return t},i}),define("core-ui/tags",["app","backbone"],function(e,t){var i={};i.id="tags",i.dataTypes=["TEXT","VARCHAR","CHAR"],i.variables=[{id:"force_lowercase",ui:"checkbox",def:"1"}];var n='<input type="hidden" value="{{value}}" name="{{name}}" id="{{name}}">                  <input type="text" class="medium" id="tag-input" style="margin-right:10px;"><button class="btn btn-small btn-primary margin-left" type="button">Add</button>                  <div style="width:84%;">{{#tags}}<span class="tag">{{this}}</span>{{/tags}}</div>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"keydown #tag-input":function(e){(188===e.keyCode||13===e.keyCode)&&(e.preventDefault(),this.insertTag())},"click span":function(e){var t=$(".tag").index($(e.target));this.tags.splice(t,1),this.render()},"click button":"insertTag"},insertTag:function(){var e=this.$el.find("#tag-input"),t=e.val(),i=this.options.settings&&this.options.settings.has("force_lowercase")&&"0"==this.options.settings.get("force_lowercase")?!1:!0;i&&(t=t.toLowerCase());for(var n=t.split(","),s=n.length-1;s>=0;s--){var o=n[s].trim();-1===this.tags.indexOf(o)&&this.tags.push(o)}this.render().$el.find("#tag-input").focus()},serialize:function(){return this.tags=_.filter(this.tags,function(e){return""!==e}),{value:this.tags.join(","),name:this.options.name,tags:this.tags,comment:this.options.schema.get("comment")}},initialize:function(){this.tags=this.options.value?this.options.value.split(","):[]}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){return e.model.attributes.tags},i}),define("core-ui/many_to_one",["app","backbone","core/UIView"],function(e,t,i){var n={};n.id="many_to_one",n.dataTypes=["INT"],n.variables=[{id:"readonly",ui:"checkbox"},{id:"visible_column",ui:"textinput",char_length:64,required:!0,comment:"Enter Visible Column Name"},{id:"visible_column_template",ui:"textinput",char_length:64,required:!0,comment:"Enter Twig Template String"},{id:"visible_status_ids",ui:"textinput",char_length:64,required:!0,def:1,comment:"Enter the visible status ids"},{id:"placeholder_text",ui:"textinput",char_length:255,required:!1,comment:"Enter Placeholder Text"},{id:"filter_type",ui:"select",options:{options:{dropdown:"Dropdown",textinput:"Text Input"}}},{id:"filter_column",ui:"textinput",char_length:255,comment:"Enter Column thats value is used for filter search"}];var s='<select {{#unless canEdit}}disabled{{/unless}}>                   <option value="">{{placeholder_text}}</option>                   {{#data}}<option value="{{id}}" {{#if selected}}selected{{/if}}>{{{name}}}</option>{{/data}}                   </select>';return n.Input=i.extend({tagName:"div",attributes:{"class":"field"},events:{"change select":function(e){var t=this.model.get(this.name),i=parseInt($(e.target).find(":selected").val(),10);t.clear(),t.set({id:i})}},template:Handlebars.compile(s),serialize:function(){var e=function(){};this.options.settings.has("visible_column_template")&&(e=Handlebars.compile(this.options.settings.get("visible_column_template"))),this.options.settings.get("readonly")===!0&&(this.canEdit=!1);var t=this.collection.map(function(t){var i=t.toJSON(),n=e(i);return{id:t.id,name:n,selected:void 0!==this.options.value&&t.id===this.options.value.id}},this);return void 0!==this.options.value&&this.options.value.id&&!t.length&&(t=[{id:this.options.value.id,name:this.options.value,selected:!0}]),t=_.sortBy(t,"name"),{canEdit:this.canEdit,name:this.options.name,data:t,handleBarString:this.options.settings.get("value_template"),comment:this.options.schema.get("comment"),use_radio_buttons:this.options.settings&&this.options.settings.has("use_radio_buttons")&&"1"==this.options.settings.get("use_radio_buttons")?!0:!1,placeholder_text:this.options.settings.get("placeholder_text")?this.options.settings.get("placeholder_text"):"Select from Below"}},initialize:function(){var t;this.columnSchema.relationship?t=this.columnSchema.relationship.get("table_related"):console.error("Column is misconfigured in directus_columns! : "+this.name);var i=this.model.get(this.name);this.canEdit=this.model.canEdit(this.name),this.collection=i.collection.getNewInstance({omit:["preferences"]});var n=1;this.options.settings.get("visible_status_ids")&&(n=this.options.settings.get("visible_status_ids"));var s={"columns_visible[]":[]};s[e.statusMapping.status_name]=n;var o=[];this.options.settings.get("visible_column")&&(o=this.options.settings.get("visible_column").split(",")),o.forEach(function(e){s["columns_visible[]"].push(e)}),this.collection.fetch({includeFilters:!1,data:s}),this.collection.on("sync",this.render,this)}}),n.validate=function(e,i){if(!i.schema.isNullable()||i.schema.get("required")){if(!_.isNaN(parseInt(e,10)))return;if(_.isEmpty(e))return"The field cannot be empty";if(e instanceof t.Model&&(_.isNaN(e.get("id"))||void 0===e.get("id")))return"The field cannot be empty"}},n.list=function(e){if(void 0===e.value)return"";if(void 0!==e.settings.get("visible_column_template")){var i=Handlebars.compile(e.settings.get("visible_column_template"));if(e.value instanceof t.Model)return i(e.value.attributes);if(e.value instanceof Object)return i(e.value)}return e.value instanceof t.Model?e.value.get(e.settings.get("visible_column")):e.value instanceof Object?e.value[e.settings.get("visible_column")]:e.value},n}),define("core-ui/radiobuttons",["app","backbone"],function(e,t){var i={};i.id="radiobuttons",i.dataTypes=["VARCHAR"],i.variables=[{id:"options",ui:"textinput",char_length:100,comment:"Use a Comma Delimited list"}];var n='<style type="text/css">                   label.radiobuttons {                     display:inline-block;                     margin-right: 20px;                     padding: 0 0 4px 0;                     font-weight: 600;                     font-size: 12px;                     cursor: pointer;                   }                   </style>                   <div style="margin-top:4px;">                   {{#options}}                     <label class="radiobuttons" for="radio-{{value}}"><input style="margin-top:-3px;" type="radio" name="{{../name}}" value="{{value}}" id="radio-{{value}}" {{#if selected}}checked{{/if}}>{{value}}</label>                   {{/options}}                   </div>';return i.Input=t.Layout.extend({template:Handlebars.compile(n),tagName:"div",attributes:{"class":"field"},serialize:function(){var e=[];return this.options.settings.get("options")&&(e=_.map(this.options.settings.get("options").split(","),function(e){return{value:e,selected:e===this.options.value}},this)),{name:this.options.name,options:e,comment:this.options.schema.get("comment")}}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){return e.value},i}),define("schema/UIModel",["require","exports","module","backbone"],function(e,t,i){var n=e("backbone");i.exports=n.Model.extend({url:function(){this.parent,this.parent.collection;return this.parent.collection.url+"/"+this.parent.id+"/"+this.id},getStructure:function(){return this.parent.structure},getTable:function(){return this.parent.getTable()},validate:function(){var e=[];return e.length>0?e:void 0}})}),define("schema/RelationshipModel",["require","exports","module","backbone"],function(e,t,i){var n=e("backbone");i.exports=n.Model.extend({})}),define("schema/ColumnModel",["require","exports","module","app","./UIModel","./RelationshipModel"],function(e,t,i){var n=(e("app"),e("./UIModel")),s=e("./RelationshipModel");i.exports=Backbone.Model.extend({parse:function(e){var t=e.ui,i="";if(_.isEmpty(t))throw new Error("Column '"+e.id+"' in table '"+i+"' does not have a UI");var o=e.options||{};return o.id=e.ui,this.options=new n(o),this.options.parent=this,e.relationship&&(this.relationship=new s(e.relationship),this.relationship.parent=this),e.master&&(e.header=!0),e.header="true"===e.header||e.header===!0||1===e.header||"1"===e.header?!0:!1,_.omit(e,"options","relationship")},getOptions:function(){return this.options.get(this.attributes.ui)},getRelated:function(){return this.relationship.get("table_related")},getTable:function(){return this.collection.table},getRelationshipType:function(){return this.hasRelated()?this.relationship.get("type"):void 0},hasRelated:function(){return void 0!==this.relationship},isNullable:function(){return"YES"===this.get("is_nullable")},isRequired:function(){return this.get("required")||!this.isNullable()},toJSON:function(e){return e&&e.columns?_.pick(this.attributes,e.columns):_.clone(this.attributes)}})}),define("schema/ColumnsCollection",["require","exports","module","backbone","./ColumnModel"],function(e,t,i){var n=e("backbone"),s=e("./ColumnModel");i.exports=n.Collection.extend({model:s,comparator:function(e){return e.get("sort")},getRelationalColumns:function(){return this.filter(function(e){return e.hasRelated()})},getColumnsByType:function(e){return e=e.toLowerCase(),this.filter(function(t){return t.get("type").toLowerCase()===e})},save:function(e,t){t=t||{};var i=this,s=t.success;return t.success=function(e){i.reset(e),void 0!==s&&s()},n.sync("update",this,t)},initialize:function(){}})}),define("schema/TableModel",["require","exports","module","backbone","./ColumnsCollection"],function(e,t,i){var n=e("backbone"),s=e("./ColumnsCollection");i.exports=n.Model.extend({parse:function(e){return void 0===this.columns?this.columns=new s(e.columns,{parse:!0,url:this.url+"/columns"}):this.columns.reset(e.columns,{parse:!0}),this.columns.table=this,_.omit(e,"columns")},toJSON:function(){var e=_.clone(this.attributes);return e.columns=this.columns.toJSON(),e}})}),define("core/collection",["app","backbone"],function(e,t){var i=t.Collection.extend({initialize:function(e,t){this.filters=t.filters},getColumns:function(){var e=this.length?_.keys(this.at(0).toJSON()):[],t=this.filters.hasOwnProperty("columns_visible")?_.intersection(e,this.filters.columns_visible):e;return t},getRows:function(){var e=this.getColumns(),t=this.filterMulti({hidden:!1});return _.map(t,function(t){return _.pick(t.toJSON(),e)})},getModels:function(){return this.models},getFilters:function(){return this.filters},getFilter:function(e){return this.filters&&this.filters[e]},setFilter:function(e,t){var i;null===e||"object"==typeof e?i=e:(i={})[e]=t,_.each(i,function(e,t){this.filters[t]=e},this)},sortBy:function(){var e=_.sortBy(this.models,this.comparator,this);return e},comparatorValue:function(e,t){var i=0;return i="string"==typeof e&&"string"==typeof t?e.localeCompare(t):e>t?1:-1,"DESC"===this.getFilter("sort_order")&&(i*=-1),i},comparator:function(t,i){var n,s,o=require("core/UIManager"),a=this.getFilter("sort")||"id";t.collection.nestedCollection&&["sort","id"].indexOf(a)<0?(n=t.get("data").get(a),s=i.get("data").get(a)):(n=t.get(a),s=i.get(a));var r,l,c;return t.has(a)||(this.structure&&void 0!==this.structure.get(a)?(c=this.structure.get(a),l=c.get("ui"),r=o.getSettings(l),r.length>0&&(_.isArray(r.sortBy)?(n=_.map(r.sortBy,function(e){return t.get(e)}).join(""),s=_.map(r.sortBy,function(e){return i.get(e)}).join("")):(n=t.get(r.sortBy),s=i.get(r.sortBy)))):(n=t.id,s=i.id)),e.isStringADate(n)&&!isNaN(Date.parse(n))?this.comparatorValue(new Date(n).getTime(),new Date(s).getTime()):this.comparatorValue(n,s)},setOrder:function(e,t,i){this.filters&&(this.setFilter(void 0===e?{sort:"id",sort_order:"ASC"}:{sort:e,sort_order:t}),this.filters.perPage<=this.table.get("total")?this.fetch():this.sort(i))},getOrder:function(){var e={};return e.sort=this.getFilter("sort"),e.sort_order=this.getFilter("sort_order"),e},filterMulti:function(e){return this.filter(function(t){return _.every(e,function(e,i){return t.has(i)&&t.get(i)===e})})},save:function(e){e=e||{};var i=this,n=e.success;return e.success=function(e){i.reset(e,{parse:!0}),void 0!==n&&n()},e.url=this.url+"?"+$.param(this.getFilters()),t.sync("update",this,e)},fetch:function(e){if(e=e||{},e.data=e.data||{},void 0===e.includeFilters&&(e.includeFilters=!0),e.includeFilters){var i=this.getFilters();i&&i.columns_visible&&-1==i.columns_visible.indexOf(i.sort)&&this.structure.get(i.sort)&&i.columns_visible.push(i.sort),_.extend(e.data,i)}return this.trigger("fetch",this),t.Collection.prototype.fetch.call(this,e)}});return i}),define("schema/fixed/activity",["require","exports","module"],function(e,t,i){i.exports={id:"directus_activity",table_name:"directus_activity",hidden:!0,single:!1,default_status:"1",is_junction_table:!1,count:0,active:0,url:"api/1/activity",title:"Activity",columns:[{id:"activity",column_name:"activity",sort:0,type:"ALIAS",is_nullable:"NO",ui:"directus_activity",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1},{id:"id",column_name:"id",type:"INT",is_nullable:"NO",comment:"",sort:1,system:!0,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"numeric",hidden:!0},{id:"identifier",column_name:"identifier",type:"VARCHAR",char_length:"100",is_nullable:"YES",comment:"",sort:2,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput"},{id:"action",column_name:"action",type:"VARCHAR",char_length:"100",is_nullable:"NO",default_value:"",comment:"",sort:3,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput"},{id:"table_name",column_name:"table_name",type:"VARCHAR",char_length:"100",is_nullable:"NO",default_value:"",comment:"",sort:4,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput"},{id:"row_id",column_name:"row_id",type:"INT",is_nullable:"NO",comment:"",sort:5,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"numeric"},{id:"user",column_name:"user",type:"INT",is_nullable:"NO",default_value:"0",comment:"",sort:6,ui:"directus_user",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,options:{format:"short"}},{id:"data",column_name:"data",type:"TEXT",char_length:"65535",is_nullable:"YES",comment:"",sort:7,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textarea"},{id:"parent_id",column_name:"parent_id",type:"INT",is_nullable:"YES",comment:"",sort:8,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"numeric"},{id:"datetime",column_name:"datetime",type:"DATETIME",is_nullable:"YES",comment:"",sort:9,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"datetime",options:{id:"datetime",contextual_date_in_listview:"1"}}]}}),define("schema/fixed/groups",["require","exports","module"],function(e,t,i){i.exports={id:"directus_groups",table_name:"directus_groups",hidden:!0,single:!1,default_status:"1",url:"api/1/groups",columns:[{id:"id",column_name:"id",ui:"numeric",type:"INT",system:!0,hidden_list:!0,hidden_input:!0},{id:"name",column_name:"name",ui:"numeric",type:"VARCHAR",system:!0,hidden_list:!0,hidden_input:!0},{id:"description",column_name:"description",ui:"textinput",type:"VARCHAR",system:!1,hidden_list:!0,hidden_input:!0}]}}),define("schema/fixed/files",["require","exports","module","app"],function(e,t,i){var n=e("app");i.exports={getFiles:function(){var e=n.statusMapping.status_name;return{id:"directus_files",table_name:"directus_files",hidden:!0,single:!1,default_status:"1",is_junction_table:!1,count:0,url:"api/1/files",title:"Files",columns:[{id:"item",column_name:"item",type:"ALIAS",is_nullable:"NO",comment:"",sort:-1,ui:"directus_file",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1},{id:"url",column_name:"url",type:"VARCHAR",is_nullable:"YES",sort:-1,ui:"directus_file",system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1},{id:"id",column_name:"id",type:"INT",is_nullable:"NO",comment:"",sort:1,system:!0,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"numeric",hidden:!0},{id:e,column_name:e,type:"TINYINT",is_nullable:"YES",default_value:"1",comment:"",sort:2,system:!0,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"checkbox",hidden:!0},{id:"name",column_name:"name",type:"VARCHAR",char_length:"255",is_nullable:"YES",comment:"",sort:3,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"directus_file"},{id:"title",column_name:"title",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:4,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"directus_file_title"},{id:"location",column_name:"location",type:"VARCHAR",char_length:"200",is_nullable:"YES",comment:"",sort:5,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput"},{id:"type",column_name:"type",type:"VARCHAR",char_length:"50",is_nullable:"YES",default_value:"",comment:"",sort:6,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"charset",column_name:"charset",type:"VARCHAR",char_length:"50",is_nullable:"YES",default_value:"",comment:"",sort:7,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"caption",column_name:"caption",type:"TEXT",char_length:"65535",is_nullable:"YES",comment:"",sort:8,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textarea",options:{id:"textarea",rows:"4"}},{id:"tags",column_name:"tags",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:9,ui:"tags",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1},{id:"width",column_name:"width",type:"INT",is_nullable:"YES",default_value:"0",comment:"",sort:10,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"numeric"},{id:"height",column_name:"height",type:"INT",is_nullable:"YES",default_value:"0",comment:"",sort:11,ui:"numeric",system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1},{id:"size",column_name:"size",type:"INT",is_nullable:"YES",default_value:"0",comment:"",sort:12,ui:"directus_file_size",system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1},{id:"embed_id",column_name:"embed_id",type:"VARCHAR",char_length:"200",is_nullable:"YES",comment:"",sort:13,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"user",column_name:"user",type:"INT",is_nullable:"YES",comment:"",sort:14,ui:"directus_user",system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,options:{id:"directus_user",format:"short"}},{id:"storage_adapter",column_name:"storage_adapter",type:"INT",is_nullable:"YES",comment:"",sort:14,ui:"numeric",system:!0,master:!1,hidden_list:!0,hidden_input:!0,required:!1},{id:"date_uploaded",column_name:"date_uploaded",type:"DATETIME",is_nullable:"YES",comment:"",sort:15,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"datetime",options:{id:"datetime",contextual_date_in_listview:"1"}}]}
}}}),define("schema/fixed/messages",["require","exports","module"],function(e,t,i){i.exports={id:"directus_messages",table_name:"directus_messages",hidden:!0,single:!1,default_status:"1",url:"api/1/groups",columns:[{id:"id",column_name:"id",ui:"numeric",type:"INT",system:!0,hidden_list:!0,hidden_input:!0},{id:"from",column_name:"from",ui:"directus_user",type:"INT",system:!1,hidden_list:!1,hidden_input:!1,options:{id:"directus_user",format:"short"}},{id:"recipients",column_name:"recipients",ui:"directus_messages_recipients",is_nullable:"NO",type:"VARCHAR",system:!1,char_length:1e3,hidden_list:!1,hidden_input:!1},{id:"subject",column_name:"subject",ui:"textinput",type:"VARCHAR",required:!0,system:!1,char_length:200,hidden_list:!1,hidden_input:!1},{id:"message",column_name:"message",ui:"textarea",type:"VARCHAR",system:!1,hidden_list:!1,hidden_input:!1,options:{id:"textarea",rows:15}},{id:"datetime",column_name:"datetime",type:"DATETIME",is_nullable:"YES",ui:"datetime",system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,is_writable:!0,options:[]},{id:"date_updated",column_name:"date_updated",type:"DATETIME",is_nullable:"YES",ui:"datetime",system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,is_writable:!0,options:[]},{id:"responses",column_name:"responses",type:"ONETOMANY",is_nullable:"NO",comment:"",sort:38,ui:"one_to_many",system:!1,master:!1,hidden_list:!0,hidden_input:!0,table_related:"directus_messages",junction_key_right:"response_to",required:!1,is_writable:!0,options:{id:"one_to_many",visible_columns:"subject"},relationship:{type:"ONETOMANY",table_related:"directus_messages",junction_key_right:"response_to"}},{id:"response_to",column_name:"response_to",ui:"numeric",type:"INT",system:!0,hidden_list:!0,hidden_input:!0}]}}),define("schema/fixed/users",["require","exports","module","app"],function(e,t,i){var n=e("app");i.exports={getUsers:function(){var e=n.statusMapping.status_name;return{id:"directus_users",table_name:"directus_users",title:"Users",hidden:!0,single:!1,default_status:"1",is_junction_table:!1,count:0,statusName:0,url:"api/1/tables/directus_users/",columns:[{id:"avatar",column_name:"avatar",type:"VARCHAR",is_nullable:"YES",comment:"",sort:16,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"directus_user_avatar"},{id:"name",column_name:"first_name",type:"ALIAS",sort:0,is_nullable:"NO",ui:"directus_user",system:!1,master:!1,hidden_list:!0,hidden_input:!0,required:!1,options:{format:"full"}},{id:"id",column_name:"id",type:"TINYINT",is_nullable:"NO",comment:"",sort:1,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"checkbox",hidden:!0},{id:e,column_name:e,type:"TINYINT",is_nullable:"NO",default_value:"1",comment:"",sort:2,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"checkbox",hidden:!0},{id:"first_name",column_name:"first_name",type:"VARCHAR",char_length:"50",is_nullable:"NO",comment:"",sort:3,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput",options:{size:"medium"}},{id:"last_name",column_name:"last_name",type:"VARCHAR",char_length:"50",is_nullable:"NO",default_value:"",comment:"",sort:4,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"textinput",options:{size:"medium"}},{id:"email",column_name:"email",type:"VARCHAR",char_length:"255",is_nullable:"NO",default_value:"",comment:"",sort:5,ui:"textinput",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,options:{size:"medium"}},{id:"phone",column_name:"phone",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:10,ui:"textinput",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,options:{size:"medium"}},{id:"location",column_name:"location",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:11,ui:"textinput",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,options:{size:"medium"}},{id:"position",column_name:"position",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:9,ui:"textinput",system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,options:{size:"medium"}},{id:"last_access",column_name:"last_access",type:"DATETIME",is_nullable:"YES",default_value:"0000-00-00 00:00:00",comment:"",sort:16,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"datetime"},{id:"email_messages",column_name:"email_messages",type:"TINYINT",is_nullable:"NO",default_value:"1",comment:"CMS messages will also be sent to email address above",sort:6,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!1,ui:"checkbox"},{id:"password",column_name:"password",type:"VARCHAR",char_length:"255",is_nullable:"NO",default_value:"",comment:"Passwords are encrypted, if forgotten they must be reset",sort:7,system:!0,master:!1,hidden_list:!0,hidden_input:!1,required:!0,ui:"password",options:{salt_field:"salt"}},{id:"salt",column_name:"salt",type:"VARCHAR",char_length:"255",is_nullable:"NO",default_value:"",comment:"",sort:8,system:!0,master:!1,hidden_list:!0,hidden_input:!0,required:!0,ui:"salt"},{id:"token",column_name:"token",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:8,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"reset_token",column_name:"reset_token",type:"VARCHAR",char_length:"255",is_nullable:"YES",default_value:"",comment:"",sort:9,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"reset_expiration",column_name:"reset_expiration",type:"DATETIME",is_nullable:"YES",comment:"",sort:10,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"datetime"},{id:"last_login",column_name:"last_login",type:"DATETIME",is_nullable:"YES",default_value:"0000-00-00 00:00:00",comment:"",sort:12,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"datetime"},{id:"last_page",column_name:"last_page",type:"VARCHAR",char_length:"255",is_nullable:"NO",default_value:"",comment:"",sort:13,system:!1,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"ip",column_name:"ip",type:"VARCHAR",char_length:"50",is_nullable:"YES",default_value:"",comment:"",sort:14,system:!0,master:!1,hidden_list:!1,hidden_input:!0,required:!1,ui:"textinput"},{id:"group",column_name:"group",type:"INT",is_nullable:"NO",comment:"Determines this user's access",sort:8,system:!1,master:!1,hidden_list:!1,hidden_input:!1,required:!0,ui:"many_to_one",options:{id:"many_to_one",table_related:"directus_groups",visible_column:"name",visible_column_template:"{{name}}"},relationship:{type:"MANYTOONE",table_related:"directus_groups"}}]}}}}),define("schema/fixed/settings.global",["require","exports","module"],function(e,t,i){var n=i.exports;return n.structure=[{id:"site_name",ui:"textinput",char_length:50,options:{placeholder_text:"My Project"},comment:"The name of your project appears in the browser title"},{id:"site_url",ui:"textinput",char_length:255,options:{placeholder_text:"http://"},comment:"Clicking the main logo takes you to this URL"},{id:"cms_user_auto_sign_out",ui:"numeric",char_length:4,options:{size:"small"},comment:"Number of minutes before a user is automatically logged out of Directus"},{id:"rows_per_page",ui:"numeric",char_length:4,options:{size:"small"},comment:"The number of items per listing page"},{id:"cms_thumbnail_url",ui:"textinput",char_length:255,options:{placeholder_text:"http://"},comment:"Add a image URL for the main logo (170x100)"}],n}),define("schema/fixed/settings.files",["require","exports","module"],function(e,t,i){var n=i.exports;return n.structure=[{id:"file_file_naming",ui:"select",char_length:255,options:{allow_null:!1,options:'{         "file_name":"File Name",         "file_id":"Files ID"       }'},comment:"The file-system naming convention for uploads"},{id:"file_title_naming",ui:"select",char_length:255,options:{allow_null:!1,options:'{         "file_name":"File Name",         "file_id":"Files ID"       }'},comment:"The displayed title naming convention for uploads"},{id:"thumbnail_quality",ui:"numeric",char_length:255,options:{options:"small"},comment:"The quality percentage for Directus thumbnails"},{id:"thumbnail_crop_enabled",ui:"checkbox",comment:"Uncheck if your project requires seeing uncropped Directus Thumbnails"}],n}),define("schema/SchemaManager",["require","exports","module","./ColumnModel","./ColumnsCollection","./TableModel","./UIModel","core/collection","core/PreferenceModel","./fixed/activity","./fixed/groups","./fixed/files","./fixed/messages","./fixed/users","./fixed/settings.global","./fixed/settings.files"],function(e,t,i){var n=(e("./ColumnModel"),e("./ColumnsCollection")),s=e("./TableModel"),o=(e("./UIModel"),e("core/collection")),a=e("core/PreferenceModel"),r={directus_activity:e("./fixed/activity"),directus_groups:e("./fixed/groups"),directus_files:e("./fixed/files"),directus_messages:e("./fixed/messages"),directus_users:e("./fixed/users")},l={global:e("./fixed/settings.global"),files:e("./fixed/settings.files")},c=o.extend({model:s,countVisible:function(){var e=this.filter(function(e){return!e.get("hidden")});return e.length}}),u={tables:new c([],{filters:{columns:["table_name","comment","active","date_modified","single"],conditions:{hidden:!1,is_junction_table:!1}}})},d={tables:{},settings:{},ui:{}},h={},p={};i.exports={setup:function(e){this.apiURL=e.apiURL;var t=[{schema:r.directus_activity},{schema:r.directus_groups},{schema:r.directus_files.getFiles()},{schema:r.directus_messages},{schema:r.directus_users.getUsers()}];this.register("tables",t),this.registerSettingsSchemas([{id:"global",schema:l.global},{id:"files",schema:l.files}])},register:function(e,t){_.each(t,function(t){var i=t.schema.id;if(u[e].get(i))return void console.warn("Warning: "+i+" allready exists in the schema manager, the schema will be ignored");t.schema.url=this.apiURL+"tables/"+i;var n=new s(t.schema,{parse:!0,url:this.apiURL+"tables/"+i});d[e][i]=n.columns,u[e].add(n)},this)},registerUISchemas:function(e){var t="ui";_.each(e,function(e){d[t][e.id]=new n(e.variables,{parse:!0})},this)},registerSettingsSchemas:function(e){var t="settings";_.each(e,function(e){d[t][e.id]=new n(e.schema.structure,{parse:!0})},this)},registerPreferences:function(e){_.each(e,function(e){var t="";null!==e.title&&(t=":"+e.title),h[e.table_name+t]=new a(e,{url:this.apiURL+"tables/"+e.table_name+"/preferences"})},this)},registerPrivileges:function(e){_.each(e,function(e){p[e.table_name]=new Backbone.Model(e,{parse:!0})},this)},getColumns:function(e,t){return d[e][t]},getTable:function(e){return u.tables.get(e)},getTables:function(){return u.tables},getPrivileges:function(e){return p[e]},countTables:function(){return u.tables.countVisible()},getFullSchema:function(e){if(!u.tables.get(e))throw"Table `"+e+"` does not exist";return{table:u.tables.get(e),structure:d.tables[e],preferences:h[e],privileges:p[e]}},getEntriesInstance:function(){}}}),define("core-ui/one_to_many",["app","backbone","core/table/table.view","schema/SchemaManager","core/UIView"],function(e,t,i,n,s){var o={};o.id="one_to_many",o.dataTypes=["ONETOMANY"],o.variables=[{id:"visible_columns",ui:"textinput",char_length:255,required:!0},{id:"result_limit",ui:"numeric",char_length:10,def:"100",comment:"Maximum number of results to fetch"},{id:"add_button",ui:"checkbox"},{id:"remove_button",ui:"checkbox"}];var a='<div class="related-table"></div>                   <div class="btn-row">{{#if showAddButton}}<button class="btn btn-primary" data-action="add" type="button">Add New {{{capitalize tableTitle}}} Item</button>{{/if}}';return o.Input=s.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(a),events:{"click div.related-table > div td:not(.delete)":"editRow","click button[data-action=add]":"addRow","click td.delete":"deleteRow"},editRow:function(e){if(this.canEdit){var t=$(e.target).closest("tr").attr("data-cid"),i=this.relatedCollection.get(t,!0);this.editModel(i)}},deleteRow:function(e){var t=$(e.target).closest("tr").attr("data-cid"),i=this.relatedCollection.get(t),n=this.columnSchema.relationship.get("junction_key_right");return i.isNew()?this.relatedCollection.remove(i):void i.set(n,"")},addRow:function(){var e=this.relatedCollection;this.addModel(new e.model({},{collection:e,parse:!0,structure:e.structure,table:e.table,privileges:e.privileges}))},editModel:function(t){var i=require("modules/tables/views/EditView"),n=this.columnSchema.relationship.get("junction_key_right"),s=new i({model:t,hiddenFields:[n]});s.headerOptions.route.isOverlay=!0,s.headerOptions.route.breadcrumbs=[],s.headerOptions.basicSave=!0,s.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(s),s.save=function(){t.set(t.diff(s.editView.data())),e.router.removeOverlayPage(this)},t.fetch()},addModel:function(t){var i=require("modules/tables/views/EditView"),n=this.relatedCollection,s=this.columnSchema.relationship.get("junction_key_right"),o=this.model.id,a=new i({model:t,collectionAdd:!0,hiddenFields:[s],parentField:{name:s,value:o}});a.headerOptions.route.isOverlay=!0,a.headerOptions.route.breadcrumbs=[],a.headerOptions.basicSave=!0,a.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(a),a.save=function(){var i=a.editView.data();i[s]=o,t.set(i),t.isValid()&&(e.router.removeOverlayPage(this),n.add(t,{nest:!0}))}},serialize:function(){return{title:this.name,tableTitle:this.relatedCollection.table.get("table_name"),canEdit:this.canEdit,showChooseButton:this.showChooseButton,showAddButton:this.showAddButton&&this.canEdit}},afterRender:function(){this.setView(".related-table",this.nestedTableView).render()},validateRelationship:function(){},initialize:function(t){if(!this.columnSchema.relationship||"ONETOMANY"!==this.columnSchema.relationship.get("type"))throw"The column "+this.columnSchema.id+" need to have a relationship of the type ONETOMANY inorder to use the one_to_many ui";this.canEdit=!t.inModal;var n=this.model.get(this.name),s=this.columnSchema.relationship.get("junction_key_right"),o=[];if(o=n.pluck("id"),o.length>0){var a=n.filters;a.columns_visible?a.columns_visible.push(s):a.columns_visible=[s],a.related_table_filter={column:s,val:this.model.id},void 0!==this.columnSchema.options.get("result_limit")&&(a.perPage=this.columnSchema.options.get("result_limit")),n.fetch({includeFilters:!1,data:a})}this.showRemoveButton="1"===this.columnSchema.options.get("remove_button"),this.showAddButton="1"===this.columnSchema.options.get("add_button"),this.nestedTableView=new i({collection:n,selectable:!1,sortable:!1,footer:!1,saveAfterDrop:!0,deleteColumn:"YES"===n.structure.get(s).get("is_nullable")&&this.canEdit&&this.showRemoveButton,hideColumnPreferences:!0,hideEmptyMessage:!0,tableHead:!1,filters:{booleanOperator:"&&",expressions:[{column:s,operator:"===",value:this.model.id}]}}),this.columnSchema.has("sort")&&n.setOrder("sort","ASC",{silent:!0}),this.listenTo(n,"change",function(){this.nestedTableView.tableHead=this.relatedCollection.filter(function(t){return t.get(e.statusMapping.status_name)!==e.statusMapping.deleted_num}).length>0?!0:!1,this.nestedTableView.render()},this),this.relatedCollection=n}}),o.list=function(){return"x"},o}),define("core-ui/many_to_many",["app","backbone","core-ui/one_to_many","core/table/table.view","core/overlays/overlays"],function(e,t,i,n,s){var o={};return o.id="many_to_many",o.dataTypes=["MANYTOMANY"],o.variables=[{id:"visible_columns",ui:"textinput",char_length:255,required:!0},{id:"add_button",ui:"checkbox",def:"1"},{id:"choose_button",ui:"checkbox",def:"1"},{id:"remove_button",ui:"checkbox",def:"1"},{id:"filter_type",ui:"select",options:{options:{dropdown:"Dropdown",textinput:"Text Input"}}},{id:"filter_column",ui:"textinput",char_length:255,comment:"Enter Column thats value is used for filter search"},{id:"visible_column_template",ui:"textinput",char_length:255,comment:"Enter Template For filter dropdown display"},{id:"min_entries",ui:"numeric",char_length:11,default_value:0,comment:"Minimum Allowed related Entries"},{id:"no_duplicates",ui:"checkbox",def:"0",comment:"No Duplicates"}],o.Input=i.Input.extend({events:{"click div.related-table > div td:not(.delete)":"editRow","click button[data-action=add]":"addRow","click button[data-action=insert]":"insertRow","click td.delete":"deleteRow"},template:Handlebars.compile('<div class="related-table"></div><div class="btn-row">{{#if showAddButton}}<button class="btn btn-primary margin-right-small" data-action="add" type="button">Add New</button>{{/if}}{{#if showChooseButton}}<button class="btn btn-primary" data-action="insert" type="button">Choose Existing</button>{{/if}}</div>'),addRow:function(){this.addModel(new this.relatedCollection.nestedCollection.model({},{collection:this.relatedCollection.nestedCollection,parse:!0}))},deleteRow:function(t){var i=$(t.target).closest("tr").attr("data-cid"),n=this.relatedCollection.get(i);if(n.isNew())return this.relatedCollection.remove(n);var s={};s[e.statusMapping.status_name]=e.statusMapping.deleted_num,n.set(s)},addModel:function(t){var i=require("modules/tables/views/EditView"),n=this.relatedCollection,s=new i({model:t,inModal:!0});s.headerOptions.route.isOverlay=!0,s.headerOptions.route.breadcrumbs=[],s.headerOptions.basicSave=!0,s.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(s),s.save=function(){t.set(s.editView.data()),n.add(t,{nest:!0}),e.router.removeOverlayPage(this)}},insertRow:function(){var t=(this.relatedCollection.map(function(e){return e.get("data").id}),e.getEntries(this.relatedCollection.table.id)),i=new s.ListSelect({collection:t});e.router.overlayPage(i);var n=this;i.save=function(){_.each(i.table.selection(),function(e){var i=t.get(e).toJSON();if(1==n.columnSchema.options.get("no_duplicates")){var s=!1;if(n.relatedCollection.each(function(t){t.get("data").id==e&&(s=!0)}),s)return!1}n.relatedCollection.add(i,{parse:!0,silent:!0,nest:!0})},this),n.relatedCollection.trigger("add"),e.router.removeOverlayPage(this)},t.fetch()},initialize:function(t){if(!this.columnSchema.relationship||"MANYTOMANY"!==this.columnSchema.relationship.get("type"))throw"The column "+this.columnSchema.id+" need to have a relationship of the type MANYTOMANY inorder to use the one_to_many ui";this.canEdit=!t.inModal,this.showRemoveButton="1"===this.columnSchema.options.get("remove_button"),this.showChooseButton="1"===this.columnSchema.options.get("choose_button"),this.showAddButton="1"===this.columnSchema.options.get("add_button");for(var i=this.model.get(this.name),s=(i.structure,i.junctionStructure),o=[],a=0;a<i.size();a++){var r=i.at(a);r.get("data").get(e.statusMapping.status_name)!==e.statusMapping.deleted_num?o.push(r.get("data").id):(i.remove(r,{silent:!0}),a--)}o.length>0&&(i.nestedCollection.setFilter({ids:o.slice(0,i.nestedCollection.filters.perPage).join(",")}),i.nestedCollection.fetch());var l=[],c=this;i.getColumns().forEach(function(e){-1==c.columnSchema.options.get("visible_columns").split(",").indexOf(e)&&l.push(e)}),this.nestedTableView=new n({collection:i,toolbar:!1,selectable:!1,sortable:!0,footer:!1,tableHead:!1,saveAfterDrop:!1,deleteColumn:this.showRemoveButton,hideEmptyMessage:!0,hideColumnPreferences:!0,sort:void 0!==s.get("sort"),blacklist:l}),void 0!==s.get("sort")&&i.setOrder("sort","ASC"),this.relatedCollection=i,this.listenTo(i,"change add remove",function(){this.nestedTableView.tableHead=this.relatedCollection.filter(function(t){return t.get(e.statusMapping.status_name)!==e.statusMapping.deleted_num}).length>0?!0:!1,this.nestedTableView.render()},this),this.listenTo(i.nestedCollection,"sync",function(){this.nestedTableView.render()},this),o.length>0&&this.listenTo(i.nestedCollection,"sort",function(){})}}),o.validate=function(e,t){var i=parseInt(t.settings.get("min_entries"));return e.length<i?"This field requires at least "+i+" entries.":t.schema.isRequired()&&0==e.length?"This field is required":void 0},o.list=function(){return"x"},o}),define("core-ui/wysiwyg",["app","backbone","core/overlays/overlays"],function(t,i,n){var s={};s.id="wysiwyg",s.dataTypes=["VARCHAR","TEXT"],s.variables=[{id:"readonly",ui:"checkbox"},{id:"height",ui:"numeric",def:"500"},{id:"bold",ui:"checkbox",def:"1"},{id:"italic",ui:"checkbox",def:"1"},{id:"underline",ui:"checkbox",def:"1"},{id:"strikethrough",ui:"checkbox",def:"0"},{id:"rule",ui:"checkbox",def:"0"},{id:"createlink",ui:"checkbox",def:"0"},{id:"insertimage",ui:"checkbox",def:"0"},{id:"embedVideo",ui:"checkbox",def:"0"},{id:"embed_width",ui:"numeric",def:300},{id:"embed_height",ui:"numeric",def:200},{id:"html",ui:"checkbox",def:"0"},{id:"orderedList",ui:"checkbox",def:"0"},{id:"h1",ui:"checkbox",def:"0"},{id:"h2",ui:"checkbox",def:"0"},{id:"h3",ui:"checkbox",def:"0"},{id:"h4",ui:"checkbox",def:"0"},{id:"h5",ui:"checkbox",def:"0"},{id:"h6",ui:"checkbox",def:"0"},{id:"blockquote",ui:"checkbox",def:"0"},{id:"ul",ui:"checkbox",def:"0"},{id:"ol",ui:"checkbox",def:"0"}],Handlebars.registerHelper("newlineToBr",function(e){return new Handlebars.SafeString(e.string.replace(/\n/g,"<br/>"))});var o='<style type="text/css">                   div.ui-thumbnail {                     float: left;                     margin-top: 8px;                     max-height: 200px;                     padding: 10px;                     background-color: #ffffff;                     border: 1px solid #ededed;                     -webkit-border-radius:3px;                     -moz-border-radius:3px;                     border-radius:3px;                     color: #ededed;                     text-align: center;                     cursor: pointer;                   }                   div.ui-thumbnail.empty {                     width: 300px;                     height: 100px;                     background-color: #ffffff;                     border: 2px dashed #ededed;                     padding: 9px;                     font-size: 16px;                     font-weight: 600;                     line-height: 100px;                   }                   div.ui-thumbnail.empty.dragover,                   div.ui-thumbnail.empty:hover {                     background-color: #fefefe;                     border: 2px dashed #cccccc;                     cursor: pointer;                   }                   div.ui-thumbnail img {                     max-height: 200px;                   }                   .wysihtml5-textarea-body iframe {                     width: 100%;                   }                   </style>                   <div id="wysihtml5-toolbar-{{name}}" class="btn-toolbar" style="display: none;">                   <div class="btn-group btn-white btn-group-attached btn-group-action active">                     {{#if bold}}<button data-wysihtml5-command="bold" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Bold"><b>B</b></button>{{/if}}                     {{#if italic}}<button data-wysihtml5-command="italic" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Italic"><i>I</i></button>{{/if}}                     {{#if underline}}<button data-wysihtml5-command="underline" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Underline"><u>U</u></button>{{/if}}                     {{#if strikethrough}}<button data-wysihtml5-command="strikethrough" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Strikethrough"><s>S</s></button>{{/if}}                   </div>                   <div class="btn-group btn-white btn-group-attached btn-group-action active">                     {{#if h1}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" type="button" class="btn btn-small btn-silver" data-tag="H1" rel="tooltip" data-placement="bottom" title="H1">H1</button>{{/if}}                     {{#if h2}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" type="button" class="btn btn-small btn-silver" data-tag="H2" rel="tooltip" data-placement="bottom" title="H2">H2</button>{{/if}}                     {{#if h3}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" type="button" class="btn btn-small btn-silver" data-tag="H3" rel="tooltip" data-placement="bottom" title="H3">H3</button>{{/if}}                     {{#if h4}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" type="button" class="btn btn-small btn-silver" data-tag="H4" rel="tooltip" data-placement="bottom" title="H4">H4</button>{{/if}}                     {{#if h5}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" type="button" class="btn btn-small btn-silver" data-tag="H5" rel="tooltip" data-placement="bottom" title="H5">H5</button>{{/if}}                     {{#if h6}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" type="button" class="btn btn-small btn-silver" data-tag="H6" rel="tooltip" data-placement="bottom" title="H6">H6</button>{{/if}}                     {{#if blockquote}}<button data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" type="button" class="btn btn-small btn-silver" data-tag="Quote" rel="tooltip" data-placement="bottom" title="Quote">Quote</button>{{/if}}                     {{#if orderedList}}<button data-wysihtml5-command="insertOrderedList" type="button" class="btn btn-small btn-silver" data-tag="List" rel="tooltip" data-placement="bottom" title="List">List</button>{{/if}}                   </div>                   <div class="btn-group btn-white btn-group-attached btn-group-action active">                     {{#if ul}}<button data-wysihtml5-command="insertUnorderedList" type="button" class="btn btn-small btn-silver" data-tag="UL" rel="tooltip" data-placement="bottom" title="UL">UL</button>{{/if}}                     {{#if ol}}<button data-wysihtml5-command="insertOrderedList" type="button" class="btn btn-small btn-silver" data-tag="OL" rel="tooltip" data-placement="bottom" title="OL">OL</button>{{/if}}                   </div>                   <div class="btn-group btn-white btn-group-attached btn-group-action active">                     {{#if rule}}                       <button data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="<hr>" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Insert Rule">HR</button>                     {{/if}}                     {{#if createlink}}                     <button data-wysihtml5-command="createLink" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Create Link">Link</button>                     <div data-wysihtml5-dialog="createLink" style="display: none;z-index:108" class="directus-alert-modal">                       <div class="directus-alert-modal-message">Please Insert a Link</div>                       <input type="text" data-wysihtml5-dialog-field="href" value="http://">                       <div class="directus-alert-modal-buttons">                         <button data-wysihtml5-dialog-action="cancel" type="button">Cancel</button>                         <button data-wysihtml5-dialog-action="save" type="button" class="primary">OK</button>                       </div>                     </div>                     {{/if}}                     {{#if insertimage}}                       <button data-wysihtml5-command="insertImage" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Insert Image">Image</button>                       <div data-wysihtml5-dialog="insertImage" style="display: none;z-index:108" class="directus-alert-modal">                         <div><button id="existingFileButton" type="button" class="btn" style="float:none;margin-bottom:10px;background-color: #F4F4F4;font-weight:600;width:100%;border: none;">Choose Existing File</button></div>                         <div style="position:relative;margin-bottom:10px;width:100%;background-color:#F4F4F4;text-align:center;font-weight:600;padding-top:10px;padding-bottom:10px;">Choose From Computer<input id="fileAddInput" type="file" class="large" style="position:absolute;top:0;left:0;cursor:pointer;opacity:0.0;width:100%;height:100%;z-index:9;" /></div>                         <div><input type="text" data-wysihtml5-dialog-field="src" id="insertImageInput" value="http://" style="font-weight:600;"></div>                         <div class="directus-alert-modal-buttons">                           <button data-wysihtml5-dialog-action="cancel" type="button">Cancel</button>                           <button data-wysihtml5-dialog-action="save" id="insertImageButton" type="button" class="primary">OK</button>                         </div>                       </div>                     {{/if}}                     {{#if embedVideo}}                       <button data-wysihtml5-command="embedVideo" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Embed Video">Embed</button>                       <div data-wysihtml5-dialog="embedVideo" style="display: none;z-index:108" class="directus-alert-modal">                         <div><button id="existingLinkButton" type="button" class="btn" style="float:none;margin-bottom:10px;background-color: #F4F4F4;font-weight:600;width:100%;border: none;">Choose Existing Link</button></div>                         <div><input type="text" class="videoEmbedWidth" id="embedWidthInput" value="{{embed_width}}" style="font-weight:600;"></div><br/>                         <div><input type="text" class="videoEmbedHeight" id="embedHeightInput" value="{{embed_height}}" style="font-weight:600;"></div><br/>                         <div><input type="text" class="videoEmbedInput" data-type="youtube" id="insertYoutubeEmbedInput" placeholder="Youtube Video ID" style="font-weight:600;"></div><br/>                         <div><input type="text" class="videoEmbedInput" data-type="vimeo" id="insertVimeoEmbedInput" placeholder="Vimeo Video ID" style="font-weight:600;"></div>                         <div><input type="hidden"  data-wysihtml5-dialog-field="src" id="insertEmbedInput"></div>                         <div><input type="hidden"  data-wysihtml5-dialog-field="data-type" id="insertEmbedInputType"></div>                         <div class="directus-alert-modal-buttons">                           <button data-wysihtml5-dialog-action="cancel" type="button">Cancel</button>                           <button data-wysihtml5-dialog-action="save" id="insertEmbedButton" type="button" class="primary">OK</button>                         </div>                       </div>                     {{/if}}                     {{#if html}}                       <button data-wysihtml5-action="change_view" type="button" class="btn btn-small btn-silver" data-tag="bold" rel="tooltip" data-placement="bottom" title="Toggle HTML">HTML</button>                     {{/if}}                   </div>                 </div>                 <div style="display:none;z-index:998;position:absolute;width:100%;height:100%;top:-5px;left:-5px;" id="iframe_blocker"></div>                 <textarea id="wysihtml5-textarea-{{name}}" class="wysihtml5-style" style="height:{{height}}px" placeholder="Enter your text ..." value="{{markupValue}}"></textarea>                 <input type="hidden" name="{{name}}" class="hidden_input" value="{{{markupValue}}}">';return s.Input=i.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(o),events:{"input textarea":"textChanged","change input[type=file]":function(e){var i=$(e.target)[0].files[0],n=this,s=new t.files.model({},{collection:t.files});
t.sendFiles(i,function(e){_.each(e,function(e){e[t.statusMapping.status_name]=t.statusMapping.active_num,e.id=void 0,e.user=n.userId,s.save(e,{success:function(){var e=s.makeFileUrl(!1),t=s.attributes.title;n.$el.find("#insertImageInput").val(e),n.$el.find("input[type=file]").val(""),n.editor.composer.commands.exec("insertImage",{src:e,alt:t,title:t}),$(".directus-alert-modal").addClass("hide")}})})})},"click #existingFileButton":function(){{var e,i=t.files;new t.files.model({},{collection:i})}i.fetch();var s=new n.ListSelect({collection:i,selectable:!1});t.router.overlayPage(s);var o=this;s.itemClicked=function(n){var s=$(n.target).closest("tr").attr("data-id");e=i.get(s),t.router.removeOverlayPage(this);var a=e.makeFileUrl(!1),r=e.attributes.title;o.editor.composer.commands.exec("insertImage",{src:a,alt:r,title:r}),$(".directus-alert-modal").addClass("hide")}},"click #existingLinkButton":function(){{var e,i=t.files;new t.files.model({},{collection:i})}i.setFilter("adv_search",[{id:"type",type:"like",value:"embed/"}]),i.fetch();var s=new n.ListSelect({collection:i,selectable:!1});t.router.overlayPage(s);var o=this;s.itemClicked=function(n){var s=$(n.target).closest("tr").attr("data-id");if(e=i.get(s),t.router.removeOverlayPage(this),"embed/youtube"==e.get("type")||"embed/vimeo"==e.get("type")){var a=e.get("url");o.$el.find("#insertEmbedInputType").val("embed/vimeo"==e.get("type")?"vimeo":"youtube"),o.$el.find("#insertEmbedInput").val(a),o.$el.find("#insertEmbedButton").click()}}},"change .videoEmbedInput":function(e){var t=$(e.target);t.val()&&(this.$el.find("#insertEmbedInput").val(t.val()),this.$el.find("#insertEmbedInputType").val(t.attr("data-type")))}},textChanged:function(e){if(e.editor)try{e.$(".hidden_input").val(e.editor.getValue())}catch(t){console.log(t.message)}},serialize:function(){var e=this.options.schema.get("char_length"),t=this.options.value||"";return{height:this.options.settings&&this.options.settings.has("height")?this.options.settings.get("height"):"500",bold:this.options.settings&&this.options.settings.has("bold")?"0"!==this.options.settings.get("bold"):!0,italic:this.options.settings&&this.options.settings.has("italic")?"0"!==this.options.settings.get("italic"):!0,underline:this.options.settings&&this.options.settings.has("underline")?"0"!==this.options.settings.get("underline"):!0,strikethrough:this.options.settings&&this.options.settings.has("strikethrough")?"0"!==this.options.settings.get("strikethrough"):!1,rule:this.options.settings&&this.options.settings.has("rule")?"0"!==this.options.settings.get("rule"):!1,h1:this.options.settings&&this.options.settings.has("h1")?"0"!==this.options.settings.get("h1"):!1,h2:this.options.settings&&this.options.settings.has("h2")?"0"!==this.options.settings.get("h2"):!1,h3:this.options.settings&&this.options.settings.has("h3")?"0"!==this.options.settings.get("h3"):!1,h4:this.options.settings&&this.options.settings.has("h4")?"0"!==this.options.settings.get("h4"):!1,h5:this.options.settings&&this.options.settings.has("h5")?"0"!==this.options.settings.get("h5"):!1,h6:this.options.settings&&this.options.settings.has("h6")?"0"!==this.options.settings.get("h6"):!1,blockquote:this.options.settings&&this.options.settings.has("blockquote")?"0"!==this.options.settings.get("blockquote"):!1,ul:this.options.settings&&this.options.settings.has("ul")?"0"!==this.options.settings.get("ul"):!1,ol:this.options.settings&&this.options.settings.has("ol")?"0"!==this.options.settings.get("ol"):!1,orderedList:this.options.settings&&this.options.settings.has("orderedList")?"0"!==this.options.settings.get("orderedList"):!1,createlink:this.options.settings&&this.options.settings.has("createlink")?"0"!==this.options.settings.get("createlink"):!1,insertimage:this.options.settings&&this.options.settings.has("insertimage")?"0"!==this.options.settings.get("insertimage"):!1,embedVideo:this.options.settings&&this.options.settings.has("embedVideo")?"0"!==this.options.settings.get("embedVideo"):!1,embed_width:this.options.settings&&this.options.settings.has("embed_width")?this.options.settings.get("embed_width"):"300",embed_height:this.options.settings&&this.options.settings.has("embed_height")?this.options.settings.get("embed_height"):"200",html:this.options.settings&&this.options.settings.has("html")?"0"!==this.options.settings.get("html"):!1,markupValue:String(t).replace(/"/g,"&quot;"),value:new Handlebars.SafeString(t),name:this.options.name,maxLength:e,characters:e-t.length}},initialize:function(){var e=this;this.userId=t.users.getCurrentUser().id,$.ajax({url:window.location.origin+window.directusData.path+"assets/js/libs/wysihtml5.js",dataType:"script",success:function(){e.initEditor()}})},afterRender:function(){"on"===this.options.settings.get("readonly")&&this.editor.readonly()},initEditor:function(){var i=this;this.editor=new wysihtml5.Editor("wysihtml5-textarea-"+this.options.name,{toolbar:"wysihtml5-toolbar-"+this.options.name,stylesheets:t.PATH+"assets/css/wysiwyg.css",parserRules:e});var n=this.options.value||"";this.editor.setValue(String(n).replace(/"/g,"&quot;")),this.editor.on("change",function(){i.textChanged(i)});var s,o=this.$el,a=this,r=new t.files.model({},{collection:t.files});o.on("dragover",function(e){a.$el.find("#iframe_blocker").show(),clearInterval(s),e.stopPropagation(),e.preventDefault(),o.addClass("dragover")}),o.on("dragleave",function(){clearInterval(s),s=setInterval(function(){a.$el.find("#iframe_blocker").hide(),o.removeClass("dragover"),clearInterval(s)},50)}),o[0].ondrop=_.bind(function(e){return e.stopPropagation(),e.preventDefault(),a.$el.find("#iframe_blocker").hide(),e.dataTransfer.files.length>1?void alert("One file only please"):(this.editor.focus(),t.sendFiles(e.dataTransfer.files,function(e){_.each(e,function(e){e[t.statusMapping.status_name]=t.statusMapping.status_num,e.id=void 0,e.user=a.userId,r.save(e,{success:function(){var e=r.makeFileUrl(!1);try{a.editor.composer.commands.exec("insertImage",{src:e,alt:r.get("title"),title:r.get("title")})}catch(t){}}})})}),void o.removeClass("dragover"))},this),this.$el.find(".wysihtml5-sandbox").contents().find("body").on("dragover",function(){a.$el.find("#iframe_blocker").show()}),wysihtml5.commands.embedVideo={exec:function(e,t,n){var s,o=e.doc,a=i.$el.find("#embedWidthInput").val(),r=i.$el.find("#embedHeightInput").val();s=o.createElement("iframe"),s.setAttribute("width",a),s.setAttribute("height",r),s.setAttribute("frameborder","0"),s.setAttribute("allowfullscreen","1");var l="youtube";n["data-type"]&&(l=n["data-type"]);for(var c in n)"src"===c&&(n[c]="youtube"==l?"http://youtube.com/embed/"+n[c]:"//player.vimeo.com/video/"+n[c]+"?title=0&amp;byline=0&amp;portrait=0&amp;color=c9ff23"),"data-type"!==c&&s.setAttribute("className"===c?"class":c,n[c]);e.selection.insertNode(s),e.selection.setAfter(s),i.textChanged(i)}},wysihtml5.commands.createLink.triggerEvent=function(){i.textChanged(i)}}}),s.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},s.list=function(e){return e.value?e.value.toString().replace(/(<([^>]+)>)/gi,"").substr(0,100):""},s});var e={classes:{"wysiwyg-clear-both":1,"wysiwyg-clear-left":1,"wysiwyg-clear-right":1,"wysiwyg-color-aqua":1,"wysiwyg-color-black":1,"wysiwyg-color-blue":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-gray":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-maroon":1,"wysiwyg-color-navy":1,"wysiwyg-color-olive":1,"wysiwyg-color-purple":1,"wysiwyg-color-red":1,"wysiwyg-color-silver":1,"wysiwyg-color-teal":1,"wysiwyg-color-white":1,"wysiwyg-color-yellow":1,"wysiwyg-float-left":1,"wysiwyg-float-right":1,"wysiwyg-font-size-large":1,"wysiwyg-font-size-larger":1,"wysiwyg-font-size-medium":1,"wysiwyg-font-size-small":1,"wysiwyg-font-size-smaller":1,"wysiwyg-font-size-x-large":1,"wysiwyg-font-size-x-small":1,"wysiwyg-font-size-xx-large":1,"wysiwyg-font-size-xx-small":1,"wysiwyg-text-align-center":1,"wysiwyg-text-align-justify":1,"wysiwyg-text-align-left":1,"wysiwyg-text-align-right":1},tags:{tr:{add_class:{align:"align_text"}},strike:1,form:{rename_tag:"div"},rt:{rename_tag:"span"},code:{},acronym:{rename_tag:"span"},br:{add_class:{clear:"clear_br"}},details:{rename_tag:"div"},h4:{add_class:{align:"align_text"}},em:{},title:{remove:1},multicol:{rename_tag:"div"},figure:{rename_tag:"div"},xmp:{rename_tag:"span"},small:{rename_tag:"span",set_class:"wysiwyg-font-size-smaller"},area:{remove:1},time:{rename_tag:"span"},dir:{rename_tag:"ul"},bdi:{rename_tag:"span"},command:{remove:1},ul:{},progress:{rename_tag:"span"},dfn:{rename_tag:"span"},figcaption:{rename_tag:"div"},a:{check_attributes:{href:"url"},set_attributes:{rel:"nofollow",target:"_blank"}},img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"},add_class:{align:"align_img"}},iframe:{check_attributes:{width:"numbers",src:"url",height:"numbers",frameborder:"numbers"},set_attributes:{frameborder:"0",allowfullscreen:""}},rb:{rename_tag:"span"},footer:{rename_tag:"div"},noframes:{remove:1},abbr:{rename_tag:"span"},u:1,bgsound:{remove:1},sup:{rename_tag:"span"},address:{rename_tag:"div"},basefont:{remove:1},nav:{rename_tag:"div"},h1:{add_class:{align:"align_text"}},head:{remove:1},tbody:{add_class:{align:"align_text"}},dd:{rename_tag:"div"},s:1,li:{},td:{check_attributes:{rowspan:"numbers",colspan:"numbers"},add_class:{align:"align_text"}},object:{remove:1},div:{add_class:{align:"align_text"}},option:{rename_tag:"span"},select:{rename_tag:"span"},i:{},track:{remove:1},wbr:{remove:1},fieldset:{rename_tag:"div"},big:{rename_tag:"span",set_class:"wysiwyg-font-size-larger"},button:{rename_tag:"span"},noscript:{remove:1},svg:{remove:1},input:{remove:1},table:{},keygen:{remove:1},h5:{add_class:{align:"align_text"}},meta:{remove:1},map:{rename_tag:"div"},isindex:{remove:1},mark:{rename_tag:"span"},caption:{add_class:{align:"align_text"}},tfoot:{add_class:{align:"align_text"}},base:{remove:1},video:{remove:1},strong:{},canvas:{remove:1},output:{rename_tag:"span"},marquee:{rename_tag:"span"},b:{},q:{check_attributes:{cite:"url"}},applet:{remove:1},span:{},rp:{rename_tag:"span"},spacer:{remove:1},source:{remove:1},aside:{rename_tag:"div"},frame:{remove:1},section:{rename_tag:"div"},body:{rename_tag:"div"},ol:{},nobr:{rename_tag:"span"},html:{rename_tag:"div"},summary:{rename_tag:"span"},"var":{rename_tag:"span"},del:{remove:1},blockquote:{check_attributes:{cite:"url"}},style:{remove:1},device:{remove:1},meter:{rename_tag:"span"},h3:{add_class:{align:"align_text"}},textarea:{rename_tag:"span"},embed:{remove:1},hgroup:{rename_tag:"div"},font:{rename_tag:"span",add_class:{size:"size_font"}},tt:{rename_tag:"span"},noembed:{remove:1},thead:{add_class:{align:"align_text"}},blink:{rename_tag:"span"},plaintext:{rename_tag:"span"},xml:{remove:1},h6:{add_class:{align:"align_text"}},param:{remove:1},th:{check_attributes:{rowspan:"numbers",colspan:"numbers"},add_class:{align:"align_text"}},legend:{rename_tag:"span"},hr:{},label:{rename_tag:"span"},dl:{rename_tag:"div"},kbd:{rename_tag:"span"},listing:{rename_tag:"div"},dt:{rename_tag:"span"},nextid:{remove:1},pre:{},center:{rename_tag:"div",set_class:"wysiwyg-text-align-center"},audio:{remove:1},datalist:{rename_tag:"span"},samp:{rename_tag:"span"},col:{remove:1},article:{rename_tag:"div"},cite:{},link:{remove:1},script:{remove:1},bdo:{rename_tag:"span"},menu:{rename_tag:"ul"},colgroup:{remove:1},ruby:{rename_tag:"span"},h2:{add_class:{align:"align_text"}},ins:{rename_tag:"span"},p:{add_class:{align:"align_text"}},sub:{rename_tag:"span"},comment:{remove:1},frameset:{remove:1},optgroup:{rename_tag:"span"},header:{rename_tag:"div"}}};define("core-ui/directus_messages_recipients",["app","backbone"],function(e,t){var i={};i.id="directus_messages_recipients",i.dataTypes=[],i.variables=[];var n='<input type="text" id="directus_messages_recipients-input" placeholder="Type users or groups here...">                 <div style="width:100%;max-width:700px;" id="directus_messages_recipients-recipients">{{#tags}}<span class="label tag recipient-tag">{{this}}</span>{{/tags}}</div>                 <input type="hidden" name="{{name}}" id="directus_messages_recipients-form">';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"click .message-recipient":function(e){var t=$(e.target).closest(".message-recipient").data("id");delete this.recipients[t],this.deletedDatums[t]&&(this.datums.push(this.deletedDatums[t]),delete this.deletedDatums[t]),this.renderTags()}},recipients:{},serialize:function(){return{value:this.options.value,name:this.options.name,comment:this.options.schema.get("comment"),tags:[]}},renderTags:function(){var e=this.$el.find("#directus_messages_recipients-recipients"),t=[];this.$("#directus_messages_recipients-input").val(""),_.each(this.recipients,function(e){var i=1===e.type?"font-weight:bold;":"";t.push('<div class="message-recipient" data-id="'+e.id+'" style="'+i+'"><img src="'+e.avatar+'"><div class="recipient-name">'+e.name+"</div></div>")}),this.$el.find("#directus_messages_recipients-form").val(_.keys(this.recipients)),e.html(t.join(""))},afterRender:function(){var t=0,i=1,n=this,s=e.users.filter(function(t){return t.get("id")==e.authenticatedUserId.id?!1:!0});s=s.map(function(e){return{id:e.id,uid:t+"_"+e.id,name:e.get("first_name")+" "+e.get("last_name"),avatar:e.getAvatar(),type:t}});var o=e.groups.map(function(t){return{id:t.id,uid:i+"_"+t.id,name:t.get("name"),avatar:e.PATH+"assets/img/directus-group-avatar-100x100.jpg",type:i}}),a=s.concat(o),r={},l=[],c=[];this.deletedDatums=[],_.each(a,function(e){var t=e.uid;c.push({id:t,name:e.name,avatar:e.avatar,tokens:e.name.split(" ")}),r[t]=e,l.push(t+": "+e.name)}),this.datums=c;var u=new Bloodhound({name:"recipients",local:c,datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace});this.searchEngine=u,u.initialize(),this.$("#directus_messages_recipients-input").typeahead({limit:5,template:Handlebars.compile('<div><img src="{{avatar}}" class="avatar"><span class="recipient-name">{{name}}</span></div>')},{displayKey:"name",source:u.ttAdapter()}),this.$("#directus_messages_recipients-input").on("typeahead:selected",function(e,t){n.recipients[t.id]=t,n.datums=_.filter(n.datums,function(e){return e==t?(n.deletedDatums[e.id]=e,!1):!0}),n.searchEngine.clear(),n.searchEngine.add(n.datums),n.renderTags()})},initialize:function(){this.recipients={}}}),i.validate=function(){},i.list=function(){return""},i}),define("core-ui/password",["app","backbone"],function(e,t){var i={};i.id="password",i.dataTypes=["VARCHAR"],i.skipSerializationIfNull=!0,i.isAPIHashed=!1,i.variables=[{id:"require_confirmation",ui:"checkbox",def:"1"},{id:"salt_field",ui:"textinput",def:"salt"}];var n='<input type="password" value="{{value}}" name="{{name}}" class="medium password-primary" style="display:block;margin-bottom:10px;" placeholder="Password" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"/>                  <input type="password" id="password_fake" class="hidden" autocomplete="off" style="display: none;">                  <span class="password-text"></span>                  {{#if require_confirmation}}                  <input type="password" value="{{value}}" class="medium password-confirm" style="display:block;margin-bottom:10px;" placeholder="Confirm Password" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"/>                  {{/if}}                  <div style="display:block;">                  <button class="btn btn-primary margin-left password-generate" style="margin-right:10px;" type="button">Generate New</button>                  <button class="btn btn-primary margin-left password-toggle" type="button">Reveal Password</button>                  <span class="placard encrypted hide add-color margin-left-small bold">Encrypted!</span>                  </div>                  ';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:function(){var t=this.$el.find("input.password-primary"),i=this.$el.find("input.password-confirm"),n=i.length?"password-confirm":"password-primary",s={"keydown input.password-primary":function(){i.length&&(this.$el.data("wasAPIHashed")||this.$el.data("isAPIHashed"))&&(i.val(""),i.removeAttr("disabled"),this.$el.data("wasAPIHashed",!1),this.$el.data("isAPIHashed",!1))},"click .password-generate":function(e){for(var t=10,s="abcdefghijklnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",o="",a=0,r=s.length;t>a;++a)o+=s.charAt(Math.floor(Math.random()*r));this.$el.data("isAPIHashed",!1),this.$el.data("wasAPIHashed",!1),this.$el.find(".encrypted").addClass("hide"),this.$el.find("input.password-primary").val(o),this.$el.find("input.password-confirm").val(o),i.length&&i.removeAttr("disabled");var l=this.$el.find("input."+n),c=this;return l.one("blur",function(){l.trigger("change"),c.hidePass()}),this.showPass(),l.trigger("focus"),e.preventDefault(),!1},"click .password-toggle":function(e){return"Mask Password"!=$(e.target).html()?(this.showPass(e),e.preventDefault(),!1):void this.hidePass(e)},"blur input.password-primary":function(e){if(!_.isEmpty($.trim($(e.target).val())))return this.$el.data("wasAPIHashed",this.$el.data("isAPIHashed")),this.$el.data("isAPIHashed",!1),void this.$el.find("input[type=password]").data("oldVal",void 0);var t=this;this.$el.find("input[type=password]").each(function(){var e=$(this).val();_.isEmpty(e)&&$(this).data("oldVal")&&($(this).val($(this).data("oldVal")),t.$el.data("isAPIHashed",!0),t.$el.data("wasAPIHashed",!1),t.$el.find(".encrypted").removeClass("hide"),i.length&&i.attr("disabled","disabled"))})}};return s["change input."+n]=function(){var n=t.val();if(n){var s=_.bind(function(){this.$el.data("isAPIHashed",!1),this.$el.find(".encrypted").addClass("hide"),t.val(""),i.length&&(i.val(""),i.removeAttr("disabled"))},this);if(i.length&&n!==i.val())return alert("Passwords do not Match!"),!1;var o={password:n},a=this.options.settings.has("salt_field")?this.options.settings.get("salt_field"):!1;if(a){var r=this.$el.closest("form").find("input[name="+a+"]");if(r.length&&(o.salt=$.trim(r.val()),_.isEmpty(o.salt)))return alert("Salt is not Defined! (Malformed Table Setup)"),!1}var l=_.bind(function(e){return _.isEmpty(e)||_.isEmpty(e.password)?void s():(t.val(e.password),i.length&&(i.val(e.password),i.attr("disabled","disabled")),this.$el.find(".encrypted").removeClass("hide"),void this.$el.data("isAPIHashed",!0))},this);$.ajax({type:"POST",url:e.API_URL+"hash/",data:o,success:l,dataType:"json",error:function(){s()}})}},s},initialize:function(){this.$el.data("isAPIHashed",!1),this.$el.data("wasAPIHashed",!0)},serialize:function(){return{name:this.options.name,value:this.options.value,comment:this.options.schema.get("comment"),require_confirmation:this.options.settings&&this.options.settings.has("require_confirmation")&&"0"==this.options.settings.get("require_confirmation")?!1:!0}},showPass:function(){this.$el.find("input.password-primary").get(0).type="text",this.$el.find("input.password-confirm").get(0).type="text",this.$el.find(".password-toggle").html("Mask Password")},hidePass:function(){this.$el.find("input.password-primary").get(0).type="password",this.$el.find("input.password-confirm").get(0).type="password",this.$el.find(".password-toggle").html("Reveal Password")}}),i.validate=function(e,t){var i=$('input[name="'+t.schema.id+'"]').parent(),n=(i.data(),i.find("input.password-primary").val()),s=i.find("input.password-confirm").val();if(!n&&t.schema.get("required"))return"You Must Specify a Password";if(n){if(n!==s)return"Passwords must match.";if(!i.data().isAPIHashed&&!i.data().wasAPIHashed)return"You Must Hash Your Password"}},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/many_to_one_typeahead",["app","backbone","core/UIView"],function(e,t,i){var n={};n.id="many_to_one_typeahead",n.dataTypes=["INT"],n.variables=[{id:"visible_column",ui:"textinput",char_length:64,required:!0},{id:"size",ui:"select",options:{options:{large:"Large",medium:"Medium",small:"Small"}}},{id:"template",ui:"textinput"}];var s='<input type="text" value="{{value}}" class="for_display_only {{size}}" {{#if readonly}}readonly{{/if}}/>                   <style>                     .tt-hint {padding:10px;}                     #edit_field_{{name}} .twitter-typeahead {                      width:100%;                    }                    #edit_field_{{name}} .tt-dropdown-menu {                       padding: 3px 0;                       box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);                       -webkit-border-radius: 2px;                       -moz-border-radius: 2px;                       border-radius: 2px;                       background-color: #fff;                   }                   #edit_field_{{name}} .tt-suggestions {                     margin-right: 0 !important;                   }                                     #edit_field_{{name}} .tt-suggestion {                     display: block;                     padding: 0px 20px;                     clear: both;                     font-weight: normal;                     white-space: nowrap;                     font-size: 12px;                     margin-right: 0 !important;                 }                                 #edit_field_{{name}} .tt-is-under-cursor {                     color: white;                     background-color: black;                 }                </style>';return n.Input=i.extend({tagName:"div",attributes:{"class":"field"},events:{},template:Handlebars.compile(s),serialize:function(){var e=this.model.get(this.name),t="";return e.isNew()||(t=e.get(this.visibleColumn)),{name:this.options.name,size:this.columnSchema.options.get("size"),readonly:!1,comment:this.options.schema.get("comment"),value:t}},afterRender:function(){var t=this.columnSchema.options.get("template"),i=this,n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:e.API_URL+"tables/"+this.collection.table.id+"/typeahead/?columns="+this.visibleColumn,ttl:0}});n.initialize(),this.$(".for_display_only").typeahead({minLength:1,items:5,valueKey:this.visibleColumn,template:Handlebars.compile("<div>"+t+"</div>")},{name:"related-items",displayKey:"value",source:n.ttAdapter()}),this.$(".for_display_only").on("typeahead:selected",function(e,t){var n=i.model.get(i.name),s=parseInt(t.id,10);n.clear(),n.set({id:s})})},initialize:function(){this.visibleColumn=this.columnSchema.options.get("visible_column");var e=this.model.get(this.name);this.collection=e.collection.getNewInstance({omit:["preferences"]})}}),n.validate=function(){},n.list=function(e){return void 0===e.value?"":e.value instanceof t.Model?e.value.get(e.settings.get("visible_column")):e.value},n}),define("core-ui/enum",["app","backbone"],function(e,t){var i={},n='<select name="{{name}}" {{#if readonly}}disabled{{/if}}><option value="">Select from below</option>{{#options}}<option value="{{value}}" {{#if selected}}selected{{/if}}>{{value}}</option>{{/options}}</select>';return i.id="enum",i.dataTypes=["ENUM","SET"],i.variables=[],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),serialize:function(){var e=this.options.value,t=this.options.schema.attributes.column_type;t=t.substr(5,t.length-6),t=t.replace(/'/g,"");var i=t.split(",");return i=_.map(i,function(t){var i={};return i.value=t,i.selected=i.value==e,i}),{value:this.options.value,name:this.options.name,comment:this.options.schema.get("comment"),readonly:!this.options.canWrite,options:i}}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){var t=_.isString(e.value)?e.value.replace(/<(?:.|\n)*?>/gm,"").substr(0,100):'<span class="silver">--</span>';return t},i}),define("core-ui/multi_select",["app","backbone"],function(e,t){var i={};i.id="multi_select",i.dataTypes=["VARCHAR","TEXT"],i.variables=[{id:"type",ui:"select",options:{options:{select_list:"Select List",cb_list:"Checkbox List"}}},{id:"delimiter",ui:"textinput",char_length:1,required:!0},{id:"options",ui:"textarea",options:{rows:25}}];var n='{{#if cb_list}}                     {{#options}}                             <input style="margin-top:1px;" name="{{key}}" type="checkbox" {{#if selected}}checked{{/if}}/> {{value}}                     {{/options}}</select>                   {{else}}                     <select multiple>                         {{#options}}                             <option value="{{key}}" {{#if selected}}selected{{/if}}>{{value}}</option>                         {{/options}}</select>                   {{/if}}                   <input type="hidden" name="{{name}}">';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"click select":function(){this.updateValue(!0)},"change input[type=checkbox]":function(){this.updateValue(!1)}},updateValue:function(e){var t,i,n;if(e){if(t=this.$el.find("select").val(),i="",t)for(n=0;n<t.length;n++)i+=t[n]+this.options.settings.get("delimiter")}else for(t=this.$el.find("input[type=checkbox]:checked"),i="",n=0;n<t.length;n++)i+=$(t[n]).attr("name")+this.options.settings.get("delimiter");i=i.substr(0,i.length-1),this.$el.find("input").val(i)},afterRender:function(){this.options.value&&this.updateValue("cb_list"!=this.options.settings.get("type"))},serialize:function(){var e=this.options.value||"",t=e.split(this.options.settings.get("delimiter")),i=this.options.settings.get("options"),n="cb_list"==this.options.settings.get("type");return _.isString(i)&&(i=$.parseJSON(i)),i=_.map(i,function(e,i){var n={};return n.value=e,n.key=i,n.selected=-1!=$.inArray(n.key,t),n}),{name:this.options.name,comment:this.options.schema.get("comment"),options:i,cb_list:n}}}),i.validate=function(e,t){return t.schema.isRequired()&&_.isEmpty(e)?"This field is required":void 0},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/system",["app","backbone"],function(e,t){var i={},n='<div class="status-group" style="padding: 10px 0;">                   {{#mapping}}                     <label style="margin-right:40px;display:inline-block;color:{{color}}" class="bold"><input style="display:inline-block;width:auto;margin-right:10px;" type="radio" {{#if ../readonly}}disabled{{/if}} name="{{../name}}" value="{{id}}" {{#if active}}checked{{/if}}>{{name}}</label>                   {{/mapping}}                   </div>';return i.id="system",i.dataTypes=["TINYINT"],i.variables=[],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"change input[type=radio]":function(e){this.$el.find("input[type=hidden]").val($(e.target).val())}},serialize:function(){var t={},i=e.statusMapping.mapping,n=this.options.value;t.mapping=[];for(var s in i)if(!this.model.isNew()||s!=e.statusMapping.deleted_num){var o=i[s];o.id=s,o.active=s==n?!0:!1,t.mapping.push(o)}return t.mapping.sort(function(e,t){return e.sort<t.sort?-1:e.sort>t.sort?1:0}),t.name=this.options.name,t.readonly=!this.options.canWrite,t}}),i.list=function(e){var t=e.value?'<input type="checkbox" checked="true" disabled>':'<input type="checkbox" disabled>';return t},i}),define("core-ui/user",["app","backbone"],function(e,t){var i={};return i.id="user",i.dataTypes=["INT"],i.variables=[],i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},initialize:function(t){t.model.isNew()&&(t.value=e.authenticatedUserId);var i=e.users.get(t.value);if(i){var n=i.getAvatar();this.$el.append('<img src="'+n+'" class="avatar"><span class="avatar-name">'+i.get("first_name")+" "+i.get("last_name")+"</span>")}else this.$el.append('<span class="avatar-name medium-grey-color">No user</span>')}}),i.list=function(t){var i,n,s=e.users.get(t.value);return s?(i=s.getAvatar(),n='<img src="'+i+'" class="avatar"><span class="avatar-name">'+s.get("first_name")+" "+s.get("last_name")+"</span>"):n='<span class="avatar-name medium-grey-color">No user</span>',n},i}),define("core-ui/directus_file",["app","backbone"],function(e,t){var i={};i.id="directus_file",i.system=!0;var n='<style type="text/css">                   div.ui-thumbnail {                     float: left;                     margin-top: 8px;                     max-height: 200px;                     padding: 10px;                     background-color: #ffffff;                     border: 1px solid #ededed;                     -webkit-border-radius:3px;                     -moz-border-radius:3px;                     border-radius:3px;                     color: #ededed;                     text-align: center;                     cursor: pointer;                   }                   div.ui-thumbnail.empty {                     width: 300px;                     height: 100px;                     background-color: #ffffff;                     border: 2px dashed #ededed;                     padding: 9px;                     font-size: 16px;                     font-weight: 600;                     line-height: 100px;                   }                   div.ui-thumbnail.empty.dragover,                   div.ui-thumbnail.empty:hover {                     background-color: #fefefe;                     border: 2px dashed #cccccc;                     cursor: pointer;                   }                   div.ui-thumbnail img {                     max-height: 200px;                   }                   div.ui-img-details {                     float: left;                     position: relative;                     width: 100%;                     margin-top: 0;                     margin-left: 0;                     line-height: 18px;                   }                   div.ui-img-details a.title {                     font-size: 18px;                   }                   div.ui-img-details div {                     display: inline;                   }                   div.ui-img-details i {                     font-weight: 400;                     font-style: italic;                     color: #ccc;                   }                   button.btn-right {                     margin-top: 8px;                     margin-right: 10px;                   }                   .swap-method-btn {                     display:block;                     clear: both;                     padding-top: 5px;                     cursor: pointer;                   }                   </style>                   {{#if url}}                   <a target="_BLANK" href="{{url}}">                   <div class="ui-thumbnail has-file">                     {{#if thumbUrl}}                       {{#if youtube}}                         <iframe width="300" height="200" src="http://www.youtube.com/embed/{{youtube}}" frameborder="0" allowfullscreen></iframe>                       {{else}}                         {{#if vimeo}}                           <iframe src="//player.vimeo.com/video/{{vimeo}}?title=0&amp;byline=0&amp;portrait=0&amp;color=7AC943" width="300" height="200" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>                         {{else}}                           <img src="{{thumbUrl}}">                         {{/if}}                       {{/if}}                     {{else}}                       <div class="default-info">{{type}}</div>                     {{/if}}                   </div>                   </a>                   <div class="ui-img-details">                     <button class="btn btn-small btn-primary btn-right" data-action="swap" type="button">Choose file</button>                   </div>                   {{/if}}                   <div style="{{#if url}}display:none;{{/if}}" id="fileDropArea" class="swap-method ui-thumbnail empty ui-thumbnail-dropzone">Drag file here, or click to choose</div>                   <input style="display:none" id="fileAddInput" type="file" class="large" />                   <input id="urlInput" type="text" class="hide swap-method medium" /><button class="hide swap-method btn btn-small btn-primary margin-left-small" id="retriveUrlBtn" type="button">Retrieve</button>                   <div class="swap-method swap-method-btn secondary-info">Or use a URL – for embedded videos like YouTube</div><div class="hide swap-method swap-method-btn secondary-info">Or upload a local file</div>';
return i.Input=t.Layout.extend({template:Handlebars.compile(n),serialize:function(){var t,i={},n=this.model,s=e.users.getCurrentUser();i=n.toJSON(),n.has("id")?t=n.get("user"):(t=s.id,i.isNew=!0);e.users.get(t);i.link=void 0,i.thumbUrl=void 0;var o=n.get("storage_adapter");if(null!==o&&void 0!==o&&""!==o&&(i.url=n.makeFileUrl(!1),i.thumbUrl=n.makeFileUrl(!0)),i.name=n.get("name"),i.orientation=parseInt(n.get("width"),10)>parseInt(n.get("height"),10)?"landscape":"portrait",n.has("type")){var a=n.get("type").substring(0,n.get("type").indexOf("/")),r=n.get("type").split("/").pop();"image"!=a&&"embed"!=a&&"pdf"!=r&&(i.thumbUrl=null,i.type=r.toUpperCase()),"embed/youtube"==n.get("type")?i.youtube=n.get("url"):"embed/vimeo"==n.get("type")&&(i.vimeo=n.get("url"))}return i},tagName:"div",attributes:{"class":"field"},events:{"click a[data-action=toggle-form]":function(){},"click li[data-action=swap]":function(){},"click .swap-method-btn":function(){this.$el.find(".swap-method").toggleClass("hide"),this.$el.find("#urlInput").is(":visible")&&this.$el.find("#urlInput").focus()},"click #retriveUrlBtn":function(){var t=this.$el.find("#urlInput").val(),i=this.model;e.sendLink(t,function(e){i.set(e[0]),i.trigger("sync")})},"change input[type=file]":function(t){var i=$(t.target)[0].files[0],n=this.model;e.sendFiles(i,function(e){n.set(e[0]),n.trigger("sync")})},"click .ui-thumbnail-dropzone":function(){this.$el.find("#fileAddInput").click()},'click button[data-action="swap"]':function(){this.$el.find("#fileDropArea").show()}},initialize:function(){var e=require("modules/files/FilesModel");this.model instanceof e||(this.model=new e(this.model.attributes,{collection:this.collection})),this.listenTo(this.model,"change",this.render)},afterRender:function(){var t,i=this.$el.find(".ui-thumbnail"),n=this.model;i.on("dragover",function(e){clearInterval(t),e.stopPropagation(),e.preventDefault(),i.addClass("dragover")}),i.on("dragleave",function(){clearInterval(t),t=setInterval(function(){i.removeClass("dragover"),clearInterval(t)},50)}),i[0].ondrop=_.bind(function(t){return t.stopPropagation(),t.preventDefault(),t.dataTransfer.files.length>1?void alert("One file only please"):(e.sendFiles(t.dataTransfer.files,function(e){n.set(e[0]),n.trigger("sync")}),void i.removeClass("dragover"))},this)}}),i.list=function(t){var i=t.model,n=require("modules/files/FilesModel");i instanceof n||(i=new n(i.attributes,{collection:i.collection}));var s=parseInt(i.get("width"),10)>parseInt(i.get("height"),10)?"landscape":"portrait",o=i.makeFileUrl(!0),a=_.contains(["image/jpeg","image/png","embed/youtube","embed/vimeo"],i.get("type")),r=a?o:e.PATH+"assets/img/document.png",l='<div class="media-thumb"><img src="'+r+'" class="img '+s+'"></div>';return l},i}),define("core-ui/directus_file_title",["app","backbone"],function(e,t){var i={};i.id="directus_file_title",i.system=!0,i.variables=[{id:"size",ui:"select",options:{options:{large:"Large",medium:"Medium",small:"Small"}}}];var n='{{#unless readonly}}<div class="char-count-container"><input type="text" value="{{value}}" name="{{name}}" id="{{name}}" class="{{size}}" {{#if readonly}}readonly{{/if}}/>                   <span class="char-count hide">{{characters}}</span></div>{{else}}<span>{{value}}</span>{{/unless}}';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{"focus input":function(){this.$el.find(".char-count").removeClass("hide")},"input input":"updateMaxLength","blur input":function(){this.$el.find(".char-count").addClass("hide")}},updateMaxLength:function(e){var t=this.options.schema.get("char_length")-e.target.value.length;this.$el.find(".char-count").html(t)},serialize:function(){var t=this.options.schema.get("char_length"),i=this.options.value||"",n=!1;return this.options.model.isNew()&&"file_id"==e.settings.get("files").get("file_title_naming")&&(i="This Items Title Will Automatically Become This Items ID When it is saved.",n=!0),{size:this.options.settings&&this.options.settings.has("size")?this.options.settings.get("size"):"large",value:i,name:this.options.name,maxLength:t,characters:t-i.toString().length,comment:this.options.schema.get("comment"),readonly:n}}}),i.validate=function(){},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/map",["app","backbone","moment"],function(e,t){var i={};i.id="map",i.dataTypes=["VARCHAR","ALIAS"],i.variables=[{id:"apiKey",ui:"textinput",char_length:200},{id:"street_number_field",ui:"textinput",char_length:200},{id:"street_field",ui:"textinput",char_length:200},{id:"city_field",ui:"textinput",char_length:200},{id:"postal_code_field",ui:"textinput",char_length:200},{id:"state_field",ui:"textinput",char_length:200},{id:"stateCode_field",ui:"textinput",char_length:200},{id:"country_field",ui:"textinput",char_length:200},{id:"countryCode_field",ui:"textinput",char_length:200},{id:"mapHeight",ui:"numeric",char_length:4,def:"400",comment:"Height in Pixels"},{id:"showLatLng",ui:"checkbox",comment:"Display latlng Textbox below map"}];var n='<style>#pac-input {         background-color: #fff;         padding: 0 11px 0 13px;         width: 400px;         font-family: Roboto;         font-size: 15px;         font-weight: 300;         text-overflow: ellipsis;       } .controls {         margin-top: 16px;         border: 1px solid transparent;         border-radius: 2px 0 0 2px;         box-sizing: border-box;         -moz-box-sizing: border-box;         height: 32px;         outline: none;         box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);       } #pac-input:focus {         border-color: #4d90fe;         margin-left: -1px;         padding-left: 14px;  /* Regular padding-left + 1. */         width: 401px;       }       </style>       <input id="pac-input" class="controls" type="text" placeholder="Search Box"><div style="height: 400px" id="map-canvas"/>   <input type="text" value="{{value}}" name="{{name}}" id="{{name}}" class="medium" readonly/>';return i.Input=t.Layout.extend({tagName:"div",attributes:{"class":"field"},template:Handlebars.compile(n),events:{},initializeMap:function(){var e=this,t=window.google,i=new t.maps.LatLng(40.77,-73.98);if(this.options.value){var n=this.options.value.split(",");if(n){var s=n.pop(),o=n.pop();isNaN(o)||isNaN(s)||(i=new t.maps.LatLng(o,s))}}var a={center:i,zoom:12},r=new t.maps.Map(this.$el.find("#map-canvas").get(0),a);navigator.geolocation&&!this.options.value&&navigator.geolocation.getCurrentPosition(function(e){var i=new t.maps.LatLng(e.coords.latitude,e.coords.longitude);r.setCenter(i)});var l=document.getElementById("pac-input");r.controls[t.maps.ControlPosition.TOP_LEFT].push(l);var c=new t.maps.places.SearchBox(l);if(t.maps.event.addListener(c,"places_changed",function(){for(var e=c.getPlaces(),i=new t.maps.LatLngBounds,n=0;n<e.length;n++)i.extend(e[n].geometry.location);r.fitBounds(i)}),t.maps.event.addListener(r,"bounds_changed",function(){var e=r.getBounds();c.setBounds(e)}),this.options.value){var u=this.options.value.split(",");if(u){var d=u.pop(),h=u.pop();this.marker=new t.maps.Marker({position:new t.maps.LatLng(h,d),map:r})}}t.maps.event.addListener(r,"click",function(i){e.marker?e.marker.setPosition(i.latLng):e.marker=new t.maps.Marker({position:i.latLng,map:r});var n=i.latLng.lat()+","+i.latLng.lng();e.$el.find("input").val(n),$.get("https://maps.googleapis.com/maps/api/geocode/json",{latlng:n,key:e.options.settings.get("apiKey"),result_type:"street_address"},function(t){if(t.results&&t.results.length>0){t=t.results[0].address_components;var i={};t.forEach(function(e){switch(e.types[0]){case"street_number":i.street_number=e.long_name;break;case"route":i.street=e.long_name;break;case"locality":i.city=e.long_name;break;case"postal_code":i.postal_code=e.long_name;break;case"administrative_area_level_1":i.state=e.long_name,i.stateCode=e.short_name;break;case"country":i.country=e.long_name,i.countryCode=e.short_name}});for(var n in i){var s=e.options.settings.has(n+"_field")?e.options.settings.get(n+"_field"):!1;if(s){var o=e.$el.closest("form").find("input[name="+s+"]");o.length&&o.val(i[n])}}}})})},serialize:function(){var e=this.options.value||"",t={value:e,name:this.options.name};return"ALIAS"==this.options.schema.get("type")&&(t.name=""),t},afterRender:function(){this.$el.find("#map-canvas").css("height",this.options.settings.get("mapHeight"))},initialize:function(){var e=this;require(["https://www.google.com/jsapi"],function(){google.load("maps","3",{other_params:"sensor=false&libraries=places&key="+e.options.settings.get("apiKey"),callback:function(){e.initializeMap()}})})}}),i.validate=function(){},i.list=function(e){return e.value?e.value.toString().replace(/<(?:.|\n)*?>/gm,"").substr(0,100):""},i}),define("core-ui/multiple_files",["app","backbone","sortable","core/UIView","core/overlays/overlays"],function(e,t,i,n,s){var o={};return o.id="multiple_files",o.dataTypes=["MANYTOMANY"],o.variables=[{id:"add_button",ui:"checkbox",def:"1"},{id:"choose_button",ui:"checkbox",def:"1"},{id:"remove_button",ui:"checkbox",def:"1"}],o.Input=n.extend({tagName:"div",attributes:{"class":"field"},events:{"click button[data-action=add]":"addItem","click button[data-action=insert]":"insertItem","click .remove-slideshow-item":"removeItem","click .media-slideshow-item > img":function(e){if(this.canEdit){var t=$(e.target).attr("data-file-cid"),i=this.relatedCollection.get(t,!0);this.editModel(i)}}},template:Handlebars.compile('<style type="text/css">         .ui-file-container:after {           clear: both;           content: "";           display: block;           width: 100%;         }         .media-slideshow-item {           cursor: {{#if sortable}}move{{else}}pointer{{/if}};           width: 160px;           float: left;           height: 160px;           position: relative;         }         .media-slideshow-item img {           width: 100%;           height: 100%;         }         .remove-hover-state .show-circle:hover .white-circle {           opacity: 0.0;         }         div.single-image-thumbnail.empty {           float: left;           background-color: #ffffff;           color: #ededed;           text-align: center;           cursor: pointer;           width: 156px;           height: 156px;           background-color: #ffffff;           border: 2px dashed #bbbbbb;           font-size: 12px;           font-weight: 600;           line-height: 14px;           color: #bbbbbb;         }         div.single-image-thumbnail.empty span {           margin-top: 0;           display: inline-block;           line-height: 18px;         }         div.single-image-thumbnail.empty span div.icon {           display: block;           font-size: 100px;           line-height: 90px;         }         div.single-image-thumbnail.empty.dragover,         div.single-image-thumbnail.empty:hover {           background-color: #BBBBBB;           color: #ffffff;           cursor: pointer;         }       </style>       <div class="ui-file-container">{{#rows}}<span class="media-slideshow-item show-circle margin-right-small margin-bottom-small"><img data-file-cid="{{cid}}" data-file-id="{{id}}" src={{url}}>{{#if ../showRemoveButton}}<div class="remove-slideshow-item large-circle white-circle"><span class="icon icon-cross"></span></div>{{/if}}</span>{{/rows}}<div class="swap-method single-image-thumbnail empty ui-thumbnail-dropzone"><span><div class="icon icon-picture"></div>Drag and drop<br>file here</span></div></div>       <div class="related-table"></div>       <div class="btn-row">{{#if showAddButton}}<button class="btn btn-primary margin-right-small" data-action="add" type="button">Add New Files</button>{{/if}}       {{#if showChooseButton}}<button class="btn btn-primary" data-action="insert" type="button">Choose Existing Files</button>{{/if}}</div>'),addItem:function(){this.addModel(new this.relatedCollection.nestedCollection.model({},{collection:this.relatedCollection.nestedCollection,parse:!0}))},removeItem:function(t){var i=$(t.target).closest(".media-slideshow-item").find("img").attr("data-file-cid"),n=this.relatedCollection.get(i);if(n.isNew())return this.relatedCollection.remove(n);var s={};s[e.statusMapping.status_name]=e.statusMapping.deleted_num,n.set(s)},addModel:function(t){var i=require("modules/tables/views/EditView"),n=this.relatedCollection,s=new i({model:t,inModal:!0});s.headerOptions.route.isOverlay=!0,s.headerOptions.route.breadcrumbs=[],s.headerOptions.basicSave=!0,s.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(s),s.save=function(){t.set(s.editView.data()),n.add(t,{nest:!0}),e.router.removeOverlayPage(this)}},insertItem:function(){var t=e.files,i=new s.ListSelect({collection:t});e.router.overlayPage(i);var n=this;i.save=function(){_.each(i.table.selection(),function(e){var i=t.get(e).toJSON();n.relatedCollection.add(i,{parse:!0,silent:!0,nest:!0})},this),n.relatedCollection.trigger("add"),e.router.removeOverlayPage(this)},t.fetch()},editModel:function(t){var i=require("modules/tables/views/EditView"),n=this.columnSchema.relationship.get("junction_key_right"),s=new i({model:t,hiddenFields:[n]});s.headerOptions.route.isOverlay=!0,s.headerOptions.route.breadcrumbs=[],s.headerOptions.basicSave=!0,s.events={"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},e.router.overlayPage(s),s.save=function(){t.set(t.diff(s.editView.data())),e.router.removeOverlayPage(this)},t.fetch()},drop:function(){var e=this.model.get(this.name);this.$(".media-slideshow-item img").each(function(t){e.get($(this).attr("data-file-cid")).set({sort:t},{silent:!0})}),e.setOrder("sort","ASC",{silent:!0})},serialize:function(){var t=this.relatedCollection.models,i=[],n=this;_.each(t,function(t){if(t.get(e.statusMapping.status_name)!=e.statusMapping.deleted_num){var s=t.cid;t=new e.files.model(t.get("data").attributes,{collection:n.relatedCollection}),i.push({id:t.id,url:t.makeFileUrl(!0),cid:s})}});var s=this.model.get(this.name),o=s.junctionStructure,a=void 0!==o.get("sort")?!0:!1;return{rows:i,canEdit:this.canEdit,showChooseButton:this.showChooseButton&&this.canEdit,showAddButton:this.showAddButton&&this.canEdit,showRemoveButton:this.showRemoveButton&&this.canEdit,sortable:a}},afterRender:function(){var n=this.$el,s=(this.fileModel,this),o=this.model.get(this.name),a=(o.structure,o.junctionStructure);if(n[0].ondrop=_.bind(function(i){return i.stopPropagation(),i.preventDefault(),s.sort.isDragging?void(s.sort.isDragging=!1):void e.sendFiles(i.dataTransfer.files,function(i){_.each(i,function(i){i[e.statusMapping.status_name]=e.statusMapping.active_num,i.id=void 0,i.user=s.userId;var n=new s.relatedCollection.nestedCollection.model(i,{collection:s.relatedCollection.nestedCollection,parse:!0});n=new t.Model({data:n},{collection:s.relatedCollection}),s.relatedCollection.add(n)})})}),void 0!==a.get("sort")){var r=this.$el.find(".ui-file-container")[0],l=this;this.sort=new i(r,{animation:150,draggable:".media-slideshow-item",ghostClass:"sortable-file-ghost",onStart:function(){var e=jQuery(r);e.addClass("remove-hover-state")},onEnd:function(){var e=jQuery(r);e.removeClass("remove-hover-state")},onUpdate:function(){l.drop()}})}},initialize:function(e){if(!this.columnSchema.relationship||"MANYTOMANY"!==this.columnSchema.relationship.get("type"))throw"The column "+this.columnSchema.id+" needs to have a relationship of the type MANYTOMANY in order to use the multiple_files ui";var t=this.model.get(this.name),i=(t.structure,t.junctionStructure),n=!1;void 0!==i.get("sort")&&(n=!0,t.setOrder("sort","ASC")),this.canEdit=!e.inModal,this.showRemoveButton="1"===this.columnSchema.options.get("remove_button"),this.showChooseButton="1"===this.columnSchema.options.get("choose_button"),this.showAddButton="1"===this.columnSchema.options.get("add_button"),this.sortable=n,this.relatedCollection=t,this.listenTo(t,"change add remove",function(){this.render()},this),this.listenTo(t.nestedCollection,"sync",function(){},this)}}),o.validate=function(e,t){return t.schema.isRequired()&&0===e.length?"This field is required":void 0},o.list=function(){return"x"},o}),define("core-ui/translation",["app","backbone"],function(e,t){var i={};return i.id="translation",i.dataTypes=["ONETOMANY"],i.variables=[{id:"languages_table",ui:"textinput",char_length:255,comment:"Enter Table that contains all languages supported"},{id:"languages_name_column",ui:"textinput",char_length:255,comment:"Language Title Field"},{id:"default_language_id",ui:"numeric",comment:"Default language ID in language table"},{id:"left_column_name",ui:"textinput",char_length:255,comment:"Enter Column name pointing to Languages table PK"}],i.Input=t.Layout.extend({}),i}),define("core-ui/template_chooser",["app","backbone"],function(e,t){var i={},n='<select name="{{name}}" {{#if readonly}}disabled{{/if}}> 	{{#if allow_null}}<option value="">{{placeholder_text}}</option>{{/if}}{{#options}} 	<option value="{{key}}" data-column-blacklist="{{column_blacklist}}" {{#if selected}}selected{{/if}}>{{value}}</option>{{/options}}</select>';return i.id="template_chooser",i.dataTypes=["VARCHAR","INT","TINYINT"],i.variables=[{id:"options",ui:"textarea",options:{rows:25}},{id:"allow_null",ui:"checkbox"}],i.Input=t.Layout.extend({template:Handlebars.compile(n),events:{"input select":"updateVisibleColumns"},tagName:"div",attributes:{"class":"field"},updateVisibleColumns:function(){var e=this.$el.find("select option:selected").data("columnBlacklist").split(",");$(".batchcontainer").show();for(var t=0;t<e.length;t++)$("#edit_field_"+e[t]).parent().parent().parent().hide()},serialize:function(){var e=this.options.value,t=this.options.settings.get("options");if(_.isString(t))try{t=$.parseJSON(t)}catch(i){console.log("Your 'Template Chooser' UI has malformed JSON")}return t=_.map(t,function(t,i){var n={};return n.value=t.name,n.thumb_url=t.thumb_url,n.column_blacklist=t.column_blacklist,n.key=i,n.selected=n.key==e,n}),{options:t,name:this.options.name,comment:this.options.schema.get("comment"),readonly:!this.options.canWrite,allow_null:this.options.settings.get("allow_null"),placeholder_text:this.options.settings.get("placeholder_text")?this.options.settings.get("placeholder_text"):"Select from Below"}}}),i.list=function(e){var t=_.isString(e.value)?e.value.replace(/<(?:.|\n)*?>/gm,"").substr(0,100):"";return t},i}),define("core/UIManager",["require","exports","module","core-ui/textinput","core-ui/directus_columns","core-ui/instructions","core-ui/checkbox","core-ui/color","core-ui/numeric","core-ui/slider","core-ui/single_file","core-ui/slug","core-ui/textarea","core-ui/directus_user","core-ui/directus_activity","core-ui/datetime","core-ui/date","core-ui/time","core-ui/directus_user_activity","core-ui/directus_user_avatar","core-ui/directus_file_size","core-ui/blob","core-ui/alias","core-ui/salt","core-ui/select","core-ui/tags","core-ui/many_to_one","core-ui/radiobuttons","core-ui/many_to_many","core-ui/one_to_many","core-ui/wysiwyg","core-ui/directus_messages_recipients","core-ui/password","core-ui/many_to_one_typeahead","core-ui/enum","core-ui/multi_select","core-ui/system","core-ui/user","core-ui/directus_file","core-ui/directus_file_title","core-ui/map","core-ui/multiple_files","core-ui/translation","core-ui/template_chooser","jquery","app"],function(e,t,i){var n=[e("core-ui/textinput"),e("core-ui/directus_columns"),e("core-ui/instructions"),e("core-ui/checkbox"),e("core-ui/color"),e("core-ui/numeric"),e("core-ui/slider"),e("core-ui/single_file"),e("core-ui/slug"),e("core-ui/textarea"),e("core-ui/directus_user"),e("core-ui/directus_activity"),e("core-ui/datetime"),e("core-ui/date"),e("core-ui/time"),e("core-ui/directus_user_activity"),e("core-ui/directus_user_avatar"),e("core-ui/directus_file_size"),e("core-ui/blob"),e("core-ui/alias"),e("core-ui/salt"),e("core-ui/select"),e("core-ui/tags"),e("core-ui/many_to_one"),e("core-ui/radiobuttons"),e("core-ui/many_to_many"),e("core-ui/one_to_many"),e("core-ui/wysiwyg"),e("core-ui/directus_messages_recipients"),e("core-ui/password"),e("core-ui/many_to_one_typeahead"),e("core-ui/enum"),e("core-ui/multi_select"),e("core-ui/system"),e("core-ui/user"),e("core-ui/directus_file"),e("core-ui/directus_file_title"),e("core-ui/map"),e("core-ui/multiple_files"),e("core-ui/translation"),e("core-ui/template_chooser")],s=e("jquery"),o={},a=e("app"),r={};i.exports={setup:function(){this.register(n),r[a.statusMapping.status_name]={ui:"system"}},_getUI:function(e){var t=o[e];return void 0===t&&console.warn('There is no registered UI with id "'+e+'"'),t},_getAllUIs:function(){return o},_getModelUI:function(e,t,i){if(void 0===i){var n=e.getStructure();i=n.get(t)}if(void 0===i)throw"Cannot Find Schema for: '"+t+"' Check Your Preferences!";var s=i.get("ui");return void 0!==r[t]&&(s=r[t].ui),this._getUI(s)},register:function(e){_.each(e,function(e){o[e.id]=e},this)},load:function(t){var i=this,n=new s.Deferred;return e(t,function(){i.register(_.values(arguments)),n.resolve()}),n},hasUI:function(e){return o.hasOwnProperty(e)},getSettings:function(e){var t=this._getUI(e),i=JSON.parse(JSON.stringify(t.variables||[])),n=JSON.parse(JSON.stringify(t.sortBy||[]));return{id:t.id,skipSerializationIfNull:t.skipSerializationIfNull||!1,variables:i,dataTypes:t.dataTypes||[],system:t.system||!1,sortBy:n}},getAllSettings:function(e){e=e||{};var t=_.map(o,function(e){return this.getSettings(e.id)},this);if(e.returnObject){var i={};return _.each(t,function(e){i[e.id]=e}),i}return t},getList:function(e,t){var i=e.collection,n=e.getStructure(),s=n.get(t),o=this._getModelUI(e,t,s);if(void 0===o){var a=e.get(t);return a&&""!==a||(a='<span class="secondary-info">--</span>'),a}var r=o.list({model:e,collection:i,settings:s.options,schema:s,value:e.get(t),tagName:"td"});return r&&""!==r||(r='<span class="secondary-info">--</span>'),r},getInputInstance:function(e,t,i){i.model=e,i.name=t,i.structure=i.structure||i.model.getStructure(),i.schema=i.structure.get(i.name),i.value=i.model.get(i.name),i.collection=i.collection||i.model.collection,i.canWrite="function"==typeof i.model.canEdit?i.model.canEdit(t):!0,i.settings=i.schema.options;var n=this._getModelUI(e,t,i.schema);if(void 0===n.Input)throw new Error('The UI with id "'+n.id+'" has no input view');var s=new n.Input(i);return s},validate:function(e,t,i){var n=e.collection,s=e.getStructure(),o=s.get(t),a=this._getModelUI(e,t,o);return a.hasOwnProperty("validate")?a.validate(i,{model:e,collection:n,settings:o.options,schema:o,tagName:"td"}):void 0}}}),require(["app","handlebars","core/UIManager","moment"],function(e,t,i,n){var s="-";t.registerHelper("imagesPath",function(){return e.PATH+"assets/img/"}),t.registerHelper("raw",function(e){return e&&new t.SafeString(e)}),t.registerHelper("number",function(e){return void 0===e?"":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}),t.registerHelper("resource",function(t){return e.RESOURCES_URL+t}),t.registerHelper("capitalize",function(t){return e.capitalize(t)}),t.registerHelper("nl2br",function(e){return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")}),t.registerHelper("uppercase",function(e){return e.toUpperCase()}),t.registerHelper("bytesToSize",function(t){return e.bytesToSize(t,0)}),t.registerHelper("contextualDate",function(e){return void 0===e||null===e?"-":new t.SafeString('<div class="contextual-date" title="'+new Date(e)+'">'+n(e).fromNow()+"</div>")}),t.registerHelper("avatarSmall",function(t){var i=e.users.get(t);return void 0===i?s:'<img src="'+i.getAvatar()+'" style="margin-right:7px;" class="avatar">'+i.get("first_name")}),t.registerHelper("activeMap",function(t){switch(t.get(e.statusMapping.status_name)){case 0:return"deleted";case 1:return"active";case 2:return"inactive"}}),t.registerHelper("userName",function(i){if(!_.isNaN(i)){var n=e.users.get(i);if(void 0===n)return s;var o=n.get("first_name").toLowerCase(),a=n.get("last_name").toLowerCase().charAt(0),r=o,l=e.users.find(function(e){return e.get("first_name").toLowerCase()===o&&e.id!=i});return void 0!==l&&(r=o+" "+a+".",l=e.users.find(function(e){return e.get("first_name").toLowerCase()===o&&e.get("last_name").toLowerCase().charAt(0)===a&&e.id!=i}),void 0!==l&&(r=o+" "+n.get("last_name"))),new t.SafeString(e.capitalize(r," "))}}),t.registerHelper("userShort",function(i){if(!_.isNaN(i)){var n=e.users.get(i);if(void 0===n)return"Unknown User";var s=n.get("first_name").toLowerCase(),o=n.get("last_name").toLowerCase().charAt(0),a=s,r=e.users.find(function(e){return e.get("first_name").toLowerCase()===s&&e.id!=i});return void 0!==r&&(a=s+" "+o+".",r=e.users.find(function(e){return e.get("first_name").toLowerCase()===s&&e.get("last_name").toLowerCase().charAt(0)===o&&e.id!=i}),void 0!==r&&(a=s+" "+n.get("last_name"))),new t.SafeString('<img src="'+n.getAvatar()+'" class="avatar"/>'+e.capitalize(a," "))}}),t.registerHelper("userAvatar",function(i){var n=e.users.get(i);if(n){var s=n.getAvatar();return new t.SafeString('<img src="'+s+'" class="avatar" title="'+n.get("first_name")+" "+n.get("last_name")+'"/>')}}),t.registerHelper("userFull",function(i){var n=e.users.get(i);return new t.SafeString('<img src="'+n.getAvatar()+'"  class="avatar"/><span class="avatar-name">'+n.get("first_name")+" "+n.get("last_name")+"</span>")}),t.registerHelper("userFirstAndLastName",function(i){var n=e.users.get(i);return void 0===n?s:new t.SafeString(n.get("first_name")+" "+n.get("last_name"))}),t.registerHelper("directusTable",function(i){if(void 0!==i&&i.length){var n=_.keys(i[0]),s=_.map(n,function(t){return"<th>"+e.capitalize(t,"_")+"</th>"}),o="<thead><tr>"+s.join("")+"</tr></thead>",a=_.map(i,function(e){var t=_.values(e),i=_.map(t,function(e){return"<td>"+e+"</td>"});return"<tr>"+i.join("")+"</tr>"}),r="<tbody>"+a.join("")+"</tbody>",l='<table class="table table-striped directus-table">'+o+r+"</table>";return new t.SafeString(l)}}),t.registerHelper("directusTable",function(i){if(void 0!==i&&i.length){var n=_.keys(i[0]),s=_.map(n,function(t){return"<th>"+e.capitalize(t,"_")+"</th>"}),o="<thead><tr>"+s.join("")+"</tr></thead>",a=_.map(i,function(e){var t=_.values(e),i=_.map(t,function(e){return"<td>"+e+"</td>"});return"<tr>"+i.join("")+"</tr>"}),r="<tbody>"+a.join("")+"</tbody>",l='<table class="table table-striped directus-table">'+o+r+"</table>";return new t.SafeString(l)}}),t.registerHelper("directusSelect",function(e){if(void 0!==e){var i=e.name;e=e.options;var n=_.map(e,function(e){var t=e.selected?"selected":"";return'<option value="'+e.name+'" '+t+">"+e.title+"</option>"}),s='<select id="'+i+'">'+n.join("")+"</select>";return new t.SafeString(s)}}),t.registerHelper("ui",function(e,n){e.isNested&&(e=e.get("data"));var s=i.getList(e,n)||"";return new t.SafeString(s)})}),define("helpers",function(){}),!function(e){function t(){e(n).each(function(){i(e(this)).removeClass("open")})}function i(t){var i,n=t.attr("data-target");return n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),i=e(n),i.length||(i=t.parent()),i}var n="[data-toggle=dropdown]",s=function(t){var i=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};s.prototype={constructor:s,toggle:function(){var n,s,o=e(this);if(!o.is(".disabled, :disabled"))return n=i(o),s=n.hasClass("open"),t(),s||n.toggleClass("open"),o.focus(),!1},keydown:function(t){var n,s,o,a,r;if(/(38|40|27)/.test(t.keyCode)&&(n=e(this),t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled"))){if(o=i(n),a=o.hasClass("open"),!a||a&&27==t.keyCode)return n.click();s=e("[role=menu] li:not(.divider):visible a",o),s.length&&(r=s.index(s.filter(":focus")),38==t.keyCode&&r>0&&r--,40==t.keyCode&&r<s.length-1&&r++,~r||(r=0),s.eq(r).focus())}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("dropdown");n||i.data("dropdown",n=new s(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=s,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.dropdown.data-api touchstart.dropdown.data-api",t).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("touchstart.dropdown.data-api",".dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",n,s.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",n+", [role=menu]",s.prototype.keydown)}(window.jQuery),define("plugins/bootstrap-dropdown",["jquery"],function(){}),!function(e){var t={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},bind:e.proxy,each:function(t,i){function n(e,t){return i(t,e)}e.each(t,n)},map:e.map,filter:e.grep,every:function(t,i){var n=!0;return t?(e.each(t,function(e,s){return(n=i.call(null,s,e,t))?void 0:!1}),!!n):n},some:function(t,i){var n=!1;return t?(e.each(t,function(e,s){return(n=i.call(null,s,e,t))?!1:void 0}),!!n):n},mixin:e.extend,getUniqueId:function(){var e=0;return function(){return e++}}(),templatify:function(t){function i(){return String(t)}return e.isFunction(t)?t:i},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var n,s;return function(){var o,a,r=this,l=arguments;return o=function(){n=null,i||(s=e.apply(r,l))},a=i&&!n,clearTimeout(n),n=setTimeout(o,t),a&&(s=e.apply(r,l)),s}},throttle:function(e,t){var i,n,s,o,a,r;return a=0,r=function(){a=new Date,s=null,o=e.apply(i,n)},function(){var l=new Date,c=t-(l-a);return i=this,n=arguments,0>=c?(clearTimeout(s),s=null,a=l,o=e.apply(i,n)):s||(s=setTimeout(r,c)),o}},noop:function(){}},i="0.10.2",n=function(){function e(e){return e.split(/\s+/)}function t(e){return e.split(/\W+/)}function i(e){return function(t){return function(i){return e(i[t])}}}return{nonword:t,whitespace:e,obj:{nonword:i(t),whitespace:i(e)}}}(),s=function(){function e(e){this.maxSize=e||100,this.size=0,this.hash={},this.list=new i}function i(){this.head=this.tail=null}function n(e,t){this.key=e,this.val=t,this.prev=this.next=null}return t.mixin(e.prototype,{set:function(e,t){var i,s=this.list.tail;this.size>=this.maxSize&&(this.list.remove(s),delete this.hash[s.key]),(i=this.hash[e])?(i.val=t,this.list.moveToFront(i)):(i=new n(e,t),this.list.add(i),this.hash[e]=i,this.size++)},get:function(e){var t=this.hash[e];return t?(this.list.moveToFront(t),t.val):void 0}}),t.mixin(i.prototype,{add:function(e){this.head&&(e.next=this.head,this.head.prev=e),this.head=e,this.tail=this.tail||e},remove:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev},moveToFront:function(e){this.remove(e),this.add(e)}}),e}(),o=function(){function e(e){this.prefix=["__",e,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function i(){return(new Date).getTime()}function n(e){return JSON.stringify(t.isUndefined(e)?null:e)}function s(e){return JSON.parse(e)}var o,a;try{o=window.localStorage,o.setItem("~~~","!"),o.removeItem("~~~")}catch(r){o=null}return a=o&&window.JSON?{_prefix:function(e){return this.prefix+e},_ttlKey:function(e){return this._prefix(e)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),s(o.getItem(this._prefix(e)))},set:function(e,s,a){return t.isNumber(a)?o.setItem(this._ttlKey(e),n(i()+a)):o.removeItem(this._ttlKey(e)),o.setItem(this._prefix(e),n(s))},remove:function(e){return o.removeItem(this._ttlKey(e)),o.removeItem(this._prefix(e)),this
},clear:function(){var e,t,i=[],n=o.length;for(e=0;n>e;e++)(t=o.key(e)).match(this.keyMatcher)&&i.push(t.replace(this.keyMatcher,""));for(e=i.length;e--;)this.remove(i[e]);return this},isExpired:function(e){var n=s(o.getItem(this._ttlKey(e)));return t.isNumber(n)&&i()>n?!0:!1}}:{get:t.noop,set:t.noop,remove:t.noop,clear:t.noop,isExpired:t.noop},t.mixin(e.prototype,a),e}(),a=function(){function i(t){t=t||{},this._send=t.transport?n(t.transport):e.ajax,this._get=t.rateLimiter?t.rateLimiter(this._get):this._get}function n(i){return function(n,s){function o(e){t.defer(function(){r.resolve(e)})}function a(e){t.defer(function(){r.reject(e)})}var r=e.Deferred();return i(n,s,o,a),r}}var o=0,a={},r=6,l=new s(10);return i.setMaxPendingRequests=function(e){r=e},i.resetCache=function(){l=new s(10)},t.mixin(i.prototype,{_get:function(e,t,i){function n(t){i&&i(null,t),l.set(e,t)}function s(){i&&i(!0)}function c(){o--,delete a[e],d.onDeckRequestArgs&&(d._get.apply(d,d.onDeckRequestArgs),d.onDeckRequestArgs=null)}var u,d=this;(u=a[e])?u.done(n).fail(s):r>o?(o++,a[e]=this._send(e,t).done(n).fail(s).always(c)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(e,i,n){var s;return t.isFunction(i)&&(n=i,i={}),(s=l.get(e))?t.defer(function(){n&&n(null,s)}):this._get(e,i,n),!!s}}),i}(),r=function(){function i(t){t=t||{},t.datumTokenizer&&t.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=t.datumTokenizer,this.queryTokenizer=t.queryTokenizer,this.reset()}function n(e){return e=t.filter(e,function(e){return!!e}),e=t.map(e,function(e){return e.toLowerCase()})}function s(){return{ids:[],children:{}}}function o(e){for(var t={},i=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,i.push(e[n]));return i}function a(e,t){function i(e,t){return e-t}var n=0,s=0,o=[];for(e=e.sort(i),t=t.sort(i);n<e.length&&s<t.length;)e[n]<t[s]?n++:e[n]>t[s]?s++:(o.push(e[n]),n++,s++);return o}return t.mixin(i.prototype,{bootstrap:function(e){this.datums=e.datums,this.trie=e.trie},add:function(e){var i=this;e=t.isArray(e)?e:[e],t.each(e,function(e){var o,a;o=i.datums.push(e)-1,a=n(i.datumTokenizer(e)),t.each(a,function(e){var t,n,a;for(t=i.trie,n=e.split("");a=n.shift();)t=t.children[a]||(t.children[a]=s()),t.ids.push(o)})})},get:function(e){var i,s,r=this;return i=n(this.queryTokenizer(e)),t.each(i,function(e){var t,i,n,o;if(s&&0===s.length)return!1;for(t=r.trie,i=e.split("");t&&(n=i.shift());)t=t.children[n];return t&&0===i.length?(o=t.ids.slice(0),void(s=s?a(s,o):o)):(s=[],!1)}),s?t.map(o(s),function(e){return r.datums[e]}):[]},reset:function(){this.datums=[],this.trie=s()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),i}(),l=function(){function n(e){return e.local||null}function s(n){var s,o;return o={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(s=n.prefetch||null)&&(s=t.isString(s)?{url:s}:s,s=t.mixin(o,s),s.thumbprint=i+s.thumbprint,s.ajax.type=s.ajax.type||"GET",s.ajax.dataType=s.ajax.dataType||"json",!s.url&&e.error("prefetch requires url to be set")),s}function o(i){function n(e){return function(i){return t.debounce(i,e)}}function s(e){return function(i){return t.throttle(i,e)}}var o,a;return a={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(o=i.remote||null)&&(o=t.isString(o)?{url:o}:o,o=t.mixin(a,o),o.rateLimiter=/^throttle$/i.test(o.rateLimitBy)?s(o.rateLimitWait):n(o.rateLimitWait),o.ajax.type=o.ajax.type||"GET",o.ajax.dataType=o.ajax.dataType||"json",delete o.rateLimitBy,delete o.rateLimitWait,!o.url&&e.error("remote requires url to be set")),o}return{local:n,prefetch:s,remote:o}}();!function(i){function s(t){t&&(t.local||t.prefetch||t.remote)||e.error("one of local, prefetch, or remote is required"),this.limit=t.limit||5,this.sorter=c(t.sorter),this.dupDetector=t.dupDetector||u,this.local=l.local(t),this.prefetch=l.prefetch(t),this.remote=l.remote(t),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new r({datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),this.storage=this.cacheKey?new o(this.cacheKey):null}function c(e){function i(t){return t.sort(e)}function n(e){return e}return t.isFunction(e)?i:n}function u(){return!1}var d,h;return d=i.Bloodhound,h={data:"data",protocol:"protocol",thumbprint:"thumbprint"},i.Bloodhound=s,s.noConflict=function(){return i.Bloodhound=d,s},s.tokenizers=n,t.mixin(s.prototype,{_loadPrefetch:function(t){function i(e){o.clear(),o.add(t.filter?t.filter(e):e),o._saveToStorage(o.index.serialize(),t.thumbprint,t.ttl)}var n,s,o=this;return(n=this._readFromStorage(t.thumbprint))?(this.index.bootstrap(n),s=e.Deferred().resolve()):s=e.ajax(t.url,t.ajax).done(i),s},_getFromRemote:function(e,t){function i(e,i){t(e?[]:o.remote.filter?o.remote.filter(i):i)}var n,s,o=this;return e=e||"",s=encodeURIComponent(e),n=this.remote.replace?this.remote.replace(this.remote.url,e):this.remote.url.replace(this.remote.wildcard,s),this.transport.get(n,this.remote.ajax,i)},_saveToStorage:function(e,t,i){this.storage&&(this.storage.set(h.data,e,i),this.storage.set(h.protocol,location.protocol,i),this.storage.set(h.thumbprint,t,i))},_readFromStorage:function(e){var t,i={};return this.storage&&(i.data=this.storage.get(h.data),i.protocol=this.storage.get(h.protocol),i.thumbprint=this.storage.get(h.thumbprint)),t=i.thumbprint!==e||i.protocol!==location.protocol,i.data&&!t?i.data:null},_initialize:function(){function i(){s.add(t.isFunction(o)?o():o)}var n,s=this,o=this.local;return n=this.prefetch?this._loadPrefetch(this.prefetch):e.Deferred().resolve(),o&&n.done(i),this.transport=this.remote?new a(this.remote):null,this.initPromise=n.promise()},initialize:function(e){return!this.initPromise||e?this._initialize():this.initPromise},add:function(e){this.index.add(e)},get:function(e,i){function n(e){var n=o.slice(0);t.each(e,function(e){var i;return i=t.some(n,function(t){return s.dupDetector(e,t)}),!i&&n.push(e),n.length<s.limit}),i&&i(s.sorter(n))}var s=this,o=[],a=!1;o=this.index.get(e),o=this.sorter(o).slice(0,this.limit),o.length<this.limit&&this.transport&&(a=this._getFromRemote(e,n)),a||(o.length>0||!this.transport)&&i&&i(o)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&a.resetCache()},ttAdapter:function(){return t.bind(this.get,this)}}),s}(this);var c={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},u={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};t.isMsie()&&t.mixin(u.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t.isMsie()&&t.isMsie()<=7&&t.mixin(u.input,{marginTop:"-1px"});var d=function(){function i(t){t&&t.el||e.error("EventBus initialized without el"),this.$el=e(t.el)}var n="typeahead:";return t.mixin(i.prototype,{trigger:function(e){var t=[].slice.call(arguments,1);this.$el.trigger(n+e,t)}}),i}(),h=function(){function e(e,t,i,n){var s;if(!i)return this;for(t=t.split(l),i=n?r(i,n):i,this._callbacks=this._callbacks||{};s=t.shift();)this._callbacks[s]=this._callbacks[s]||{sync:[],async:[]},this._callbacks[s][e].push(i);return this}function t(t,i,n){return e.call(this,"async",t,i,n)}function i(t,i,n){return e.call(this,"sync",t,i,n)}function n(e){var t;if(!this._callbacks)return this;for(e=e.split(l);t=e.shift();)delete this._callbacks[t];return this}function s(e){var t,i,n,s,a;if(!this._callbacks)return this;for(e=e.split(l),n=[].slice.call(arguments,1);(t=e.shift())&&(i=this._callbacks[t]);)s=o(i.sync,this,[t].concat(n)),a=o(i.async,this,[t].concat(n)),s()&&c(a);return this}function o(e,t,i){function n(){for(var n,s=0;!n&&s<e.length;s+=1)n=e[s].apply(t,i)===!1;return!n}return n}function a(){var e;return e=window.setImmediate?function(e){setImmediate(function(){e()})}:function(e){setTimeout(function(){e()},0)}}function r(e,t){return e.bind?e.bind(t):function(){e.apply(t,[].slice.call(arguments,0))}}var l=/\s+/,c=a();return{onSync:i,onAsync:t,off:n,trigger:s}}(),p=function(e){function i(e,i,n){for(var s,o=[],a=0;a<e.length;a++)o.push(t.escapeRegExChars(e[a]));return s=n?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",i?new RegExp(s):new RegExp(s,"i")}var n={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(s){function o(t){var i,n;return(i=r.exec(t.data))&&(wrapperNode=e.createElement(s.tagName),s.className&&(wrapperNode.className=s.className),n=t.splitText(i.index),n.splitText(i[0].length),wrapperNode.appendChild(n.cloneNode(!0)),t.parentNode.replaceChild(wrapperNode,n)),!!i}function a(e,t){for(var i,n=3,s=0;s<e.childNodes.length;s++)i=e.childNodes[s],i.nodeType===n?s+=t(i)?1:0:a(i,t)}var r;s=t.mixin({},n,s),s.node&&s.pattern&&(s.pattern=t.isArray(s.pattern)?s.pattern:[s.pattern],r=i(s.pattern,s.caseSensitive,s.wordsOnly),a(s.node,o))}}(window.document),f=function(){function i(i){var s,o,r,l,c=this;i=i||{},i.input||e.error("input is missing"),s=t.bind(this._onBlur,this),o=t.bind(this._onFocus,this),r=t.bind(this._onKeydown,this),l=t.bind(this._onInput,this),this.$hint=e(i.hint),this.$input=e(i.input).on("blur.tt",s).on("focus.tt",o).on("keydown.tt",r),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=t.noop),t.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(e){a[e.which||e.keyCode]||t.defer(t.bind(c._onInput,c,e))}):this.$input.on("input.tt",l),this.query=this.$input.val(),this.$overflowHelper=n(this.$input)}function n(t){return e('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform")}).insertAfter(t)}function s(e,t){return i.normalizeQuery(e)===i.normalizeQuery(t)}function o(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}var a;return a={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},i.normalizeQuery=function(e){return(e||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},t.mixin(i.prototype,h,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(e){var t=a[e.which||e.keyCode];this._managePreventDefault(t,e),t&&this._shouldTrigger(t,e)&&this.trigger(t+"Keyed",e)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(e,t){var i,n,s;switch(e){case"tab":n=this.getHint(),s=this.getInputValue(),i=n&&n!==s&&!o(t);break;case"up":case"down":i=!o(t);break;default:i=!1}i&&t.preventDefault()},_shouldTrigger:function(e,t){var i;switch(e){case"tab":i=!o(t);break;default:i=!0}return i},_checkInputValue:function(){var e,t,i;e=this.getInputValue(),t=s(e,this.query),i=t?this.query.length!==e.length:!1,t?i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=e)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(e){this.query=e},getInputValue:function(){return this.$input.val()},setInputValue:function(e,t){this.$input.val(e),t?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(e){this.$hint.val(e)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var e,t,i,n;e=this.getInputValue(),t=this.getHint(),i=e!==t&&0===t.indexOf(e),n=""!==e&&i&&!this.hasOverflow(),!n&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var e=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=e},isCursorAtEnd:function(){var e,i,n;return e=this.$input.val().length,i=this.$input[0].selectionStart,t.isNumber(i)?i===e:document.selection?(n=document.selection.createRange(),n.moveStart("character",-e),e===n.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),i}(),m=function(){function i(i){i=i||{},i.templates=i.templates||{},i.source||e.error("missing source"),i.name&&!o(i.name)&&e.error("invalid dataset name: "+i.name),this.query=null,this.highlight=!!i.highlight,this.name=i.name||t.getUniqueId(),this.source=i.source,this.displayFn=n(i.display||i.displayKey),this.templates=s(i.templates,this.displayFn),this.$el=e(c.dataset.replace("%CLASS%",this.name))}function n(e){function i(t){return t[e]}return e=e||"value",t.isFunction(e)?e:i}function s(e,i){function n(e){return"<p>"+i(e)+"</p>"}return{empty:e.empty&&t.templatify(e.empty),header:e.header&&t.templatify(e.header),footer:e.footer&&t.templatify(e.footer),suggestion:e.suggestion||n}}function o(e){return/^[_a-zA-Z0-9-]+$/.test(e)}var a="ttDataset",r="ttValue",l="ttDatum";return i.extractDatasetName=function(t){return e(t).data(a)},i.extractValue=function(t){return e(t).data(r)},i.extractDatum=function(t){return e(t).data(l)},t.mixin(i.prototype,h,{_render:function(i,n){function s(){return m.templates.empty({query:i,isEmpty:!0})}function o(){function s(t){var i;return i=e(c.suggestion).append(m.templates.suggestion(t)).data(a,m.name).data(r,m.displayFn(t)).data(l,t),i.children().each(function(){e(this).css(u.suggestionChild)}),i}var o,d;return o=e(c.suggestions).css(u.suggestions),d=t.map(n,s),o.append.apply(o,d),m.highlight&&p({node:o[0],pattern:i}),o}function d(){return m.templates.header({query:i,isEmpty:!f})}function h(){return m.templates.footer({query:i,isEmpty:!f})}if(this.$el){var f,m=this;this.$el.empty(),f=n&&n.length,!f&&this.templates.empty?this.$el.html(s()).prepend(m.templates.header?d():null).append(m.templates.footer?h():null):f&&this.$el.html(o()).prepend(m.templates.header?d():null).append(m.templates.footer?h():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(e){function t(t){i.canceled||e!==i.query||i._render(e,t)}var i=this;this.query=e,this.canceled=!1,this.source(e,t)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),i}(),g=function(){function i(i){var s,o,a,r=this;i=i||{},i.menu||e.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=t.map(i.datasets,n),s=t.bind(this._onSuggestionClick,this),o=t.bind(this._onSuggestionMouseEnter,this),a=t.bind(this._onSuggestionMouseLeave,this),this.$menu=e(i.menu).on("click.tt",".tt-suggestion",s).on("mouseenter.tt",".tt-suggestion",o).on("mouseleave.tt",".tt-suggestion",a),t.each(this.datasets,function(e){r.$menu.append(e.getRoot()),e.onSync("rendered",r._onRendered,r)})}function n(e){return new m(e)}return t.mixin(i.prototype,h,{_onSuggestionClick:function(t){this.trigger("suggestionClicked",e(t.currentTarget))},_onSuggestionMouseEnter:function(t){this._removeCursor(),this._setCursor(e(t.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function e(e){return e.isEmpty()}this.isEmpty=t.every(this.datasets,e),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(e,t){e.first().addClass("tt-cursor"),!t&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(e){var t,i,n,s;if(this.isOpen){if(i=this._getCursor(),t=this._getSuggestions(),this._removeCursor(),n=t.index(i)+e,n=(n+1)%(t.length+1)-1,-1===n)return void this.trigger("cursorRemoved");-1>n&&(n=t.length-1),this._setCursor(s=t.eq(n)),this._ensureVisible(s)}},_ensureVisible:function(e){var t,i,n,s;t=e.position().top,i=t+e.outerHeight(!0),n=this.$menu.scrollTop(),s=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>t?this.$menu.scrollTop(n+t):i>s&&this.$menu.scrollTop(n+(i-s))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(e){this.$menu.css("ltr"===e?u.ltr:u.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(e){var t=null;return e.length&&(t={raw:m.extractDatum(e),value:m.extractValue(e),datasetName:m.extractDatasetName(e)}),t},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(e){function i(t){t.update(e)}t.each(this.datasets,i)},empty:function(){function e(e){e.clear()}t.each(this.datasets,e),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function e(e){e.destroy()}this.$menu.off(".tt"),this.$menu=null,t.each(this.datasets,e)}}),i}(),v=function(){function i(i){var s,o,a;i=i||{},i.input||e.error("missing input"),this.isActivated=!1,this.autoselect=!!i.autoselect,this.minLength=t.isNumber(i.minLength)?i.minLength:1,this.$node=n(i.input,i.withHint),s=this.$node.find(".tt-dropdown-menu"),o=this.$node.find(".tt-input"),a=this.$node.find(".tt-hint"),o.on("blur.tt",function(e){var i,n,a;i=document.activeElement,n=s.is(i),a=s.has(i).length>0,t.isMsie()&&(n||a)&&(e.preventDefault(),e.stopImmediatePropagation(),t.defer(function(){o.focus()}))}),s.on("mousedown.tt",function(e){e.preventDefault()}),this.eventBus=i.eventBus||new d({el:o}),this.dropdown=new g({menu:s,datasets:i.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new f({input:o,hint:a}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function n(t,i){var n,o,r,l;n=e(t),o=e(c.wrapper).css(u.wrapper),r=e(c.dropdown).css(u.dropdown),l=n.clone().css(u.hint).css(s(n)),l.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),n.data(a,{dir:n.attr("dir"),autocomplete:n.attr("autocomplete"),spellcheck:n.attr("spellcheck"),style:n.attr("style")}),n.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(i?u.input:u.inputWithNoHint);try{!n.attr("dir")&&n.attr("dir","auto")}catch(d){}return n.wrap(o).parent().prepend(i?l:null).append(r)}function s(e){return{backgroundAttachment:e.css("background-attachment"),backgroundClip:e.css("background-clip"),backgroundColor:e.css("background-color"),backgroundImage:e.css("background-image"),backgroundOrigin:e.css("background-origin"),backgroundPosition:e.css("background-position"),backgroundRepeat:e.css("background-repeat"),backgroundSize:e.css("background-size")}}function o(e){var i=e.find(".tt-input");t.each(i.data(a),function(e,n){t.isUndefined(e)?i.removeAttr(n):i.attr(n,e)}),i.detach().removeData(a).removeClass("tt-input").insertAfter(e),e.remove()}var a="ttAttrs";return t.mixin(i.prototype,{_onSuggestionClicked:function(e,t){var i;(i=this.dropdown.getDatumForSuggestion(t))&&this._select(i)},_onCursorMoved:function(){var e=this.dropdown.getDatumForCursor();this.input.setInputValue(e.value,!0),this.eventBus.trigger("cursorchanged",e.raw,e.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(e,t){var i,n;i=this.dropdown.getDatumForCursor(),n=this.dropdown.getDatumForTopSuggestion(),i?(this._select(i),t.preventDefault()):this.autoselect&&n&&(this._select(n),t.preventDefault())},_onTabKeyed:function(e,t){var i;(i=this.dropdown.getDatumForCursor())?(this._select(i),t.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(e,t){this.input.clearHintIfInvalid(),t.length>=this.minLength?this.dropdown.update(t):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var e;this.dir!==(e=this.input.getLanguageDirection())&&(this.dir=e,this.$node.css("direction",e),this.dropdown.setLanguageDirection(e))},_updateHint:function(){var e,i,n,s,o,a;e=this.dropdown.getDatumForTopSuggestion(),e&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(i=this.input.getInputValue(),n=f.normalizeQuery(i),s=t.escapeRegExChars(n),o=new RegExp("^(?:"+s+")(.+$)","i"),a=o.exec(e.value),a?this.input.setHint(i+a[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(e){var t,i,n,s;t=this.input.getHint(),i=this.input.getQuery(),n=e||this.input.isCursorAtEnd(),t&&i!==t&&n&&(s=this.dropdown.getDatumForTopSuggestion(),s&&this.input.setInputValue(s.value),this.eventBus.trigger("autocompleted",s.raw,s.datasetName))},_select:function(e){this.input.setQuery(e.value),this.input.setInputValue(e.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",e.raw,e.datasetName),this.dropdown.close(),t.defer(t.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(e){this.isActivated?this.input.setInputValue(e):(this.input.setQuery(e),this.input.setInputValue(e,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),o(this.$node),this.$node=null}}),i}();!function(){var i,n,s;i=e.fn.typeahead,n="ttTypeahead",s={initialize:function(i,s){function o(){var o,a,r=e(this);t.each(s,function(e){e.highlight=!!i.highlight}),a=new v({input:r,eventBus:o=new d({el:r}),withHint:t.isUndefined(i.hint)?!0:!!i.hint,minLength:i.minLength,autoselect:i.autoselect,datasets:s}),r.data(n,a)}return s=t.isArray(s)?s:[].slice.call(arguments,1),i=i||{},this.each(o)},open:function(){function t(){var t,i=e(this);(t=i.data(n))&&t.open()}return this.each(t)},close:function(){function t(){var t,i=e(this);(t=i.data(n))&&t.close()}return this.each(t)},val:function(t){function i(){var i,s=e(this);(i=s.data(n))&&i.setVal(t)}function s(e){var t,i;return(t=e.data(n))&&(i=t.getVal()),i}return arguments.length?this.each(i):s(this.first())},destroy:function(){function t(){var t,i=e(this);(t=i.data(n))&&(t.destroy(),i.removeData(n))}return this.each(t)}},e.fn.typeahead=function(e){return s[e]?s[e].apply(this,[].slice.call(arguments,1)):s.initialize.apply(this,arguments)},e.fn.typeahead.noConflict=function(){return e.fn.typeahead=i,this}}()}(window.jQuery),define("plugins/typeahead",["jquery"],function(){}),define("app",["require","exports","module","handlebars","typetools","helpers","plugins/backbone.layoutmanager","plugins/bootstrap-dropdown","plugins/typeahead"],function(e,t,i){var n=e("handlebars"),s=e("typetools");e("helpers"),e("plugins/backbone.layoutmanager"),e("plugins/bootstrap-dropdown"),e("plugins/typeahead");var o={progressView:void 0,alertViews:[],lockScreen:function(){this.noScroll=!0},unlockScreen:function(){this.noScroll=!1},logOut:function(e){window.location.href=e?o.API_URL+"auth/logout/inactive":o.API_URL+"auth/logout"},logErrorToServer:function(e,t,i){var n=o.users.getCurrentUser(),s="n/a";n&&(s=n.get("email"));var a={type:e,message:t,details:i,page:location.href,user_email:s};$.post(o.API_URL+"exception",JSON.stringify(a)).done(function(e){console.log(e.response)}).error(function(e){console.log("FAILED TO LOG ERROR"+e.responseText)})},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},evaluateExpression:function(e,t,i){switch(t){case"==":return e==i;case"===":return e===i}},getCurrentGroup:function(){var e=o.users.getCurrentUser();return e.get("group")},getBookmarks:function(){return o.bookmarks},deepClone:function(e){return JSON.parse(JSON.stringify(e))},affix:function(){var e=$("#sidebar").offset(),t=$(".navbar").height(),i=parseInt(e.top,10)-parseInt(t,10)-20,n=!1;$(window).scroll(function(){var e=$(window).scrollTop();!n&&e>=i?(n=!0,$("#sidebar").addClass("affix-sidebar")):n&&i>e&&(n=!1,$("#sidebar").removeClass("affix-sidebar"))})}};o.sendFiles=function(e,t,i){var n=new FormData,s=function(e){e=_.map(e,function(e){return e.date_uploaded=new Date(e.date_uploaded.replace(/-/g,"/")),e}),t.apply(this,[e])};e instanceof File&&(e=[e]),_.each(e,function(e,t){n.append("file"+t,e)}),$.ajax({url:o.API_URL+"upload",type:"POST",data:n,cache:!1,contentType:!1,processData:!1,success:s,error:function(){o.trigger("alert","upload failed",arguments)},xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&i&&e.upload.addEventListener("progress",i,!1),e}})},o.sendLink=function(e,t){var i=function(e){e=_.map(e,function(e){return e.date_uploaded=new Date(e.date_uploaded.replace(/-/g,"/")),e}),t.apply(this,[e])};$.ajax({url:o.API_URL+"upload/link",type:"POST",data:{link:e},success:i,error:function(){o.trigger("alert","upload failed",arguments)}})},o.changeItemStatus=function(e,t,i){var n=o.statusMapping.status_name,n={},s=e.collection.hasPermission("harddelete")||e.collection.hasPermission("bigharddelete"),a=e.collection.hasPermission("delete")||e.collection.hasPermission("bigdelete"),r=t==o.statusMapping.deleted_num;if(r&&s)e.destroy({success:i.success});else{if(!e.has(o.statusMapping.status_name)||!(r&&a||!r))throw new Error("Please add an active column to this table for soft-delete, or change your group permissions to allow for a hard-delete");n[o.statusMapping.status_name]=t,e.save(n,i)}},o.isStringADate=function(e){return"string"==typeof e?!!e.match(/^([a-zA-Z]{3})\, ([0-9]{2}) ([a-zA-Z]{3}) ([0-9]{4}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/):!1},Object.toType=function(e){return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e};var a=window.JST=window.JST||{};Backbone.Layout.configure({manage:!0,prefix:"app/templates/",fetchTemplate:function(e){if("function"==typeof e)return e;if(e+=".html",a[e])return a[e];var t=this.async();$.ajax({url:o.root+e,global:!1,async:!1,success:function(i){t(a[e]=n.compile(i))}})}}),window.app=o,o=_.extend(o,{module:function(e){return _.extend({Views:{}},e)},useLayout:function(e){var t=new Backbone.Layout(_.extend({el:"body"},e));return this.layout=t,this.layout}},Backbone.Events,s),i.exports=o}),define("core/tabs",["app","backbone"],function(e,t){var i={};return i.Collection=t.Collection.extend({setActive:function(e){var t=this.get(e);_.each(this.where({active:!0}),function(e){e.unset("active",{silent:!0})}),t&&t.set({active:!0})}}),i.View=t.Layout.extend({template:"tabs",tagName:"div",serialize:function(){var t=e.users.getCurrentUser(),i=t.getAvatar(),n=e.users.getCurrentUser().get("id"),s=1===e.users.getCurrentUser().get("group").id?!0:!1;return{avatar:i,currentUserId:n,showSettings:s}},events:{'click a[href$="#logout"]':function(t){return t.preventDefault(),e.router.openModal({type:"confirm",text:"Are you sure you want to logout?",callback:function(){window.location.href=e.API_URL+"auth/logout"}}),!1}},afterRender:function(){e.activityInProgress&&$('a[href$="#activity"] span').removeClass("icon-bell").addClass("icon-cycle")},initialize:function(){this.collection.on("change",this.render,this)}}),i}),define("core/entries/EntriesJunctionCollection",["require","exports","module","app","backbone","core/collection","core/EntriesManager","core/entries/EntriesModel","core/entries/EntriesCollection"],function(e,t,i){var n=e("app"),s=e("backbone"),o=e("core/collection"),a=e("core/EntriesManager"),r=i.exports=o.extend({isNested:!0,model:s.Model.extend({isNested:!0,parse:function(t){var i=e("core/entries/EntriesModel");return t.data=new i(t.data,{collection:this.collection.nestedCollection}),this.collection.nestedCollection.add(t.data),t},toJSON:function(e){var t=_.clone(this.attributes);return t.data=this.get("data").toJSON(e),_.isEmpty(t.data)&&(t.data.id=this.get("data").id),t}}),trash:[],create:function(){return this.nestedCollection.create(arguments)},remove:function(e){e.isNew()||this.trash.push(e),this.constructor.__super__.remove.apply(this,arguments)},get:function(e,t){var i=r.__super__.get.call(this,e);return t&&(i=i.get("data")),i},add:function(e,t){t&&t.nest&&(_.isArray(e)||(e=[e]),e=_.map(e,function(e){var t={};return t.data=e,t})),r.__super__.add.apply(this,[e,t])},getModels:function(){return this.filter(function(e){return!(e.has(n.statusMapping.status_name)&&e.get(n.statusMapping.status_name)===n.statusMapping.deleted_num)})},getColumns:function(){return this.nestedCollection.getColumns()},parse:function(e){return void 0===e.rows?e:e.rows},hasColumn:function(e){return void 0!==this.structure.get(e)},initialize:function(t,i){var s=e("core/entries/EntriesCollection");this.structure=i.structure,this.table=i.table,this.preferences=i.preferences,this.filters=i.filters,this.junctionStructure=i.junctionStructure,"directus_files"===this.table.id?(this.droppable=!0,i.url=n.API_URL+"files",this.nestedCollection=new a.FilesCollection({},i)):this.nestedCollection=new s({},i),this.nestedCollection.on("change",function(){this.trigger("change")},this)},constructor:function(e,t){r.__super__.constructor.call(this,e,t)}})}),define("core/entries/EntriesModel",["require","exports","module","app","backbone","core/entries/EntriesJunctionCollection","core/UIManager","schema/SchemaManager","core/entries/EntriesCollection","core/EntriesManager"],function(e,t,i){var n=e("app"),s=e("backbone"),o=e("core/entries/EntriesJunctionCollection"),a=e("core/UIManager"),r=e("schema/SchemaManager"),l=i.exports=s.Model.extend({parse:function(e){return this._lastFetchedResult=e,e=this.parseRelational(e)
},get:function(e,t){var i,n;if(t=t||{},n=s.Model.prototype.get.call(this,e),t.flatten){i=this.getStructure().get(e).get("ui");var o=this.getStructure().get(e).getRelationshipType();"MANYTOONE"===o&&_.isObject(n)&&(n=n.get("id"))}return n},validate:function(e){var t=[],i=this.getStructure(),s=function(e){return void 0===e||null===e||""===e||!n.isNumber(e)&&!_.isDate(e)&&_.isEmpty(e)};return e=_.pick(e,i.pluck("column_name")),_.each(e,function(e,n){var o=i.get(n);if(!o.get("hidden_input")&&"id"!==n){var r="NO"===o.get("is_nullable"),l=s(e),c=a.getSettings(o.get("ui")),u=c.skipSerializationIfNull,d=!u&&r&&l?"The field cannot be empty":a.validate(this,n,e);void 0!==d&&t.push({attr:n,message:d})}},this),t.length>0?t:void 0},rollBack:function(){var e=this.parse(this._lastFetchedResult);return this.set(e)},parseDate:function(e){return e?(_.each(this.getStructure().getColumnsByType("datetime"),function(t){null!==e[t.id]&&(e[t.id]=new Date(e[t.id]))}),e):void 0},parseRelational:function(t){var i=this.getStructure(),n=i.getRelationalColumns(),s=e("core/entries/EntriesCollection"),a=e("core/EntriesManager");return _.each(n,function(e){var n=e.id,c=e.getRelated(),u=e.getRelationshipType(),d=(void 0!==t[n],i.get(e).options);switch(u){case"MANYTOMANY":case"ONETOMANY":var h=d.get("visible_columns")?d.get("visible_columns").split(","):[],p=t[n]||[],f={table:r.getTable(c),structure:r.getColumns("tables",c),parse:!0,filters:{columns_visible:h},privileges:r.getPrivileges(c)};if(void 0===f.table)throw"Directus Error! The related table '"+c+"' does not exist! Check your UI settings for the field '"+n+"' in the table '"+this.collection.table.id+"'";var m=_.difference(h,f.structure.pluck("column_name"));if(m.length>0)throw"Directus Error! The column(s) '"+m.join(",")+"' does not exist in related table '"+f.table.id+"'. Check your UI settings";if("ONETOMANY"===u){f.model=l,t[n]=new s(p,f);break}"MANYTOMANY"===u&&(f.junctionStructure=r.getColumns("tables",e.relationship.get("junction_table")),t[n]=new o(p,f));break;case"MANYTOONE":var g={};void 0!==t[n]&&null!==t[n]&&(g=_.isObject(t[n])?t[n]:{id:t[n]});var v=a.getInstance(c),b=v.model;t[n]=new b(g,{collection:v})}t[n].parent=this},this),t},diff:function(e,t,i){var n,s={};return"object"==typeof e?(n=e,i=t):(n={})[e]=t,_.each(n,function(e,t){this.get(t)!=e&&(s[t]=e)},this),s.id=this.id,s},sync:function(e,t,i){var n=this.attributes;if("patch"===e&&i.includeRelationships){var o=this.getStructure().getRelationalColumns();_.each(o,function(e){var t=e.id,s=n[t];if(_.isObject(s)){if("MANYTOONE"===e.getRelationshipType()&&_.isEmpty(s.attributes))return void(i.attrs[t]=null);s=s.toJSON({changed:!0}),_.isEmpty(s)||(i.attrs[t]=s)}},this)}return i.ignoreWriteFieldBlacklisted&&(i.attrs=_.omit(i.attrs,this.getWriteFieldBlacklist()),console.log(i.attrs)),s.sync.apply(this,[e,t,i])},isMine:function(){var e=parseInt(n.users.getCurrentUser().id,10),t=null!==this.collection?this.collection.table.get("user_create_column"):null,i=this.get(t);return i instanceof s.Model&&(i=i.get("id")),e===i},canEdit:function(e){if(!this.collection)return!1;var t=this.isMine(),i=(this.collection.privileges,this.collection.hasPermission("bigedit")),n=this.collection.hasPermission("edit"),s=!_.isEmpty(e)&&this.collection.isWriteBlacklisted(e),o=!this.has("id");return o&&!s||!t&&i&&!s||t&&n&&!s},getWriteFieldBlacklist:function(){return(this.collection.privileges.get("write_field_blacklist")||"").split(",")},canDelete:function(){var e=this.isMine(),t=this.collection.hasPermission("delete"),i=this.collection.hasPermission("bigdelete"),n=this.collection.hasPermission("harddelete"),s=this.collection.hasPermission("bigharddelete");return!e&&i||e&&t||!e&&s||e&&n},toJSON:function(e){var t,i,n=_.clone(this.attributes);return e=e||{},e.changed&&!this.isNew()&&(n=this.changed,this.id&&(n.id=this.id)),_.each(this.attributes,function(o,a){t=o instanceof s.Model,i=o instanceof s.Collection,(t||i)&&(o=o.toJSON(e),n[a]=o)}),e&&e.columns&&(n=_.pick(n,e.columns)),n},getStructure:function(){return this.structure},getNewInstance:function(e){return e=e||{},new l({},_.extend({structure:this.structure,table:this.table,privileges:this.privileges},e))},getTable:function(){return this.table},initialize:function(){this.on("invalid",function(e,t){var i=_.map(t,function(e){return e.attr+": "+e.message}).join("<br>");i="Table:	"+this.getTable().id+"<br>ID:	"+this.id+"<br>-----------------------<br>"+i,n.trigger("alert:error","The data is not valid",i)})},constructor:function c(e,t){this.structure=t.collection?t.collection.structure:t.structure,this.table=t.collection?t.collection.table:t.table,this.privileges=t.collection?t.collection.privileges:t.privileges,c.__super__.constructor.call(this,e,t)}})}),define("core/entries/EntriesCollection",["require","exports","module","backbone","core/collection","core/entries/EntriesModel"],function(e,t,i){var n=(e("backbone"),e("core/collection")),s=e("core/entries/EntriesModel"),o=i.exports=n.extend({model:s,rowsPerPage:100,toJSON:function(e){e=e||{};var t=o.__super__.toJSON.apply(this,[e]);return e.changed&&(t=_.filter(t,function(e){return!_.isEmpty(e)})),t},getColumns:function(){var e=void 0!==this.filters.columns_visible?this.filters.columns_visible:_.intersection(this.structure.pluck("id"),this.preferences.get("columns_visible").split(","));return e},getFilter:function(e){return this.preferences&&this.preferences.has(e)?this.preferences.get(e):this.filters[e]},getFilters:function(){var e=this.preferences?this.preferences.toJSON():{},t=_.clone(this.filters);e.hasOwnProperty("columns_visible")&&(e.columns_visible=e.columns_visible.split(","));var i=_.extend(t,_.pick(e,"columns_visible","sort","sort_order",app.statusMapping.status_name));return this.filters.hasOwnProperty("columns_visible")&&(i.columns_visible=this.filters.columns_visible),"directus_users"===this.table.id&&(i[app.statusMapping.status_name]=app.statusMapping.active_num),i},getTotalCount:function(){var e;if(!this.table.columns.get(app.statusMapping.status_name))return this.table.get("total");var t=this.getFilter(app.statusMapping.status_name).split(",");e=0;var i=this;return t.forEach(function(t){t in app.statusMapping.mapping&&i.table.has(app.statusMapping.mapping[t].name)&&(e+=i.table.get(app.statusMapping.mapping[t].name))}),e},updateActiveCount:function(e){if(this.table.has("active"))switch(this.getFilter("active")){case"1":this.table.set({active:this.table.get("active")-e});break;case"2":this.table.set({inactive:this.table.get("inactive")-e});break;case"0":this.table.set({trash:this.table.get("trash")-e})}},setFilter:function(e,t){var i,n=!1;null===e||"object"==typeof e?i=e:(i={})[e]=t,_.each(i,function(e,t){this.preferences&&this.preferences.has(t)?(n=!0,this.preferences.set(t,e,{silent:!0})):this.filters[t]=e},this),n&&this.preferences.save()},hasColumn:function(e){return void 0!==this.structure.get(e)},hasPermission:function(e){var t=this.privileges.get("permissions")||"",i=t.split(",");return _.contains(i,e)},isWriteBlacklisted:function(e){var t=(this.privileges.get("write_field_blacklist")||"").split(",");return _.contains(t,e)},initialize:function(e,t){this.structure=t.structure,this.privileges=t.privileges,this.table=t.table,t.rowsPerPage&&(this.rowsPerPage=t.rowsPerPage),t.filters&&(this.filters=t.filters),this.url=t.url||this.table.get("url")+"/rows",this.active=this.table.get("active"),this.filters=_.extend({currentPage:0,perPage:this.rowsPerPage,sort:"id",sort_order:"ASC"},this.filters),this.structure.get("sort")&&(this.filters.sort="sort"),this.filters[app.statusMapping.status_name]="1,2",t.preferences&&(this.preferences=t.preferences,this.preferences.on("change",function(){this.trigger("change")},this))},getNewInstance:function(e){e=e||{};var t={structure:this.structure,table:this.table,privileges:this.privileges,url:this.url,filters:this.filters,preferences:this.preferences};return e.omit&&(t=_.omit(t,e.omit)),new o([],t)},parseHeaders:function(e){void 0!==e.total&&this.table.set("total",e.total,{silent:!0});var t=this;app.statusMapping.mapping.forEach(function(i){e[i.name]&&t.table.set(i.name,e[i.name],{silent:!0})})},parse:function(e){return _.isEmpty(e)?void 0:(this.parseHeaders(e),e.rows)},constructor:function a(e,t){a.__super__.constructor.call(this,e,t)}})}),define("modules/users/UsersModel",["app","backbone","core/entries/EntriesModel"],function(e,t,i){return i.extend({getAvatar:function(){var t=this.get("avatar");return t=this.get("avatar_file_id")&&this.get("avatar_file_id").has("name")&&1==this.get("avatar_is_file")?this.get("avatar_file_id").makeFileUrl(!0):t?t.replace("?s=100","?s=200"):e.PATH+"assets/img/missing-directus-avatar.png"},initialize:function(){i.prototype.initialize.apply(this,arguments)}})}),define("modules/users/UsersCollection",["app","backbone","core/entries/EntriesCollection","modules/users/UsersModel"],function(e,t,i,n){return i.extend({model:n,getCurrentUser:function(){var t=e.authenticatedUserId;return this.get(t.id)},initialize:function(){i.prototype.initialize.apply(this,arguments)}})}),define("modules/files/FilesModel",["app","backbone","core/entries/EntriesModel"],function(e,t,i){var n=i.extend({initialize:function(){i.prototype.initialize.apply(this,arguments)},makeFileUrl:function(t){var i,n,s,o=e.storageAdapters;if(t){if(i="THUMBNAIL",!o.hasOwnProperty(i))throw new Error("Cannot find default thumbnail storage_adapter using key: "+i);n=o[i],this.get("name")&&(s=$.inArray(this.get("name").split(".").pop(),["tif","tiff","psd","pdf"])>-1?n.url+this.get("id")+".jpg":n.url+this.get("id")+"."+this.get("name").split(".").pop()),this.get("storage_adapter")&&"TEMP"==o[this.get("storage_adapter")].role&&t&&(s=$.inArray(this.get("name").split(".").pop(),["tif","tiff","psd","pdf"])>-1?o[this.get("storage_adapter")].url+"THUMB_"+this.get("name").replace(/\.[^/.]+$/,"")+".jpg":o[this.get("storage_adapter")].url+"THUMB_"+this.get("name"))}else{if(i=this.get("storage_adapter"),!o.hasOwnProperty(i))throw new Error("Files record's storage_adapter FK value maps to an undefined directus_storage_adapters record: "+i);n=o[i],s=n.url+this.get("name")}return s},constructor:function s(e,t){s.__super__.constructor.call(this,e,t)}});return n}),define("modules/files/FilesCollection",["app","backbone","core/entries/EntriesCollection","modules/files/FilesModel"],function(e,t,i,n){return i.extend({model:n,initialize:function(){i.prototype.initialize.apply(this,arguments)}})}),define("core/EntriesManager",["require","exports","module","./../schema/SchemaManager","./entries/EntriesCollection","modules/users/UsersCollection","modules/files/FilesCollection"],function(e,t,i){function n(e){p=e.apiURL,f=e.rowsPerPage,o=new d([],_.extend({rowsPerPage:3e3,url:p+"tables/directus_users/rows",filters:{columns_visible:["avatar","first_name","last_name","group","email","position","location","phone","last_access"],active:1}},c.getFullSchema("directus_users"))),a=new h([],_.extend({rowsPerPage:f,url:p+"files",filters:{columns_visible:["name","title","size","type","url","user","date_uploaded","storage_adapter","width","height"]}},c.getFullSchema("directus_files"))),l=new u([],_.extend({rowsPerPage:f,url:p+"activity/",filters:{columns_visible:["activity","datetime","user"],sort_order:"DESC"}},c.getFullSchema("directus_activity"))),r=new u([],_.extend({rowsPerPage:f,url:p+"groups/"},c.getFullSchema("directus_groups")))}function s(e,t){switch(e){case"directus_users":return o;case"directus_files":return a;case"directus_groups":return r;case"directus_activity":return l}t=t||{};var i=_.extend(c.getFullSchema(e),t);if(void 0===i.privileges)throw"You lack privileges for `"+e+"`";var n=new u([],_.extend({rowsPerPage:f},i));return n}var o,a,r,l,c=e("./../schema/SchemaManager"),u=e("./entries/EntriesCollection"),d=e("modules/users/UsersCollection"),h=e("modules/files/FilesCollection"),p="",f=100;i.exports.getInstance=s,i.exports.setup=n,i.exports.FilesCollection=h}),define("core/bookmarks",["app","backbone","core/EntriesManager"],function(e,t,i){var n={};return n.Collection=t.Collection.extend({initialize:function(t,i){this.url=e.API_URL+"bookmarks/",this.isCustomBookmarks=i.isCustomBookmarks||!1},setActive:function(e){var t=e.split("/");t.length>2&&(e=t[0]+"/"+t[1]);var i;_.each(this.models,function(t){t.unset("active_bookmark",{silent:!0}),(t.get("url")==e||"tables"==t.get("url")&&-1!=e.indexOf(t.get("url")))&&(i=t)}),i&&i.set({active_bookmark:!0})},addNewBookmark:function(e){e.user=e.user.toString(),void 0===this.findWhere(e)&&this.create(e)},removeBookmark:function(e){e.user=e.user.toString();var t=this.findWhere(e);void 0!==t&&(t.destroy(),this.remove(t))},isBookmarked:function(e){return void 0!==this.findWhere({title:e})?!0:!1}}),n.View=t.Layout.extend({template:"bookmarks-list",tagName:"ul",attributes:{"class":"row"},events:{"click .remove-snapshot":function(t){t.stopPropagation(),t.preventDefault();var n=$(t.target).parent().attr("href");if(n){var s=n.split("/"),o=s.pop();s.pop();var a=s.pop();0===s.length&&(a="directus_"+a),o&&a&&e.router.openModal({type:"confirm",text:"Are you sure you wish to delete the snapshot: "+o,callback:function(){var t=e.users.getCurrentUser().get("id"),n=i.getInstance(a);n.preferences.destroy({contentType:"application/json",data:JSON.stringify({title:o,table_name:a,user:t}),success:function(){e.getBookmarks().removeBookmark({title:o,icon_class:"icon-search",user:t})}})}})}return!1}},serialize:function(){var e={table:[],search:[],extension:[],other:[]},i=this.isCustomBookmarks;this.collection.each(function(t){var n=t.toJSON();e[n.section]?e[n.section].push(n):i&&(e[n.section]||(e[n.section]=[],e[n.section].isCustomBookmark=!0),e[n.section].push(n))});var n={bookmarks:e,isCustomBookmarks:this.isCustomBookmarks};return"tables"==t.history.fragment&&(n.tablesActive=!0),n},initialize:function(){this.isCustomBookmarks=this.collection.isCustomBookmarks||!1;var i=this;this.collection.on("add",function(){i.collection.setActive(t.history.fragment),i.render()}),this.collection.on("remove",function(){i.render()});var n=this.collection.where({url:"messages"});n&&(n=n[0],n&&(n.set({unread:e.messages.unread>0},{silent:!0}),this.render())),e.messages.on("sync change add",function(){var t=this.collection.where({url:"messages"});t&&(t=t[0],t&&(t.set({unread:e.messages.unread>0},{silent:!0}),this.render()))},this)},setActive:function(e){this.collection.setActive(e),this.render()}}),n}),define("core/ExtensionManager",["require","exports","module","underscore","jquery"],function(e,t,i){var n=e("underscore"),s=e("jquery"),o={};i.exports={register:function(e){n.each(e,function(e){o[e.id]=e},this)},load:function(t){var i=this,o=new s.Deferred;return e(t,function(){i.register(n.values(arguments)),o.resolve()}),o},getInstance:function(e){var t=new o[e].Router(e);return t},getIds:function(){return n.keys(o)},getInfo:function(e){return o[e]}}}),define("core/edit",["require","exports","module","app","./UIManager"],function(e,t,i){{var n=e("app"),s=e("./UIManager"),o=Backbone.Layout.extend({tagName:"li",attributes:{"class":"batchcontainer"},template:"uicontainer",events:{'click [name="batchedit"]':function(){this.$(".fieldset-smoke").toggle()}},serialize:function(){return{id:this.model.id,comment:this.model.get("comment"),batchEdit:this.options.batchEdit,required:this.model.get("required")}},afterRender:function(){this.model.isRequired()&&this.$el.addClass("required")}});i.exports=Backbone.Layout.extend({tagName:"form",hiddenFields:["id","sort"],template:Handlebars.compile("<ul class='fields'></ul>"),beforeRender:function(){var e={};this.structure.each(function(t){if("id"!=t.id&&(!this.model.table||this.model.table.get("user_create_column")!=t.id||this.model.collection.hasPermission("bigedit"))){if(n.statusMapping.status_name==t.id&&(this.options.collectionAdd&&this.model.set(n.statusMapping.status_name,n.statusMapping.active_num),this.model.isNew()&&(this.model.table&&this.model.table.get("default_status")?this.model.set(n.statusMapping.status_name,this.model.table.get("default_status")):this.model.set(n.statusMapping.status_name,n.statusMapping.active_num)),this.model.table&&this.model.table.get("column_groupings"))){var i=this.model.table.get("column_groupings");this.model.table.set({column_groupings:n.statusMapping.status_name+"^"+i})}var a=s.getInputInstance(this.model,t.id,{structure:this.structure,inModal:this.inModal}),r=_.contains(this.hiddenFields,t.id);if(r&&a.$el.css({display:"none"}),t.isRequired()&&a.$el.addClass("required"),r)this.insertView(".fields",a);else{var l=new o({model:t,batchEdit:void 0!==this.options.batchIds});l.insertView(".trow",a),e[t.id]=l}}},this);var t=this;if(this.model.table&&this.model.table.get("column_groupings")){var i=this.model.table.get("column_groupings"),a=1;i.split("^").forEach(function(i){var n="";-1!=i.indexOf(":")&&(n=i.substring(0,i.indexOf(":")),i=i.substring(i.indexOf(":")+1));var s="<span>"+n+"</span><div></div>";t.insertView(".fields",new Backbone.Layout({attributes:{"class":"gutter-bottom card-border",id:"grouping_"+a},template:Handlebars.compile(s)})),i.split(",").forEach(function(i){void 0!==e[i]&&t.insertView("#grouping_"+a+" div",e[i])}),a++})}else{e[n.statusMapping.status_name]&&(this.insertView(".fields",new Backbone.Layout({attributes:{"class":"gutter-bottom card-border",id:"grouping_0"}})),this.insertView("#grouping_0",e[n.statusMapping.status_name]),delete e[n.statusMapping.status_name]);for(var r in e)t.insertView(".fields",e[r])}},constructor:function(e){Backbone.Layout.__super__.constructor.call(this,e),this.$el.addClass("two-column-form")},afterRender:function(){var e=this.$el.find(":input:first:visible");if(e.focus(),e.val(e.val()),this.options.collectionAdd&&!_.isEmpty(this.options.parentField)){this.model.set(this.options.parentField.name,this.options.parentField.value);var t=this.$el.find("[name="+this.options.parentField.name+"]");t.closest("fieldset").hide()}},data:function(){var e=this.$el.serializeObject(),t=_.pick(e,this.visibleFields);return this.model.getWriteFieldBlacklist&&(t=_.omit(t,this.model.getWriteFieldBlacklist())),_.each(t,function(e,t,i){_.isArray(e)&&(i[t]=e.join(","))}),t},initialize:function(e){var t,i=e.hiddenFields||[];if(this.inModal=e.inModal||!1,this.structure=e.structure||this.model.getStructure(),void 0===this.structure)throw new Error("The edit view will not work without a valid model schema");t=this.structure.chain().filter(function(e){return e.get("hidden_input")}).pluck("id").value(),this.hiddenFields=_.union(i,t,this.hiddenFields),this.visibleFields=_.difference(this.structure.pluck("id"),this.hiddenFields),this.model.on("invalid",function(e,t){this.$el.find(".error-color").remove(),this.$el.find(".error").removeClass("error"),_.each(t,function(e){var t=$("#edit_field_"+e.attr);t.addClass("error"),t.find(".error-color").length<1&&t.append('<span class="error-color">'+e.message+"</span>")})},this),this.model.on("sync",function(){this.model.changed={},this.render()},this)}})}}),define("core/modal",["app","backbone"],function(e,t){var i={};return i.Prompt=t.Layout.extend({template:"modal",attributes:{id:"modal","class":"modal"},serialize:function(){var e=this.options.text?this.options.text:"",t={message:e};switch(this.options.type){case"prompt":t.isPrompt=!0,t.showInput=!0;break;case"yesnocancel":t.isYesNoConfirm=!0;break;case"alert":t.isAlert=!0;break;default:t.isPrompt=!0}return t},events:{"click #cancel":function(){this.close()},"click #save":function(){this.save()},"click #noBtn":function(){this.options.callback("no"),this.close()},"click #yesBtn":function(){this.options.callback("yes"),this.close()},"click #okBtn":function(){this.close()}},onKeydown:function(e){var t=e.keyCode||e.which;13===t&&this.save(),27===t&&this.close()},close:function(){this.remove(),$(document).off("keydown",_.bind(this.onKeydown,this))},save:function(){var e="";this.$el.find("input")&&(e=this.$el.find("input").val()),this.options.callback(e),this.close()},afterRender:function(){this.$el.find('input[type="text"]').focus()},initialize:function(e){this.options=e,$(document).on("keydown",_.bind(this.onKeydown,this))}}),i}),define("core/tableSimple",["app","backbone"],function(e,t){var i=t.Layout.extend({events:{"click td":function(i){var n=$(i.target).closest("tr").attr("data-id"),s=t.history.fragment.split("/");s.push(n),e.router.go(s)}},serialize:function(){var t=this.collection.getRows(),i=e.getBookmarks();return t=_.filter(t,function(t){var n=e.schemaManager.getPrivileges(t.table_name);if(t.bookmarked=void 0!==i.findWhere({title:t.id}),"undefined"==typeof n||void 0===n||null===n)return!1;if(null===n.get("permissions"))return!1;var s=n.get("permissions").split(",");return _.contains(s,"view")&&1!=n.get("unlisted")}),{rows:t,columns:this.collection.getColumns()}}});return i}),define("core/directus",["app","core/entries/EntriesCollection","core/entries/EntriesModel","core/entries/EntriesJunctionCollection","core/collection","core/edit","core/table/table.view","core/modal","core/tableSimple"],function(e,t,i,n,s,o,a,r,l){var c={};return c.Collection=s,c.EntriesCollection=t,c.EditView=o,c.Table=a,c.Modal=r,c.TableSimple=l,c.Model=i,c.SubRoute=Backbone.Router.extend({constructor:function(e){var t={};e=e||"","/"==e[e.length-1]?e=e.slice(0,e.length-1):e&&(e+="/"),_.each(this.routes,function(i,n){return n?(t[e+n]=i,t[e+n]):void(t[e]=i)}),this.routes=t,Backbone.Router.prototype.constructor.call(this)}}),c}),define("modules/activity/chart",["app","backbone","core/directus"],function(e,t){var i=t.Layout.extend({tagName:"div",template:"modules/activity/activity-chart",attributes:{"class":"activity-module"},numberWithCommas:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},afterRender:function(){var e=1e3,t=this,i=0,n={days:30,all:0,files:0,system:0,deleted:0,edited:0,added:0};$("td[data-sum]").each(function(){$(this).data("sum")>i&&(i=$(this).data("sum"))}),$(".chart-key").text(i),$(".bar").each(function(){var t=$(this).attr("data-total"),s=$(this).attr("data-type"),o=150/i,a=Math.floor(o*t);$(this).animate({height:a},e,"swing"),n[s]+=parseInt(t,10)}),n.all=n.files+n.system+n.deleted+n.edited+n.added,$(".activity-total h2").each(function(){var i=$(this),s=i.attr("data-type"),o=n[s];$({someValue:0}).animate({someValue:o},{duration:e,easing:"swing",step:function(){i.text(t.numberWithCommas(Math.ceil(this.someValue)))},complete:function(){i.text(t.numberWithCommas(this.someValue))}})})},serialize:function(){var e=this.collection.map(function(e){var t={table:e.get("table_name"),time:moment(e.get("datetime")).fromNow(),timestamp:e.get("datetime")};switch(e.get("action")){case"LOGIN":t.category="system";break;case"UPDATE":t.category="edit";break;case"ADD":t.category="add";break;case"DELETE":t.category="delete";break;case"REPLY":t.category="message"}return"directus_files"==t.table&&(t.category="file"),"directus_ui"==t.table&&(t.category="system"),"directus_messages"==t.table&&(t.category="message"),t});e=_.filter(e,function(e){return!e.hidden}),e=_.sortBy(e,function(e){return moment(e.timestamp)});var t=[];e.forEach(function(e){var i=moment(e.timestamp).format("YYYY-MM-DD");t[i]||(t[i]=i==moment().format("YYYY-MM-DD")?{title:"Today",data:[]}:{title:moment(e.timestamp).format("M-D"),data:[]}),t[i].data.push(e)});for(var i=[],n=0;30>n;n++){var s=moment(new Date((new Date).setDate((new Date).getDate()-n))).format("YYYY-MM-DD");i[s]=t[s]?t[s]:s==moment().format("YYYY-MM-DD")?{title:"Today",data:[]}:{title:moment(new Date((new Date).setDate((new Date).getDate()-n))).format("M-D"),data:[]}}e=[];for(var o in i){i[o].logins=0,i[o].edits=0,i[o].adds=0,i[o].deletes=0,i[o].messages=0,i[o].files=0,i[o].system=0,i[o].total=0;for(var a in i[o].data)"login"==i[o].data[a].category&&(i[o].logins+=1),"edit"==i[o].data[a].category&&(i[o].edits+=1),"add"==i[o].data[a].category&&(i[o].adds+=1),"delete"==i[o].data[a].category&&(i[o].deletes+=1),"message"==i[o].data[a].category&&(i[o].messages+=1),"file"==i[o].data[a].category&&(i[o].files+=1),"system"==i[o].data[a].category&&(i[o].system+=1),i[o].total+=1;e.push(i[o])}return e.reverse(),{activities:e}},initialize:function(){this.collection.on("sync",this.render,this)}});return i}),define("modules/files/views/EditFilesView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets"],function(e,t,i,n,s){return n.extend({events:{"click .saved-success":"saveCheck","change #saveSelect":"saveCheck"},deleteItem:function(i){var n=function(){var i=t.history.fragment.split("/");i.pop(),e.router.go(i)},s=e.statusMapping.deleted_num,o={success:n,patch:!0,wait:!0,validate:!1};try{e.changeItemStatus(this.model,s,o)}catch(i){setTimeout(function(){e.router.openModal({type:"alert",text:i.message})},0)}},saveCheck:function(t){var i=this.editView.data();if(i[e.statusMapping.status_name]&&i[e.statusMapping.status_name]==e.statusMapping.deleted_num){var n=this;e.router.openModal({type:"confirm",text:"Are you sure? This item will be removed from the system.",callback:function(){n.save(t)}})}else this.save(t)},save:function(i){var n="save-form-leave";void 0!==i.target.options&&(n=$(i.target.options[i.target.selectedIndex]).val());var s,o=this.editView.data(),a=this.model,r=this.model.isNew(),l=this.model.collection;if(s="save-form-stay"===n?function(i){var n=t.history.fragment.split("/");n.pop(),n.push(i.get("id")),e.router.go(n)}:function(){var i=t.history.fragment.split("/");i.pop(),"save-form-add"===n&&(r&&e.router.navigate("#",{trigger:!1,replace:!0}),i.push("new")),e.router.go(i)},"save-form-copy"===n){console.log("cloning...");var c=a.toJSON();delete c.id,a=new l.model(c,{collection:l,parse:!0}),l.add(a),console.log(a)}a.save(a.diff(o),{success:s,wait:!0,patch:!0,includeRelationships:!0})},afterRender:function(){this.setView("#page-content",this.editView),this.model.has("id")?this.model.fetch({dontTrackChanges:!0,error:function(i,n){if(404===n.status){var s=t.history.fragment;s.pop(),s.push("new"),e.router.go(s)}}}):this.editView.render()},leftToolbar:function(){return this.saveWidget=new s.SaveWidget,this.saveWidget.setSaved(!1),[this.saveWidget]},headerOptions:{route:{title:"Edit File",breadcrumbs:[{title:"Files",anchor:"#files"}],isOverlay:!1},basicSave:!1},initialize:function(){this.editView=new i.EditView({model:this.model,ui:this.options.ui}),this.headerOptions.route.title=this.model.get("id")?"Editing File":"Uploading New File",this.collection=e.files}})}),define("modules/files/views/FilesCardView",["app","backbone","core/widgets/widgets","moment"],function(e,t,i,n){var s=t.Layout.extend({tagName:"ul",attributes:{"class":"cards row"},events:{"click li":function(t){{var i=$(t.target).closest("li").attr("data-id"),n=e.users.getCurrentUser();n.get("group")}e.router.go("#files",i)}},template:"modules/files/filescardview",serialize:function(){var t=this.collection.map(function(t){var i={id:t.get("id"),cid:t.cid,title:t.get("title"),title_short:t.get("title").length>28?t.get("title").substr(0,25)+"...":t.get("title"),date_uploaded:n(t.get("date_uploaded")).fromNow(),size:t.get("size"),type:t.has("type")?t.get("type").split("/").pop():"",dimensions:t.get("width")+"×"+t.get("height")},s=t.get("type").substring(0,t.get("type").indexOf("/")),o=t.get("type").split("/").pop();return i.thumbnail="image"==s||"embed"==s||"pdf"==o?'<img src="'+t.makeFileUrl(!0)+'">':'<div class="default-info">'+i.type.toUpperCase()+"</div>",i.id||(i.thumbnail='<div class="default-loading"><span class="icon icon-three-dots"></span></div>'),"embed"==s?(i.size=e.seconds_convert(i.size),i.dimensions="",i.embed=!0):(i.size=e.bytesToSize(i.size,0),i.embed=!1),i});return{rows:t}},initialize:function(){this.collection.setOrder("date_uploaded","DESC"),this.collection.on("sort",this.render,this),this.collection.on("sync",this.render,this)}});return s}),define("modules/files/views/FilesTableView",["app","backbone","core/modal","core/edit","core/BasePageView","core/table/table.view","core/widgets/widgets","modules/files/views/EditFilesView","modules/files/views/FilesCardView"],function(e,t,i,n,s,o,a,r,l){return s.extend({headerOptions:{route:{title:"Files"}},leftToolbar:function(){return[new a.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})]},rightToolbar:function(){return[]},leftSecondaryToolbar:function(){return this.widgets.filterWidget||(this.widgets.filterWidget=new a.FilterWidget({collection:this.collection,basePage:this})),this.widgets.visibilityWidget||(this.widgets.visibilityWidget=new a.VisibilityWidget({collection:this.collection,basePage:this})),[this.widgets.visibilityWidget,this.widgets.filterWidget]},events:{"click #addBtn":function(){e.router.go("#files","new")},"click #gridBtn":function(){this.viewList&&(this.viewList=!1,$("#listBtn").parent().removeClass("active"),$("#gridBtn").parent().addClass("active"),this.table=new l({collection:this.collection}),this.render())},"click #listBtn":function(){this.viewList||(this.viewList=!0,$("#listBtn").parent().addClass("active"),$("#gridBtn").parent().removeClass("active"),this.table=new o({collection:this.collection,selectable:!0,droppable:!0,deleteOnly:!0,hideColumnPreferences:!0,blacklist:["storage_adapter"]}),this.render())}},afterRender:function(){this.setView("#page-content",this.table),this.collection.fetch(),window.File&&window.FileList&&window.FileReader;var e=this;this.dragoverListener=function(){e.$el.find(".external-drop-indicator").show()},window.addEventListener("dragover",this.dragoverListener,!1),this.dragleaveListener=function(){e.$el.find(".external-drop-indicator").hide()},window.addEventListener("dragleave",this.dragleaveListener,!1),this.dropListener=function(t){e.$el.find(".external-drop-indicator").fadeOut(500),console.log("drop"),e.processDroppedImages(t)},window.addEventListener("drop",this.dropListener,!1)},remove:function(){window.removeEventListener("drop",this.dropListener,!1),window.removeEventListener("dragleave",this.dragleaveListener,!1),window.removeEventListener("dragover",this.dragoverListener,!1),$(document).off("ajaxStart.directus"),$(document).on("ajaxStart.directus",function(){e.trigger("progress")})},processDroppedImages:function(t){this.uploadFiles||(this.uploadFiles=[]);var i=this;_.each(t.dataTransfer.files,function(t){var n=e.statusMapping.status_name,n={title:t.name,size:t.size,type:t.type};n[e.statusMapping.status_name]=e.statusMapping.active_num;var s=new i.collection.model(n,{collection:i.collection,parse:!0});i.collection.add(s),i.uploadFiles.push({model:s,fileInfo:t})}),this.collection.trigger("sync"),this.uploadInProgress||(this.uploadInProgress=!0,this.uploadNextImage())},uploadNextImage:function(){if(this.uploadFiles.length<=0)return void(this.uploadInProgress=!1);var t=this,i=this.uploadFiles[0];$(document).off("ajaxStart.directus"),e.sendFiles([i.fileInfo],function(n){"object"==typeof n[0]?(i.model.save(n[0],{success:function(){$(document).on("ajaxStart.directus",function(){e.trigger("progress")})},error:function(){$(document).on("ajaxStart.directus",function(){e.trigger("progress")}),t.collection.remove(i.model),t.collection.trigger("sync")},wait:!0,patch:!0,includeRelationships:!0}),t.collection.trigger("sync"),t.uploadFiles.shift(),t.uploadNextImage()):($(document).on("ajaxStart.directus",function(){e.trigger("progress")}),t.collection.remove(i.model),t.collection.trigger("sync"),t.uploadFiles.shift(),t.uploadNextImage())},function(e){$("li[data-cid="+i.model.cid+"]").find(".files-card-progress").show(),$("li[data-cid="+i.model.cid+"]").find(".default-loading > .icon").removeClass("icon-three-dots"),$("li[data-cid="+i.model.cid+"]").find(".default-loading > .icon").addClass("icon-upload-cloud"),$("li[data-cid="+i.model.cid+"]").find(".files-card-progress").width(e.loaded/e.total*100+"%")})},initialize:function(){this.viewList=!1,this.table=new l({collection:this.collection}),this.widgets=[]}})}),define("modules/files/files",["app","modules/files/views/EditFilesView","modules/files/views/FilesTableView"],function(e,t,i){var n=e.module();
return n.Views.Edit=t,n.Views.List=i,n}),define("modules/activity/activity",["app","backbone","core/directus","modules/activity/chart","modules/files/files","core/BasePageView","moment"],function(e,t,i,n,s,o,a){var r=e.module(),l=t.Layout.extend({tagName:"ul",attributes:{"class":"group-list"},template:"modules/activity/activity-list",events:{"click tr":function(t){var i=$(t.target).closest("tr").attr("data-id");e.router.go("#messages",i)}},serialize:function(){var t=e.schemaManager.getTables(),i=this.collection.map(function(i){var n={table:i.get("table_name"),time:a(i.get("datetime")).fromNow(),timestamp:i.get("datetime"),user_avatar:i.get("user")};switch(i.get("action")){case"LOGIN":n.action_login=!0;break;case"UPDATE":n.action_edit=!0;break;case"ADD":n.action_add=!0;break;case"DELETE":n.action_delete=!0;break;case"REPLY":n.action_add=!0}if(n.action_login&&(n.table="login",n.user=i.get("user")),i.get("row_id")>0&&(n.link="tables/"+n.table+"/"+i.get("row_id")),"directus_files"==n.table&&(n.is_file=!0,n.title=JSON.parse(i.get("data")).name),"directus_ui"==n.table&&(n.is_system=!0,n.title=i.get("identifier").substring(0,i.get("identifier").indexOf(","))),"directus_messages"==n.table){if(JSON.parse(i.get("data")).response_to)n.is_reply=!0,n.link="messages/"+JSON.parse(i.get("data")).response_to;else if("MESSAGE"==i.get("type"))e.messages.get(i.get("row_id"))?n.link="messages/"+i.get("row_id"):n.hidden=!0;else if(n.is_comment=!0,n.link=!1,JSON.parse(i.get("data")).comment_metadata){var s=JSON.parse(i.get("data")).comment_metadata.split(":");if(s){var o=s.pop(),r=s.pop();n.link="tables/"+r+"/"+o,n.title=r}}n.is_message=!0,n.title||(n.title=i.get("identifier")),"ADD"==i.get("action")&&(n.isNew=!0)}if(t.get(i.get("table_name"))){var l=t.get(i.get("table_name")).get("primary_column");if(l){var c=JSON.parse(i.get("data")),u=Handlebars.compile(l);n.title=u(c)}}return n});i=_.filter(i,function(e){return!e.hidden}),i=_.sortBy(i,function(e){return-a(e.timestamp)});var n=[];i.forEach(function(e){var t=a(e.timestamp).format("MMMM-D-YYYY");n[t]||(n[t]=t==a().format("MMMM-D-YYYY")?{title:"Today",data:[]}:{title:a(e.timestamp).format("MMMM D, YYYY"),data:[]}),n[t].data.push(e)}),i=[];for(var s in n)i.push(n[s]);return{activities:i}},initialize:function(){this.collection.setFilter({adv_search:""}),this.collection.on("sync",this.render,this)}});return r.Views.List=o.extend({headerOptions:{route:{title:"Activity"}},events:{"click a[data-action=file]":function(t){var i=parseInt($(t.target).attr("data-id"),10),n=new e.files.model({id:i},{collection:e.files}),o=new s.Views.Edit({model:n,stretch:!0});e.router.v.messages.insertView(o).render(),e.router.navigate("#files/"+n.id),o.on("close",function(){e.router.navigate("#activity")})}},serialize:function(){return{title:"Activity"}},afterRender:function(){this.insertView("#page-content",this.chart),this.insertView("#page-content",this.table),this.collection.fetch()},initialize:function(){this.chart=new n({collection:this.collection}),this.table=new l({collection:this.collection})}}),r}),define("modules/tables/views/BatchEditView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets"],function(e,t,i,n,s){return n.extend({headerOptions:{route:{title:"Batch Edit"},leftToolbar:!0,rightToolbar:!0},leftToolbar:function(){return this.saveWidget=new s.SaveWidget({widgetOptions:{basicSave:!0}}),this.saveWidget.setSaved(!1),[this.saveWidget]},events:{"click .saved-success":"saveConfirm"},saveConfirm:function(){var t=this,i=this.batchIds.length;e.router.openModal({type:"confirm",text:"This will affect "+i+" records. Continue?",callback:function(){t.save()}})},save:function(){var i=this.model,n=this.batchIds.length,s=0,o=0,a=this.editView.data(),r=$("input[name='batchedit']:checked").map(function(){return $(this).data("attr")}).toArray();i.set(this.model.diff(a));var l=_.pick(i.toJSON(),r),c=function(){var i=o+s;if(i===n){var a=t.history.fragment.split("/");a.pop(),alert(o+" items have been updated. "+s+" items failed to update"),e.router.go(a)}},u=function(){o++,c()},d=function(){s++,c()};_.each(this.batchIds,function(e){var t=i.getNewInstance({collection:i.collection});t.set(_.extend({id:e},l),{parse:!0}),t.save({},{success:u,error:d,wait:!0,includeRelationships:!0,validate:!1})})},afterRender:function(){this.setView("#page-content",this.editView),this.editView.render()},initialize:function(e){this.batchIds=e.batchIds,this.editView=new i.EditView({model:this.model,batchIds:e.batchIds}),this.headerOptions.route={title:"Batch Edit ("+this.batchIds.length+")",breadcrumbs:[{title:"Tables",anchor:"#tables"},{title:this.model.collection.table.id,anchor:"#tables/"+this.model.collection.table.id}]}}})}),define("modules/tables/views/HistoryView",["app","backbone","core/directus","moment"],function(e,t,i,n){return t.Layout.extend({tagName:"ul",attributes:{"class":"group-list"},template:"modules/activity/activity-history",events:{"click #messages-response-button":function(){if(""!==this.$el.find("#commentTextarea").val()){var t=new e.messages.model({from:e.authenticatedUserId.id},{collection:this.comments,parse:!0}),i="["+e.settings.get("global").get("site_name")+"] "+e.capitalize(this.model.collection.table.id)+': "'+this.model.get(this.model.table.get("primary_column"))+'"',n=new Date;t.set({datetime:n,subject:i,message:this.$el.find("#commentTextarea").val(),comment_metadata:this.model.collection.table.id+":"+this.model.get("id")}),t.unset("responses"),t.url=e.API_URL+"comments/",this.listenToOnce(t,"sync",function(){this.comments.add(t),this.render()}),this.$el.find("#messages-response-button").prop("disabled",!0),t.save()}},"input #commentTextarea":function(e){var t=$(e.target)[0].selectionStart,i=$(e.target).val(),n=i.substring(0,t),s=n.substring(n.lastIndexOf(" ")+1);if("@"===s.substring(0,1)){var o=s.substring(1);o?this.displaySearch(o):$("#tagInsert").empty()}else $("#tagInsert").empty()},"click .history-follow":function(){console.log(e.users.getCurrentUser())},"click .view-entire-history":function(){$(".history-container li.hide").removeClass("hide"),$(".view-entire-history").remove()},"click .tagInsertItem":function(e){var t=$(e.target),i=$("#commentTextarea")[0].selectionStart,n=$("#commentTextarea").val(),s=n.substring(0,i),o=s.lastIndexOf(" ")+1,a=s.substring(o);if("@"===a.substring(0,1)){var r=n.substring(i,n.length),l=i;l=r&&-1!=r.indexOf(" ")?r.indexOf(" ")+o+a.length:n.length,n=n.substring(0,o)+"@["+t.data("id")+" "+t.data("name")+"] "+n.substring(l,n.length),$("#commentTextarea").val(n),$("#tagInsert").empty()}}},displaySearch:function(e){$("#tagInsert").empty(),this.searchEngine.get(e,function(e){e.forEach(function(e){$("#tagInsert").append('<div class="tagInsertItem mention-choice" data-id="'+e.id+'" data-name="'+e.name+'"><img src="'+e.avatar+'"/>'+e.name+"</div>")})})},initialize:function(t){this.model=t.model,this.activity=e.activity,this.comments=new i.EntriesCollection({},{table:e.messages.table,structure:e.messages.structure}),this.model.isNew()||(this.activity.setFilter({adv_search:'table_name = "'+this.model.collection.table.id+'" AND row_id = '+this.model.get("id")}),this.activity.fetch(),this.comments.setFilter({adv_where:'comment_metadata = "'+this.model.collection.table.id+":"+this.model.get("id")+'"'}),this.comments.fetch());var n=!1;this.listenTo(this.activity,"sync",function(){n&&this.render(),n=!0}),this.listenTo(this.comments,"sync",function(){n&&this.render(),n=!0});var s=0,o=1,a=e.users.filter(function(t){return t.get("id")==e.authenticatedUserId.id?!1:!0});a=a.map(function(e){return{id:e.id,uid:s+"_"+e.id,name:e.get("first_name")+" "+e.get("last_name"),avatar:e.getAvatar(),type:s}});var r=e.groups.map(function(t){return{id:t.id,uid:o+"_"+t.id,name:t.get("name"),avatar:e.PATH+"assets/img/directus-group-avatar-100x100.jpg",type:o}}),l=a.concat(r),c=[];this.deletedDatums=[],_.each(l,function(e){var t=e.uid;c.push({id:t,name:e.name,avatar:e.avatar,tokens:e.name.split(" ")})});var u=new Bloodhound({name:"users",local:c,datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace});this.searchEngine=u,u.initialize()},serialize:function(){var t=this.activity.map(function(e){var t={table:e.get("table_name"),time:n(e.get("datetime")).fromNow(),timestamp:e.get("datetime"),user_avatar:e.get("user")};switch(e.get("action")){case"DELETE":t.icon="icon-trash",t.color="delete",t.action_text="deleted this item";break;case"UPDATE":t.icon="icon-pencil",t.color="edit",t.action_text="edited this item";break;case"ADD":t.add=!0,t.icon="icon-check",t.color="add",t.action_text="created this item"}return t}),i=this.comments.map(function(e){var t=new Date(e.get("datetime")+" UTC"),i={table:"Comment",timestamp:t,time:n(t).fromNow(),user_avatar:e.get("from")};return i.isComment=!0,i.title=e.get("message"),i});t=t.concat(i),t=_.sortBy(t,function(e){return-n(e.timestamp)});for(var s in t)if(t.hasOwnProperty(s)){t[s].hidden=s>=5?"hide":"preview";for(var o=t[s].title,a=0;;){if(o){var r=o.indexOf("@[");if(-1!==r){var l=o.substring(r).indexOf(" ");if(-1!==l){var c=o.substring(r+2,l+r),u=/^[0-9]|_+$/.test(c);if(u){var d=o.indexOf("]");if(-1!==d){var h=o.substring(l+1+r,d),p=t[s].title;t[s].title=p.substring(0,r+a)+'<span class="mention-tag">'+h+"</span>";var f=t[s].title.length;t[s].title+=p.substring(d+a+1),o=p.substring(d+a+1),a=f;continue}}}}}break}}var m=t.length>5?!0:!1,g=t.length-5;return{activities:t,preview:m,additionalCount:g,current_user:e.authenticatedUserId}}})}),define("modules/tables/views/TranslationView",["app","backbone","core/directus","core/EntriesManager"],function(e,t,i,n){return t.Layout.extend({template:Handlebars.compile('<div class="section-header"><span class="big-label-text">Translations</span>       <select id="activeLanguageSelect" class="section-dropdown">{{#languages}}<option {{#if active}}selected{{/if}} value="{{val}}">{{name}}</option>{{/languages}}</select></div>       <div id="translateEditFormEntry"></div>'),events:{"change #activeLanguageSelect":function(t){var i=this,n=$(t.target).val();$(t.target).val(this.activeLanguageId);var s=this.translateModel.diff(this.editView.data());delete s.id,$.isEmptyObject(s)?this.initializeTranslateView(n):e.router.openModal({type:"yesnocancel",text:"Do you wish to save changes to current Translation?",callback:function(e){"yes"===e&&i.saveTranslation(),i.initializeTranslateView(n)}})}},saveTranslation:function(){this.translateModel.set(this.translateModel.diff(this.editView.data())),this.translateCollection.contains(this.translateModel)||this.translateCollection.add(this.translateModel,{nest:!0})},afterRender:function(){this.editView&&(this.insertView("#translateEditFormEntry",this.editView),this.editView.render())},initialize:function(e){this.translateId=e.translateId,this.translateSettings=e.translateSettings,this.translateRelationship=e.translateRelationship,this.model.id?this.listenToOnce(this.model,"sync",this.updateTranslateConnection):this.updateTranslateConnection()},updateTranslateConnection:function(){this.translateCollection=this.model.get(this.translateId),this.languageCollection=n.getInstance(this.translateSettings.languages_table),this.listenTo(this.languageCollection,"sync",function(){this.initializeTranslateView()}),this.languageCollection.fetch()},initializeTranslateView:function(e){this.activeLanguageId=void 0===e?this.translateSettings.default_language_id:e;var t=this;if(this.translateModel=null,this.translateCollection.forEach(function(e){e.get(t.translateSettings.left_column_name)==t.activeLanguageId&&(t.translateModel=e)}),!this.translateModel){this.translateModel=new this.translateCollection.model({},{collection:this.translateCollection,parse:!0});var n={};n[this.translateSettings.left_column_name]=this.activeLanguageId,n[this.translateRelationship.junction_key_right]=this.model.id,this.translateModel.set(n)}this.editView=new i.EditView({model:this.translateModel,hiddenFields:[this.translateSettings.left_column_name,this.translateRelationship.junction_key_right]}),this.render()},serialize:function(){var e={},t=this;return this.languageCollection&&(e.languages=this.languageCollection.map(function(e){return{val:e.id,name:e.get(t.translateSettings.languages_name_column),active:e.id==t.activeLanguageId}})),e}})}),define("modules/tables/views/EditView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets","modules/tables/views/HistoryView","modules/tables/views/TranslationView"],function(e,t,i,n,s,o,a){var r=t.Layout.extend({template:Handlebars.compile('<div id="editFormEntry"></div><div id="translateFormEntry"></div><div id="historyFormEntry"></div>'),afterRender:function(){this.insertView("#editFormEntry",this.editView),this.insertView("#historyFormEntry",this.historyView),this.translateView&&this.insertView("#translateFormEntry",this.translateView),this.model.isNew()&&this.editView.render()},beforeSaveHook:function(){this.translateView&&this.translateView.saveTranslation()},data:function(){return this.editView.data()},initialize:function(e){var t=e.model.structure.pluck("ui"),n=t.indexOf("translation");if(-1!==n){var s=e.model.structure.models[n].id;e.hiddenFields=[s],this.translateView=new a({model:e.model,translateId:s,translateSettings:e.model.structure.models[n].options.attributes,translateRelationship:e.model.structure.models[n].relationship.attributes})}this.editView=new i.EditView(e),this.historyView=new o(e)},serialize:function(){return{}}});return n.extend({events:{"change input, select, textarea":"checkDiff","keyup input, textarea":"checkDiff","click .saved-success > span > .tool-item, .saved-success > span > .simple-select":"saveConfirm","change #saveSelect":"saveConfirm",submit:function(e){e.preventDefault()}},getHeaderOptions:function(){return{route:{title:"Editing Item",isOverlay:!1}}},checkDiff:function(){var e=this.model.diff(this.editView.data());delete e.id},deleteItem:function(i){var n=function(){var i=t.history.fragment.split("/");i.pop(),e.router.go(i)},s={success:n,patch:!0,wait:!0,validate:!1};try{e.changeItemStatus(model,value,s)}catch(i){setTimeout(function(){e.router.openModal({type:"alert",text:i.message})},0)}},saveConfirm:function(t){var i=this.editView.data(),n=this;i[e.statusMapping.status_name]&&i[e.statusMapping.status_name]==e.statusMapping.deleted_num?e.router.openModal({type:"confirm",text:"Are you sure you wish to delete this item?",callback:function(){n.save(t)}}):this.save(t)},save:function(i){this.editView.beforeSaveHook();var n="save-form-leave";if(void 0!==i.target.options&&(n=$(i.target.options[i.target.selectedIndex]).val()),this.single&&"save-form-stay"!==n&&"save-form-leave"!==n)return void console.log("This shouldn't be happening");var s,o=this.editView.data(),a=this.model,r=this.model.isNew(),l=this.model.collection;for(var c in o)a.structure.get(c).options&&"1"==a.structure.get(c).options.get("allow_null")&&""==o[c]&&(o[c]=null);if(s="save-form-stay"===n?function(i){var n=t.history.fragment.split("/");i.table.get("single")||(n.pop(),n.push(i.get("id")),e.router.go(n))}:function(){var i=t.history.fragment.split("/");i.pop(),"save-form-add"===n&&(r&&e.router.navigate("#",{trigger:!1,replace:!0}),i.push("new")),e.router.go(i)},"save-form-copy"===n){console.log("cloning...");var u=a.toJSON();delete u.id,a=new l.model(u,{collection:l,parse:!0}),l.add(a),console.log(a)}var d=a.diff(o);if(d[e.statusMapping.status_name]&&d[e.statusMapping.status_name]==e.statusMapping.deleted_num){var h=e.statusMapping.deleted_num,p={success:s,wait:!0,patch:!0,includeRelationships:!0};try{e.changeItemStatus(this.model,h,p)}catch(i){setTimeout(function(){e.router.openModal({type:"alert",text:i.message})},0)}}else a.save(d,{success:s,error:function(t,i){console.log("err");var n=JSON.parse(i.responseText);if(-1!=n.message.indexOf("Duplicate entry")){var s=n.message.split("for key")[1].trim();return s=s.substring(1,s.lastIndexOf("'")),void e.router.openModal({type:"alert",text:'This item was not saved because its "'+s+'" value is not unique.'})}},wait:!0,patch:!0,includeRelationships:!0});this.$el.find("#saveSelect").val("")},afterRender:function(){this.setView("#page-content",this.editView),this.model.has("id")&&this.model.fetch({dontTrackChanges:!0,error:function(i,n){if(404===n.status){var s=t.history.fragment;s=s.split("/"),"tables"!==s.slice(-2)[0]&&s.pop(),s.push("new"),e.router.go(s)}}}),this.editView.render()},leftToolbar:function(){return this.saveWidget=new s.SaveWidget({widgetOptions:{basicSave:this.headerOptions.basicSave,singlePage:this.single}}),this.saveWidget.setSaved(!1),[this.saveWidget]},initialize:function(e){this.headerOptions=this.getHeaderOptions(),this.isBatchEdit=void 0!==e.batchIds,this.single=this.model.collection.table.get("single"),this.editView=new r(e),this.headerOptions.route.isOverlay=!1,this.headerOptions.basicSave=!1,this.single?(this.headerOptions.route.title="Editing "+this.model.collection.table.id,this.headerOptions.route.breadcrumbs=[{title:"Tables",anchor:"#tables"}]):(this.headerOptions.route.title=this.model.get("id")?"Editing Item":"Creating New Item",this.headerOptions.route.breadcrumbs=[{title:"Tables",anchor:"#tables"},{title:this.model.collection.table.id,anchor:"#tables/"+this.model.collection.table.id}])}})}),define("modules/tables/views/TablesView",["app","backbone","core/directus","core/BasePageView"],function(e,t,i,n){return n.extend({headerOptions:{route:{title:"Tables"}},beforeRender:function(){this.setView("#page-content",new i.TableSimple({collection:this.collection,template:"modules/tables/tables"})),n.prototype.beforeRender.call(this)}})}),define("modules/tables/views/TableView",["app","backbone","core/BasePageView","core/ListViewManager","core/widgets/widgets"],function(e,t,i,n,s){return i.extend({headerOptions:{route:{title:"Table View",breadcrumbs:[{title:"Tables",anchor:"#tables"}]}},leftToolbar:function(){var e=[];return this.collection.hasPermission("add")&&(this.widgets.addWidget||(this.widgets.addWidget=new s.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})),e.push(this.widgets.addWidget)),e},rightToolbar:function(){return[new s.PaginatorWidget({collection:this.collection})]},leftSecondaryToolbar:function(){switch(this.leftSecondaryCurrentState=_.isUndefined(this.leftSecondaryCurrentState)?"default":this.leftSecondaryCurrentState,this.leftSecondaryCurrentState){case"default":return this.widgets.visibilityWidget||(this.widgets.visibilityWidget=new s.VisibilityWidget({collection:this.collection,basePage:this})),this.widgets.filterWidget||(this.widgets.filterWidget=new s.FilterWidget({collection:this.collection,basePage:this})),[this.widgets.visibilityWidget,this.widgets.filterWidget];case"actions":return this.widgets.selectionActionWidget||(this.widgets.selectionActionWidget=new s.SelectionActionWidget({collection:this.collection,widgetOptions:{batchEdit:this.batchEdit}})),[this.widgets.selectionActionWidget]}return[]},rightSecondaryToolbar:function(){switch(this.leftSecondaryCurrentState){case"default":return[new s.PaginationCountWidget({collection:this.collection})];case"actions":return[new s.SelectedCountWidget({collection:this.collection})]}return[]},events:{"click #addBtn":function(){e.router.go("#tables/"+this.collection.table.id+"/new")},"click #bookmarkBtn":function(){var i={title:this.collection.table.id,url:t.history.fragment,icon_class:"icon-star",user:e.users.getCurrentUser().get("id"),section:"table"};this.isBookmarked?e.getBookmarks().removeBookmark(i):e.getBookmarks().addNewBookmark(i),$("#bookmarkBtn").parent().toggleClass("active"),this.isBookmarked=!this.isBookmarked}},afterRender:function(){this.setView("#page-content",this.table),this.tryFetch()},initialize:function(){this.widgets={},this.table=n.getInstance({collection:this.collection,navigate:!0,maxColumns:8,toolbar:!0}),this.headerOptions.route.title=this.collection.table.id,this.collection.on("select",function(){this.actionButtons=Boolean($(".select-row:checked").length),this.batchEdit=$(".select-row:checked").length>1,this.actionButtons||this.batchEdit?"actions"!=this.leftSecondaryCurrentState&&(this.leftSecondaryCurrentState="actions",this.reRender()):"default"!=this.leftSecondaryCurrentState&&(this.leftSecondaryCurrentState="default",this.reRender())},this),this.collection.on("sort",function(){"default"!=this.leftSecondaryCurrentState&&(this.leftSecondaryCurrentState="default",this.reRender())},this),this.isBookmarked=e.getBookmarks().isBookmarked(this.collection.table.id)}})}),define("modules/tables/table",["app","modules/tables/views/BatchEditView","modules/tables/views/EditView","modules/tables/views/TablesView","modules/tables/views/TableView"],function(e,t,i,n,s){var o=e.module();return o.Views={},o.Views.Tables=n,o.Views.BatchEdit=t,o.Views.Edit=i,o.Views.List=s,o}),define("modules/settings/views/TablesView",["app","backbone","core/directus","core/BasePageView","schema/TableModel","schema/ColumnModel","core/UIManager","core/widgets/widgets","schema/SchemaManager","sortable"],function(e,t,i,n,s,o,a,r,l,c){{var u=e.module(),d=n.extend({headerOptions:{route:{title:"New Column",isOverlay:!0}},leftToolbar:function(){return[new r.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-check",buttonClass:"add-color-background"}})]},events:{"click #removeOverlay":function(){e.router.removeOverlayPage(this)},"click #addBtn":function(){this.save()}},save:function(){if(this.model.set({comment:""}),this.contentView.isValid()){var t=this;this.model.save({},{success:function(i){t.model.set(i),e.router.removeOverlayPage(t),t.collection.add(t.model),t.collection.trigger("change")}})}},afterRender:function(){this.setView("#page-content",this.contentView)},initialize:function(){this.contentView=new h({model:this.model})}}),h=t.Layout.extend({tagName:"form",attributes:{"class":"two-column-form"},template:"modules/settings/settings-columns-add",events:{"change select#dataType":function(e){this.selectedDataType=$(e.target).val(),this.render()},"change select#uiType":function(e){var t=this.model.get("column_name");this.model.clear(),this.model.set({column_name:t}),this.selectedUI=$(e.target).val(),this.selectedDataType=null,this.render()},"change input#columnName":function(e){this.columnName=$(e.target).val(),this.model.set({column_name:this.columnName})},"change input#charLength":function(e){this.model.set({char_length:$(e.target).val()})},"change select#table_related":function(e){this.model.set({table_related:$(e.target).val()})},"change #junction_key_right":function(e){this.model.set({junction_key_right:$(e.target).val()})},"change #junction_key_left":function(e){this.model.set({junction_key_left:$(e.target).val()})},"change #table_junction":function(e){this.model.set({junction_table:$(e.target).val()})}},serialize:function(){var t={ui_types:[],data_types:[],column_name:this.model.get("column_name")},i=a._getAllUIs();for(var n in i)if(n.indexOf("directus_")<0){this.selectedUI||(this.selectedUI=n);var s={title:n};this.selectedUI==n&&(s.selected=!0),t.ui_types.push(s)}t.ui_types.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0});var o=this;if(i[this.selectedUI].dataTypes.forEach(function(e){var i={title:e};o.selectedDataType||(o.selectedDataType=e),e==o.selectedDataType&&(i.selected=!0),t.data_types.push(i)}),["VARCHAR","CHAR","ENUM","INT"].indexOf(this.selectedDataType)>-1?(t.SHOW_CHAR_LENGTH=!0,this.model.get("char_length")||this.model.set({char_length:1}),t.char_length=this.model.get("char_length")):(delete t.char_length,this.model.has("char_length")&&this.model.unset("char_length",{silent:!0})),["many_to_one","many_to_one_typeahead"].indexOf(this.selectedUI)>-1){t.MANYTOONE=!0;var r=this.model.get("table_related"),l=e.schemaManager.getTables();l=l.map(function(e){return r||(r=e.id,this.model.set({table_related:e.id})),{id:e.get("table_name"),is_junction_table:e.get("is_junction_table"),selected:e.id===this.model.get("table_related")}},this),t.tables=l,this.model.set({junction_key_right:this.columnName})}if("single_file"===this.selectedUI&&this.model.set({table_related:"directus_files"}),["ONETOMANY","MANYTOMANY"].indexOf(this.selectedDataType)>-1){t[this.selectedDataType]=!0;var r=this.model.get("table_related"),c=this.model.get("junction_table"),l=e.schemaManager.getTables();l=l.map(function(e){return r||(r=e.id,this.model.set({table_related:e.id})),{id:e.get("table_name"),is_junction_table:e.get("is_junction_table"),selected:e.id===this.model.get("table_related")}},this),t.tables=l,"MANYTOMANY"==this.selectedDataType?(t.junctionTables=_.chain(l).filter(function(e){return e.is_junction_table}).map(function(e){return c||(c=e.id,this.model.set({junction_table:e.id})),{id:e.id,selected:e.id===this.model.get("junction_table")}},this).value(),void 0!==c&&(t.columns_left=e.schemaManager.getColumns("tables",c).map(function(e){return{column_name:e.id,selected:e.id===this.model.get("junction_key_left")}},this),t.columns_right=e.schemaManager.getColumns("tables",c).map(function(e){return{column_name:e.id,selected:e.id===this.model.get("junction_key_right")}},this))):void 0!==r&&(t.columns=e.schemaManager.getColumns("tables",r).map(function(e){return{column_name:e.id,selected:e.id===this.model.get("junction_key_right")}},this)),this.model.set({relationship_type:this.selectedDataType})}return this.model.set({data_type:this.selectedDataType,ui:this.selectedUI}),t},isValid:function(){return this.model.get("column_name")?!0:!1},initialize:function(){this.model.on("change",this.render,this),this.render()}}),p=n.extend({headerOptions:{route:{title:"UI Settings",isOverlay:!0}},leftToolbar:function(){return this.saveWidget=new r.SaveWidget({widgetOptions:{basicSave:!0}}),[this.saveWidget]},events:{"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},save:function(){console.log("Save")},afterRender:function(){this.setView("#page-content",this.table)},initialize:function(){this.table=new i.EditView({model:this.model,structure:this.options.schema})}}),f=n.extend({headerOptions:{route:{title:"Relationship Settings",isOverlay:!0}},leftToolbar:function(){return this.saveWidget=new r.SaveWidget({widgetOptions:{basicSave:!0}}),[this.saveWidget]},events:{"click .saved-success":function(){this.save()},"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},save:function(){console.log("Save")},afterRender:function(){this.setView("#page-content",this.table)},initialize:function(){this.table=new m({model:this.model})}}),m=t.Layout.extend({tagName:"form",attributes:{"class":"two-column-form"},events:{"change select#table_related":"changeRelatedTable"},changeRelatedTable:function(e){this.model.set({table_related:$(e.target).val()})},template:"modules/settings/settings-columns-edit-relationship",serialize:function(){var t={},i=this.model.get("table_related");t.data_types=[{title:this.model.get("relationship_type"),selected:!0}];var n=e.schemaManager.getTables();return n=n.map(function(e){return i||(i=e.id,this.model.set({table_related:e.id})),{id:e.get("table_name"),selected:e.id===this.model.get("table_related")}},this),t.tables=n,t},initialize:function(){this.model.on("change",this.render,this),this.render()}}),g=t.Layout.extend({tagName:"form",attributes:{id:"table-settings"},template:"modules/settings/settings-columns",events:{"click span[data-action=ui]":"editUI","click span[data-action=relationship]":"editRelationship","change select,input":"bindForm","click button[data-action=new-field]":"newField"},newField:function(){var t=this.collection,i=new o({data_type:"ALIAS",ui:{}},{collection:this.collection}),n=new d({model:i,collection:t});e.router.overlayPage(n)},bindForm:function(e){var t=e.target.getAttribute("data-id"),i=e.target.name,n=e.target.value,s=this.collection.get(t),o={};("checkbox"===e.target.type||"radio"===e.target.type)&&(n=$(e.target).is(":checked")?1:0),this.collection.table.set({primary_column:$("#table-settings").find("input[type=radio]:checked").attr("data-id")}),o[i]=n,s.set(o)},sort:function(){var e=this.collection;this.$el.find("tbody > tr").each(function(t){var i=e.get(this.getAttribute("data-id"));i.set({sort:t},{silent:!0})}),e.sort()},editUI:function(t){var i=t.target.getAttribute("data-id"),n=this.collection.get(i),s=n.options;s.set({id:n.get("ui")});var o=e.schemaManager.getColumns("ui",s.id),a=new p({model:s,schema:o});e.router.overlayPage(a),a.save=function(){s.save(a.table.data(),{success:function(){e.router.removeOverlayPage(a)}})},s.fetch()},editRelationship:function(i){var n=i.target.getAttribute("data-id"),s=this.collection.get(n),o=new t.Model(_.extend(s.relationship.toJSON(),{data_type:s.get("type"),relationship_type:s.relationship.get("type")}));s.relationship=o;var a=this,r=new f({model:o});e.router.overlayPage(r),r.save=function(){o.url=e.API_URL+"tables/"+a.collection.table.id+"/columns/"+s.id+"/",o.save({},{success:function(){e.router.removeOverlayPage(r)}})}},serialize:function(){var e=a.getAllSettings({returnObject:!0}),t=this.collection.table.get("primary_column"),i=this.collection.map(function(i){var n=i.toJSON();"NO"===n.is_nullable&&(n.required=!0,n.requiredDisabled=!0),n.uiHasVariables=e.hasOwnProperty(n.ui)&&e[n.ui].hasOwnProperty("variables")&&e[n.ui].variables.length>0,n.uiHasRelationship=void 0!==i.relationship,n.alias=["ALIAS","ONETOMANY","MANYTOMANY"].indexOf(n.type)>-1,n.types=[],n.relationship="";var s=i.options.validate(i.options.toJSON());switch(n.valid=!0,void 0!==s&&(n.valid=!1),i.getRelationshipType()){case"ONETOMANY":n.relationship="⊣",n.relationshipTooltip=i.getRelated();break;case"MANYTOONE":n.relationship="⊢",n.relationshipTooltip=i.getRelated();break;case"MANYTOMANY":n.relationship="⊢⊣",n.relationshipTooltip=i.getRelated()}return _.each(e,function(e){!e.system&&e.dataTypes.indexOf(n.type)>-1&&n.types.push({id:e.id,isActive:e.id===n.ui})}),n.master=t===n.column_name?!0:!1,n});return{rows:i}},afterRender:function(){{var e=this.$el.find("tbody")[0],t=this;new c(e,{animation:150,handle:".sort",draggable:"tr",ghostClass:"sortable-ghost",filter:".system",onStart:function(){var t=jQuery(e);t.addClass("remove-hover-state")},onEnd:function(){var t=jQuery(e);t.removeClass("remove-hover-state")},onUpdate:function(){t.sort()}})}},initialize:function(){this.collection.on("change sync sort",this.render,this)}});t.Layout.extend({template:"modules/settings/module-table-settings",attributes:{"class":"directus-module"},serialize:function(){return{hidden:this.model.get("hidden"),single:this.model.get("single"),is_junction_table:this.model.get("is_junction_table"),footer:this.model.get("footer")}}})}u.Views.Table=n.extend({headerOptions:{route:{title:"Classes",breadcrumbs:[{title:"Settings",anchor:"#settings"},{title:"Tables+Inputs",anchor:"#settings/tables"}]}},leftToolbar:function(){return this.saveWidget=new r.SaveWidget({widgetOptions:{basicSave:!0}}),[this.saveWidget]},events:{"change select,input":function(){this.saveWidget.setSaved(!1)},"click .saved-success":"saveColumns"},saveColumns:function(){var t={};return $("#table-settings").find("input[type=checkbox]:not(:checked)").each(function(){t[this.name]=0}).get(),t=_.extend(t,$("#table-settings").serializeObject()),t.primary_column=$("#table-settings").find("input[type=radio]:checked").attr("data-id"),t.primary_column?void this.model.save(t,{success:function(){e.router.go("settings","tables")}}):void e.router.openModal({type:"alert",text:"Please Select A Primary Column",callback:function(){}})},afterRender:function(){this.setView("#page-content",this.columns),this.collection.fetch()},initialize:function(){this.collection=this.model.columns,this.columns=new g({collection:this.collection}),this.headerOptions.route.title=this.model.id}});var v=t.Layout.extend({template:"modules/settings/settings-tables",addRowView:function(e,t){var i=this.insertView("tbody",new b({model:e}));t!==!1&&i.render()},moveRowView:function(e){var t=this.collection.indexOf(e),i=t-1,n=this.$el.find("tbody"),s=e.id||!1;
if(s){{var o=n.find('[data-id="'+s+'"]'),a=n.find("tr:eq("+i+")");o.index()}0===t?o.prependTo(n):o.insertAfter(a)}},isValidModel:function(t){if("directus_"===t.id.substring(0,9))return!1;var i=e.schemaManager.getPrivileges(t.id);if(void 0===i)return!1;var n=i.get("permissions").split(",");return _.contains(n,"bigview")},beforeRender:function(){this.collection.each(function(e){return this.isValidModel(e)?void this.addRowView(e,!1):!1},this)},initialize:function(){this.listenTo(this.collection,"add",function(e){this.addRowView(e),this.moveRowView(e)})}}),b=t.Layout.extend({template:"modules/settings/settings-tables-rows",tagName:"tr",attributes:function(){return{"data-id":this.model.get("table_name")}},events:{"click td span":function(e){e.stopImmediatePropagation();var t=$(e.target).closest("td").attr("data-attribute");this.toggleTableAttribute(l.getTable($(e.target).closest("tr").attr("data-id")),t,$(e.target))},"click td":function(t){var i=$(t.target).closest("tr").attr("data-id");e.router.go(["settings","tables",i])}},toggleTableAttribute:function(e,t,i){var n={};n[t]=!e.get(t),e.save(n),i.hasClass("add-color")?(i.addClass("delete-color"),i.removeClass("add-color"),i.removeClass("on")):(i.addClass("add-color"),i.removeClass("delete-color"),i.addClass("on"))},serialize:function(){return this.model.toJSON()}});return u.Views.List=n.extend({headerOptions:{route:{title:"Tables+Inputs",breadcrumbs:[{title:"Settings",anchor:"#settings"}]}},leftToolbar:function(){return this.widgets.addWidget||(this.widgets.addWidget=new r.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})),[this.widgets.addWidget]},beforeRender:function(){this.setView("#page-content",new v({collection:this.collection})),n.prototype.beforeRender.call(this)},initialize:function(){this.widgets={}},events:{"click #addBtn":function(){var i=this;e.router.openModal({type:"prompt",text:"Please enter the name of the table you would like to add",callback:function(n){if(n&&!e.schemaManager.getPrivileges(n)){var o=new t.Model;o.url=e.API_URL+"privileges/1",o.set({group_id:1,permissions:"add,edit,bigedit,delete,bigdelete,alter,view,bigview",table_name:n,addTable:!0}),o.save({},{success:function(){var t=new s({id:n,table_name:n},{parse:!0,url:e.API_URL+"tables/"+n});t.fetch({success:function(){i.collection.add(t)}})}})}}})}}}),u}),define("modules/settings/views/GlobalSettingsView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets"],function(e,t,i,n,s){var o=n.extend({headerOptions:{route:{title:"Settings",breadcrumbs:[{title:"Settings",anchor:"#settings"}]}},leftToolbar:function(){return this.saveWidget=new s.SaveWidget({widgetOptions:{basicSave:!0}}),this.saveWidget.setSaved(!0),[this.saveWidget]},events:{"click .saved-success":function(){var t=this.editView.data(),i=function(){e.router.go("settings")};this.model.save(t,{success:i})},"change select":"checkDiff","keyup input, textarea":"checkDiff"},checkDiff:function(){this.saveWidget.setSaved(!1)},beforeRender:function(){this.setView("#page-content",this.editView),n.prototype.beforeRender.call(this)},initialize:function(e){this.editView=new i.EditView({model:this.model,structure:e.structure}),this.headerOptions.route.title=this.options.title}});return o}),define("modules/settings/views/AboutView",["app","backbone","core/BasePageView"],function(e,t,i){var n=i.extend({headerOptions:{route:{title:"About",breadcrumbs:[{title:"Settings",anchor:"#settings"}]}},afterRender:function(){var e=new t.Layout({template:"modules/settings/settings-about"});this.setView("#page-content",e),e.render()}});return n}),define("modules/settings/views/PermissionsView",["app","backbone","core/widgets/widgets","core/BasePageView"],function(e,t,i,n){var s=t.Layout.extend({template:"modules/settings/settings-groups",events:{"click button[data-action=new-group]":"newGroup"},newGroup:function(){},serialize:function(){return{rows:this.collection.toJSON()}},addRowView:function(e,t){var i=this.insertView("tbody",new o({model:e}));t!==!1&&i.render()},beforeRender:function(){this.collection.each(function(e){this.addRowView(e,!1)},this)},initialize:function(){this.listenTo(this.collection,"add",this.addRowView)}}),o=t.Layout.extend({template:"modules/settings/settings-groups-rows",tagName:"tr",events:{"click td":function(t){var i=t.target.getAttribute("data-id");e.router.go(["settings","permissions",i])}},serialize:function(){return this.model.toJSON()}}),a=n.extend({headerOptions:{route:{title:"Permissions",breadcrumbs:[{title:"Settings",anchor:"#settings"}]}},leftToolbar:function(){return[new i.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})]},events:{"click #addBtn":function(){var i=this;e.router.openModal({type:"prompt",text:"Please Enter the name of the Group you would like to add.",callback:function(n){if(n&&!e.schemaManager.getPrivileges("directus_permission")){var s=new t.Model;s.url=e.API_URL+"groups",s.set({name:n}),s.save({},{success:function(e){console.log(e),e.fetch({success:function(){i.collection.add(e)}})}})}}})}},beforeRender:function(){this.setView("#page-content",new s({collection:this.collection})),n.prototype.beforeRender.call(this)},afterRender:function(){}});return a}),define("modules/settings/views/SystemView",["app","backbone","core/BasePageView"],function(e,t,i){var n=i.extend({headerOptions:{route:{title:"System",breadcrumbs:[{title:"Settings",anchor:"#settings"}]}},afterRender:function(){var e=new t.Layout({template:"modules/settings/settings-system"});this.setView("#page-content",e),e.render()}});return n}),define("modules/settings/views/GroupPermissionsView",["app","backbone","core/BasePageView","core/widgets/widgets"],function(e,t,i){var n={};n.Collection=t.Collection.extend({getExpandedPermissions:function(){}});var s=i.extend({headerOptions:{route:{title:"Edit Fields",isOverlay:!0}},events:{"click #removeOverlay":function(){e.router.removeOverlayPage(this)}},afterRender:function(){this.setView("#page-content",this.contentView)},initialize:function(){this.contentView=new o({model:this.model})}}),o=t.Layout.extend({template:"modules/settings/settings-grouppermissions-editfield",events:{"click td > span":function(e){var t=$(e.target),i=t.closest("tr"),n=this.model.get("read_field_blacklist")?this.model.get("read_field_blacklist").split(","):[],s=this.model.get("write_field_blacklist")?this.model.get("write_field_blacklist").split(","):[];t.hasClass("on")?(t.removeClass("on").removeClass("has-privilege"),"read"==t.parent().data("value")?-1===n.indexOf(i.data("column-name"))&&(n.push(i.data("column-name")),this.model.set({read_field_blacklist:n.join(",")})):-1===s.indexOf(i.data("column-name"))&&(s.push(i.data("column-name")),this.model.set({write_field_blacklist:s.join(",")}))):(t.addClass("on").addClass("has-privilege"),"read"==t.parent().data("value")?-1!==n.indexOf(i.data("column-name"))&&(n.splice(n.indexOf(i.data("column-name")),1),this.model.set({read_field_blacklist:n.join(",")})):-1!==s.indexOf(i.data("column-name"))&&(s.splice(s.indexOf(i.data("column-name")),1),this.model.set({write_field_blacklist:s.join(",")}))),this.model.save()}},serialize:function(){var t={columns:[]},i=(this.model.get("read_field_blacklist")||"").split(","),n=(this.model.get("write_field_blacklist")||"").split(",");return t.columns=e.schemaManager.getColumns("tables",this.model.get("table_name")).filter(function(e){return"id"===e.id?!1:!0}).map(function(e){return{column_name:e.id,read:-1==i.indexOf(e.id),write:-1==n.indexOf(e.id)}},this),t},initialize:function(){this.render()}});n.Permissions=i.extend({headerOptions:{route:{title:"Settings"}},template:"modules/settings/settings-grouppermissions",events:{"click td.tableName > div":"toggleRowPermissions","click td.editFields > span":"editFields","click td > span":function(e){var t,i,n,s=$(e.target).parent(),o=s.closest("tr");if(!s.hasClass("editFields")){if(t=o.data("cid"),n=this.collection.get(t),"all"==this.selectedState&&this.collection.where({table_name:n.get("table_name"),group_id:n.get("group_id")}).length>1){var a=[],r=[];return s.hasClass("big-priv")?(a.push(s.parent().data("value")),a.push("big"+s.parent().data("value"))):s.hasClass("has-privilege")?(r.push("big"+s.parent().data("value")),a.push(s.parent().data("value"))):(a.push("big"+s.parent().data("value")),r.push(s.parent().data("value"))),void this.collection.each(function(e){if(e.get("table_name")==n.get("table_name")&&e.get("group_id")==n.get("group_id")){var t=e.get("permissions").split(",");t=_.difference(t,a),t=_.union(t,r),t=_.compact(t),e.set("permissions",t.join(",")),e.save()}})}this.toggleIcon(s,this.collection.get(t).get("permissions")),i=this.parseTablePermissions(o,this.collection.get(t).get("permissions"));var l=!1,c=n;"all"!=this.selectedState&&n.get("status_id")!=this.selectedState&&(n=n.clone(),this.model=n,n.collection=c.collection,l=!0),n.set(i);var u=this;n.save({activeState:this.selectedState},{success:function(){l&&u.collection.add(u.model)}})}}},toggleIcon:function(e){var t=e.parent().data("value");e.hasClass("yellow-color")?e.addClass("big-priv"):e.hasClass("big-priv")&&"delete"==t?e.removeClass("big-priv").addClass("hard-priv hard-color"):e.hasClass("hard-priv")&&"delete"==t?e.removeClass("hard-priv").addClass("big-hard-priv hard-color"):e.toggleClass("add-color").toggleClass("delete-color").toggleClass("has-privilege")},toggleRowPermissions:function(e){var t=$(e.target).parent(),i=t.closest("tr"),n=i.data("cid"),s=this.collection.get(n),o=!0;["add","bigedit","bigdelete","bigview"].forEach(function(e){-1==s.get("permissions").indexOf(e)&&(o=!1)});var a="";if(o||(a="add,bigedit,bigdelete,bigview"),"all"==this.selectedState&&this.collection.where({table_name:s.get("table_name"),group_id:s.get("group_id")}).length>1)return void this.collection.each(function(e){e.get("table_name")==s.get("table_name")&&e.get("group_id")==s.get("group_id")&&(e.set({permissions:a}),e.save())});var r=!1,l=s;"all"!=this.selectedState&&s.get("status_id")!=this.selectedState&&(s=s.clone(),this.model=s,s.collection=l.collection,r=!0),s.set({permissions:a});var c=this;s.save({activeState:this.selectedState},{success:function(){r&&c.collection.add(c.model)}})},parseTablePermissions:function(t){var i;return i=t.children().has("span.has-privilege"),i=i.map(function(){var e="",t=[];if($(this).has("span.big-priv").length?e="big":$(this).has("span.hard-priv").length?e="hard":$(this).has("span.big-hard-priv").length&&(e="bighard"),e&&"hard"!==e){var i=$(this).data("value");"bighard"===e&&(i="hard"+i),t.push(i)}return t.push(e+$(this).data("value")),t}).get(),1===e.getCurrentGroup().get("id")&&i.push("alter"),{permissions:i.join()}},editFields:function(t){var i,n,o=$(t.target).parent(),a=o.closest("tr");i=a.data("cid");var n=this.collection.get(i),r=new s({model:n});e.router.overlayPage(r)},updatePermissionList:function(e){this.selectedState=e,this.render()},serialize:function(){var t=this.collection,i=this;t=t.filter(function(t){if("all"!=i.selectedState){var n=e.schemaManager.getColumns("tables",t.get("table_name"));return n&&(n=n.find(function(t){return t.id==e.statusMapping.status_name}))?!0:!1}return!0});var n={};t.forEach(function(e){n[e.get("table_name")]||(n[e.get("table_name")]={count:0}),e.get("status_id")?n[e.get("table_name")][e.get("status_id")]=e:n[e.get("table_name")][i.selectedState]=e,n[e.get("table_name")][i.selectedState]||(n[e.get("table_name")][i.selectedState]=e),n[e.get("table_name")].count++}),t=[];for(var s in n)t.push(n[s][this.selectedState]);var o=[];return t.forEach(function(t){var s,a;if(a=t.toJSON(),a.cid=t.cid,a.title=e.capitalize(a.table_name,"_",!0),s=(t.get("permissions")||"").split(","),a.hasReadBlacklist=!1,a.hasWriteBlacklist=!1,a.permissions={add:!1,edit:!1,bigedit:!1,"delete":!1,bigdelete:!1,harddelete:!1,bigharddelete:!1,alter:!1,view:!1,bigview:!1},_.each(s,function(e){a.permissions.hasOwnProperty(e)&&(a.permissions[e]=!0)}),"all"==i.selectedState&&n[a.table_name].count>1){var r=!0,l=a.permissions.bigview?2:a.permissions.view?1:0,c=!0,u=a.permissions.add,d=!0,h=a.permissions.bigedit?2:a.permissions.edit?1:0,p=!0,f=a.permissions.bigdelete?2:a.permissions.delete?1:0;for(var m in n[a.table_name])if("all"!=m&&"count"!=m){var s=n[a.table_name][m].get("permissions").split(",");c&&(c=s.indexOf("add")>-1==u),r&&(s.indexOf("bigview")>-1?2!=l&&(r=!1):s.indexOf("view")>-1?1!=l&&(r=!1):0!=l&&(r=!1)),d&&(s.indexOf("bigedit")>-1?2!=h&&(d=!1):s.indexOf("edit")>-1?1!=h&&(d=!1):0!=h&&(d=!1)),p&&(s.indexOf("bigdelete")>-1?2!=f&&(p=!1):s.indexOf("delete")>-1?1!=f&&(p=!1):0!=f&&(r=!1))}a.permissions.addValConsistent=!c,a.permissions.viewValConsistent=!r,a.permissions.editValConsistent=!d,a.permissions.deleteValConsistent=!p}o.push(a)}),{tables:o}},initialize:function(){this.selectedState="all",this.collection.on("sync",this.render,this)}});var a=t.Layout.extend({template:Handlebars.compile('    <div class="simple-select dark-grey-color simple-gray right">       <span class="icon icon-triangle-down"></span>       <select id="statusSelect" name="status" class="change-visibility">         <optgroup label="Status">           <option data-status value="all">All States</option>           {{#mapping}}             <option data-status value="{{id}}">View {{capitalize name}}</option>           {{/mapping}}         </optgroup>       </select>     </div>'),tagName:"div",attributes:{"class":"tool"},events:{"change #statusSelect":function(e){var t=$(e.target).find(":selected");void 0!==t.attr("data-status")&&t.attr("data-status")!==!1&&this.baseView.updatePermissionList($(e.target).val())}},serialize:function(){var t={mapping:[]},i=e.statusMapping.mapping;for(var n in i)n!=e.statusMapping.deleted_num&&t.mapping.push({id:n,name:i[n].name});return t},afterRender:function(){},initialize:function(e){this.baseView=e.baseView}});return n.Page=i.extend({headerOptions:{route:{title:"Settings",breadcrumbs:[{title:"Settings",anchor:"#settings"},{title:"Permissions",anchor:"#settings/permissions"}]}},rightToolbar:function(){return this.statusSelect=new a({baseView:this.view}),[this.statusSelect]},afterRender:function(){this.setView("#page-content",this.view),this.collection.fetch()},initialize:function(){this.headerOptions.route.title=this.options.title,this.view=new n.Permissions({collection:this.collection})}}),n}),define("modules/settings/settings",["app","backbone","core/directus","core/BasePageView","modules/settings/views/TablesView","modules/settings/views/GlobalSettingsView","modules/settings/views/AboutView","modules/settings/views/PermissionsView","modules/settings/views/SystemView","modules/settings/views/GroupPermissionsView"],function(e,t,i,n,s,o,a,r,l,c){var u=e.module();return u.Global=o,u.System=l,u.Table=s.Views.Table,u.Tables=s.Views.List,u.Permissions=r,u.GroupPermissions=c,u.About=a,u.Main=n.extend({headerOptions:{route:{title:"Settings"}},template:"modules/settings/settings"}),u}),define("modules/users/views/EditUserView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets"],function(e,t,i,n,s){return n.extend({headerOptions:{route:{title:"Edit User",breadcrumbs:[{title:"Users",anchor:"#users"}]}},events:{"click .saved-success":"save","change #saveSelect":"save"},save:function(i){var n="save-form-leave";void 0!==i.target.options&&(n=$(i.target.options[i.target.selectedIndex]).val());var s,o=$("form").serializeObject(),a=this.model,r=this.model.isNew(),l=this.model.collection;if(s="save-form-stay"===n?function(i){var n=t.history.fragment.split("/");n.pop(),n.push(i.get("id")),e.router.go(n)}:function(){console.log("Success");var i=t.history.fragment.split("/");i.pop(),"save-form-add"===n&&(r&&e.router.navigate("#",{trigger:!1,replace:!0}),i.push("new")),e.router.go(i)},"save-form-copy"===n){console.log("cloning...");var c=a.toJSON();delete c.id,a=new l.model(c,{collection:l,parse:!0}),l.add(a)}a.save(a.diff(o),{success:s,error:function(){console.log("err")},wait:!0,patch:!0,includeRelationships:!0})},leftToolbar:function(){return this.saveWidget=new s.SaveWidget({widgetOptions:{basicSave:this.headerOptions.basicSave}}),this.saveWidget.setSaved(!1),[this.saveWidget]},afterRender:function(){var e=new i.EditView({model:this.model});this.setView("#page-content",e),this.model.isNew()?e.render():this.model.fetch()},initialize:function(){this.headerOptions.route.title=this.model.id?this.model.get("first_name")+" "+this.model.get("last_name"):"New User"}})}),define("modules/users/views/ListUsers",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets","moment"],function(e,t,i,n,s,o){var a=t.Layout.extend({tagName:"span",events:{"click .header-image":function(t){var i=$(t.target).closest("li.card").attr("data-id"),n=e.users.getCurrentUser(),s=n.get("group");(parseInt(i,10)===n.id||1===s.id)&&e.router.go("#users",i)}},template:Handlebars.compile('{{#groups}}<div class="section-header"><span class="big-label-text">{{title}}</div><ul class="cards row">{{#rows}}<li class="card col-2 gutter-bottom {{#if online}}active{{/if}}" data-id="{{id}}" data-cid="{{cid}}"><div class="header-image add-color-border">{{avatar}} <div class="tool-item large-circle"><span class="icon icon-pencil"></span></div></div><div class="info"><div class="featured"><div class="primary-info"><div>{{first_name}}</div><div>{{last_name}}</div></div><div title="{{position}}" class="secondary-info ellipsis">{{#if position}}{{position}}{{else}}<span class="secondary-info">--</span>{{/if}}</div></div><ul class="extra"><li title="{{location}}">{{#if location}}{{location}}{{else}}<span class="secondary-info">--</span>{{/if}}<span class="icon icon-home"></span></li><li title="{{phone}}">{{#if phone}}{{phone}}{{else}}<span class="secondary-info">--</span>{{/if}}<span class="icon icon-phone"></span></li><li title="{{email}}">{{#if email}}<a href="mailto:{{email}}">{{email}}</a>{{else}}<span class="secondary-info">--</span>{{/if}}<span class="icon icon-mail"></span></li></ul></div></li>{{/rows}}</ul>{{/groups}}'),serialize:function(){var e=this.collection.map(function(e){var t={id:e.get("id"),cid:e.cid,avatar:e.getAvatar(),avatar_file_id:e.get("avatar_file_id"),avatar_is_file:e.get("avatar_is_file"),first_name:e.get("first_name"),last_name:e.get("last_name"),email:e.get("email"),position:e.get("position"),location:e.get("location"),phone:e.get("phone"),online:o(e.get("last_access")).add("m",5)>o(),group_id:e.get("group").id,group_name:e.get("group").get("name")},i=e.getAvatar();return t.avatar=new Handlebars.SafeString('<img src="'+i+'" style="width:200px;height:200px"/>'),t});_(e).sortBy("first_name");var t=[];e.forEach(function(e){t["group_"+e.group_id]||(t["group_"+e.group_id]={title:e.group_name,rows:[]}),t["group_"+e.group_id].rows.push(e)});var i=[];for(var n in t)i.push(t[n]);return{groups:i}},initialize:function(){this.collection.on("sort",this.render,this)}}),r=t.Layout.extend({tagName:"tbody",template:Handlebars.compile('{{#rows}}<tr data-id="{{id}}" data-cid="{{cid}}"><td>{{avatar}}</td><td>{{first_name}}</td><td>{{last_name}}</td><td>{{email}}</td><td>{{position}}</td><td>{{last_access}}</td></tr>{{/rows}}'),serialize:function(){var e=this.collection.map(function(e){var t={id:e.get("id"),cid:e.cid,avatar:e.getAvatar(),first_name:e.get("first_name"),last_name:e.get("last_name"),email:e.get("email"),position:e.get("position"),last_access:e.get("last_access")};if(null!==t.avatar){var i=t.avatar.replace("?s=100","?s=50");t.avatar=new Handlebars.SafeString('<img src="'+i+'" style="max-width:none!important;"/>')}return t});return{rows:e}},initialize:function(){this.collection.on("sort",this.render,this)}}),l=i.Table.extend({TableBody:r,navigate:function(t){var i=e.users.getCurrentUser(),n=i.get("group");(parseInt(t,10)===i.id||1===n.id)&&e.router.go("#users",t)}}),c=n.extend({headerOptions:{route:{title:"Users"}},leftToolbar:function(){return 1==e.users.getCurrentUser().get("group").id?[new s.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})]:[]},rightToolbar:function(){return[]},leftSecondaryToolbar:function(){return this.widgets.visibilityWidget||(this.widgets.visibilityWidget=new s.VisibilityWidget({collection:this.collection,basePage:this})),this.widgets.filterWidget||(this.widgets.filterWidget=new s.FilterWidget({collection:this.collection,basePage:this})),[this.widgets.visibilityWidget,this.widgets.filterWidget]},events:{"click #addBtn":function(){e.router.go("#users","new")},"click #gridBtn":function(){this.viewList&&(this.viewList=!1,$("#listBtn").parent().removeClass("active"),$("#gridBtn").parent().addClass("active"),this.table=new a({collection:this.collection}),this.render())},"click #listBtn":function(){this.viewList||(this.viewList=!0,$("#listBtn").parent().addClass("active"),$("#gridBtn").parent().removeClass("active"),this.table=new l({collection:this.collection,selectable:!1}),this.render())}},afterRender:function(){this.setView("#page-content",this.table),this.collection.fetch()},initialize:function(){this.viewList=!1,this.table=new a({collection:this.collection}),this.widgets=[]}});return c}),define("modules/users/users",["app","modules/users/views/EditUserView","modules/users/views/ListUsers"],function(e,t,i){var n=e.module();return n.Views.Edit=t,n.Views.List=i,n}),define("modules/messages/views/ListMessagesView",["app","backbone","core/BasePageView","core/widgets/widgets","moment"],function(e,t,i,n,s){var o=t.Layout.extend({template:"modules/messages/messages-list",events:{"click .message":function(t){var i=$(t.target).closest(".message").attr("data-id");e.router.go("#messages",i)}},serialize:function(){var t=this.collection.map(function(t){var i=t.toJSON(),n=s(i.date_updated+" UTC");if(i.timestamp=parseInt(n.format("X"),10),i.niceDate=s().diff(n,"days")>1?n.format("MMMM D"):n.fromNow(),i.read=0===t.getUnreadCount(),i.responsesLength=i.responses.length,i.from=parseInt(i.from,10),i.recipients)var o=i.recipients.split(",");else var o=[];i.recipients=[];for(var a=0,r=0;r<o.length;r++){if(r>2){a=o.length-r;break}var l=e.users.get(o[r]);void 0!==l&&i.recipients.push(l.get("first_name"))}return i.recipients=i.recipients.join(", "),a&&(i.recipients+=" (+"+a+" more)"),i});return t=_.sortBy(t,function(e){return-e.timestamp}),{messages:t}},initialize:function(){this.collection.on("sync",this.render,this)}});return i.extend({headerOptions:{route:{title:"Messages"}},leftToolbar:function(){return[new n.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-plus",buttonClass:"add-color-background"}})]},rightToolbar:function(){return[]},events:{"click #addBtn":function(){e.router.go("#messages","new")}},serialize:function(){return{title:"Messages",buttonTitle:"Compose"}},beforeRender:function(){var e=new o({collection:this.collection});this.setView("#page-content",e),i.prototype.beforeRender.call(this)}})}),"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t});var t={init:function(e){return this.options=$.extend({},$.noty.defaults,e),this.options.layout=this.options.custom?$.noty.layouts.inline:$.noty.layouts[this.options.layout],$.noty.themes[this.options.theme]?this.options.theme=$.noty.themes[this.options.theme]:e.themeClassName=this.options.theme,delete e.layout,delete e.theme,this.options=$.extend({},this.options,this.options.layout.options),this.options.id="noty_"+(new Date).getTime()*Math.floor(1e6*Math.random()),this.options=$.extend({},this.options,e),this._build(),this},_build:function(){var e=$('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);if(e.append(this.options.template).find(".noty_text").html(this.options.text),this.$bar=null!==this.options.layout.parent.object?$(this.options.layout.parent.object).css(this.options.layout.parent.css).append(e):e,this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type),this.options.buttons){this.options.closeWith=[],this.options.timeout=!1;var t=$("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(t):this.$bar.append(t);var i=this;$.each(this.options.buttons,function(e,t){var n=$("<button/>").addClass(t.addClass?t.addClass:"gray").html(t.text).attr("id",t.id?t.id:"button-"+e).appendTo(i.$bar.find(".noty_buttons")).on("click",function(){$.isFunction(t.onClick)&&t.onClick.call(n,i)})})}this.$message=this.$bar.find(".noty_message"),this.$closeButton=this.$bar.find(".noty_close"),this.$buttons=this.$bar.find(".noty_buttons"),$.noty.store[this.options.id]=this},show:function(){var e=this;return e.options.custom?e.options.custom.find(e.options.layout.container.selector).append(e.$bar):$(e.options.layout.container.selector).append(e.$bar),e.options.theme&&e.options.theme.style&&e.options.theme.style.apply(e),"function"===$.type(e.options.layout.css)?this.options.layout.css.apply(e.$bar):e.$bar.css(this.options.layout.css||{}),e.$bar.addClass(e.options.layout.addClass),e.options.layout.container.style.apply($(e.options.layout.container.selector)),e.showing=!0,e.options.theme&&e.options.theme.style&&e.options.theme.callback.onShow.apply(this),$.inArray("click",e.options.closeWith)>-1&&e.$bar.css("cursor","pointer").one("click",function(t){e.stopPropagation(t),e.options.callback.onCloseClick&&e.options.callback.onCloseClick.apply(e),e.close()}),$.inArray("hover",e.options.closeWith)>-1&&e.$bar.one("mouseenter",function(){e.close()}),$.inArray("button",e.options.closeWith)>-1&&e.$closeButton.one("click",function(t){e.stopPropagation(t),e.close()}),-1==$.inArray("button",e.options.closeWith)&&e.$closeButton.remove(),e.options.callback.onShow&&e.options.callback.onShow.apply(e),"string"==typeof e.options.animation.open?(e.$bar.css("height",e.$bar.innerHeight()),e.$bar.show().addClass(e.options.animation.open).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0})):e.$bar.animate(e.options.animation.open,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0}),e.options.timeout&&e.$bar.delay(e.options.timeout).promise().done(function(){e.close()}),this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var e=this;if(this.showing)return void e.$bar.queue(function(){e.close.apply(e)});if(this.$bar.dequeue(),!this.shown&&!this.showing){var t=[];return $.each($.noty.queue,function(i,n){n.options.id!=e.options.id&&t.push(n)}),void($.noty.queue=t)}e.$bar.addClass("i-am-closing-now"),e.options.callback.onClose&&e.options.callback.onClose.apply(e),"string"==typeof e.options.animation.close?e.$bar.addClass(e.options.animation.close).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e),e.closeCleanUp()}):e.$bar.clearQueue().stop().animate(e.options.animation.close,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e)}).promise().done(function(){e.closeCleanUp()})}},closeCleanUp:function(){var e=this;e.options.modal&&($.notyRenderer.setModalCount(-1),0==$.notyRenderer.getModalCount()&&$(".noty_modal").fadeOut("fast",function(){$(this).remove()})),$.notyRenderer.setLayoutCountFor(e,-1),0==$.notyRenderer.getLayoutCountFor(e)&&$(e.options.layout.container.selector).remove(),"undefined"!=typeof e.$bar&&null!==e.$bar&&("string"==typeof e.options.animation.close?(e.$bar.css("transition","all 100ms ease").css("border",0).css("margin",0).height(0),e.$bar.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.$bar.remove(),e.$bar=null,e.closed=!0,e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e)})):(e.$bar.remove(),e.$bar=null,e.closed=!0)),delete $.noty.store[e.options.id],e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e),e.options.dismissQueue||($.noty.ontap=!0,$.notyRenderer.render()),e.options.maxVisible>0&&e.options.dismissQueue&&$.notyRenderer.render()},setText:function(e){return this.closed||(this.options.text=e,this.$bar.find(".noty_text").html(e)),this},setType:function(e){return this.closed||(this.options.type=e,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this)),this},setTimeout:function(e){if(!this.closed){var t=this;this.options.timeout=e,t.$bar.delay(t.options.timeout).promise().done(function(){t.close()})}return this},stopPropagation:function(e){e=e||window.event,"undefined"!=typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},closed:!1,showing:!1,shown:!1};$.notyRenderer={},$.notyRenderer.init=function(e){var i=Object.create(t).init(e);return i.options.killer&&$.noty.closeAll(),i.options.force?$.noty.queue.unshift(i):$.noty.queue.push(i),$.notyRenderer.render(),"object"==$.noty.returns?i:i.options.id},$.notyRenderer.render=function(){var e=$.noty.queue[0];"object"===$.type(e)?e.options.dismissQueue?e.options.maxVisible>0?$(e.options.layout.container.selector+" li").length<e.options.maxVisible&&$.notyRenderer.show($.noty.queue.shift()):$.notyRenderer.show($.noty.queue.shift()):$.noty.ontap&&($.notyRenderer.show($.noty.queue.shift()),$.noty.ontap=!1):$.noty.ontap=!0},$.notyRenderer.show=function(e){e.options.modal&&($.notyRenderer.createModalFor(e),$.notyRenderer.setModalCount(1)),e.options.custom?0==e.options.custom.find(e.options.layout.container.selector).length?e.options.custom.append($(e.options.layout.container.object).addClass("i-am-new")):e.options.custom.find(e.options.layout.container.selector).removeClass("i-am-new"):0==$(e.options.layout.container.selector).length?$("body").append($(e.options.layout.container.object).addClass("i-am-new")):$(e.options.layout.container.selector).removeClass("i-am-new"),$.notyRenderer.setLayoutCountFor(e,1),e.show()},$.notyRenderer.createModalFor=function(e){if(0==$(".noty_modal").length){var t=$("<div/>").addClass("noty_modal").addClass(e.options.theme).data("noty_modal_count",0);e.options.theme.modal&&e.options.theme.modal.css&&t.css(e.options.theme.modal.css),t.prependTo($("body")).fadeIn("fast"),$.inArray("backdrop",e.options.closeWith)>-1&&t.on("click",function(){$.noty.closeAll()})}},$.notyRenderer.getLayoutCountFor=function(e){return $(e.options.layout.container.selector).data("noty_layout_count")||0},$.notyRenderer.setLayoutCountFor=function(e,t){return $(e.options.layout.container.selector).data("noty_layout_count",$.notyRenderer.getLayoutCountFor(e)+t)},$.notyRenderer.getModalCount=function(){return $(".noty_modal").data("noty_modal_count")||0},$.notyRenderer.setModalCount=function(e){return $(".noty_modal").data("noty_modal_count",$.notyRenderer.getModalCount()+e)},$.fn.noty=function(e){return e.custom=$(this),$.notyRenderer.init(e)},$.noty={},$.noty.queue=[],$.noty.ontap=!0,$.noty.layouts={},$.noty.themes={},$.noty.returns="object",$.noty.store={},$.noty.get=function(e){return $.noty.store.hasOwnProperty(e)?$.noty.store[e]:!1},$.noty.close=function(e){return $.noty.get(e)?$.noty.get(e).close():!1},$.noty.setText=function(e,t){return $.noty.get(e)?$.noty.get(e).setText(t):!1},$.noty.setType=function(e,t){return $.noty.get(e)?$.noty.get(e).setType(t):!1},$.noty.clearQueue=function(){$.noty.queue=[]},$.noty.closeAll=function(){$.noty.clearQueue(),$.each($.noty.store,function(e,t){t.close()})};var i=window.alert;$.noty.consumeAlert=function(e){window.alert=function(t){e?e.text=t:e={text:t},$.notyRenderer.init(e)}},$.noty.stopConsumeAlert=function(){window.alert=i},$.noty.defaults={layout:"bottomRight",theme:"directus",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1},$(window).on("resize",function(){$.each($.noty.layouts,function(e,t){t.container.style.apply($(t.container.selector))
})}),window.noty=function(e){return jQuery.notyRenderer.init(e)},$.noty.layouts.bottom={name:"bottom",options:{},container:{object:'<ul id="noty_bottom_layout_container" />',selector:"ul#noty_bottom_layout_container",style:function(){$(this).css({bottom:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},$.noty.layouts.bottomCenter={name:"bottomCenter",options:{},container:{object:'<ul id="noty_bottomCenter_layout_container" />',selector:"ul#noty_bottomCenter_layout_container",style:function(){$(this).css({bottom:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),$(this).css({left:($(window).width()-$(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.bottomLeft={name:"bottomLeft",options:{},container:{object:'<ul id="noty_bottomLeft_layout_container" />',selector:"ul#noty_bottomLeft_layout_container",style:function(){$(this).css({bottom:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&$(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.bottomRight={name:"bottomRight",options:{},container:{object:'<ul id="noty_bottomRight_layout_container" />',selector:"ul#noty_bottomRight_layout_container",style:function(){$(this).css({bottom:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&$(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.center={name:"center",options:{},container:{object:'<ul id="noty_center_layout_container" />',selector:"ul#noty_center_layout_container",style:function(){$(this).css({position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=$(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");$("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var t=e.height();e.remove(),$(this).hasClass("i-am-new")?$(this).css({left:($(window).width()-$(this).outerWidth(!1))/2+"px",top:($(window).height()-t)/2+"px"}):$(this).animate({left:($(window).width()-$(this).outerWidth(!1))/2+"px",top:($(window).height()-t)/2+"px"},500)}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.centerLeft={name:"centerLeft",options:{},container:{object:'<ul id="noty_centerLeft_layout_container" />',selector:"ul#noty_centerLeft_layout_container",style:function(){$(this).css({left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=$(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");$("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var t=e.height();e.remove(),$(this).hasClass("i-am-new")?$(this).css({top:($(window).height()-t)/2+"px"}):$(this).animate({top:($(window).height()-t)/2+"px"},500),window.innerWidth<600&&$(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.centerRight={name:"centerRight",options:{},container:{object:'<ul id="noty_centerRight_layout_container" />',selector:"ul#noty_centerRight_layout_container",style:function(){$(this).css({right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=$(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");$("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var t=e.height();e.remove(),$(this).hasClass("i-am-new")?$(this).css({top:($(window).height()-t)/2+"px"}):$(this).animate({top:($(window).height()-t)/2+"px"},500),window.innerWidth<600&&$(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.inline={name:"inline",options:{},container:{object:'<ul class="noty_inline_layout_container" />',selector:"ul.noty_inline_layout_container",style:function(){$(this).css({width:"100%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},$.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){$(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},$.noty.layouts.topCenter={name:"topCenter",options:{},container:{object:'<ul id="noty_topCenter_layout_container" />',selector:"ul#noty_topCenter_layout_container",style:function(){$(this).css({top:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),$(this).css({left:($(window).width()-$(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.topLeft={name:"topLeft",options:{},container:{object:'<ul id="noty_topLeft_layout_container" />',selector:"ul#noty_topLeft_layout_container",style:function(){$(this).css({top:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&$(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.layouts.topRight={name:"topRight",options:{},container:{object:'<ul id="noty_topRight_layout_container" />',selector:"ul#noty_topRight_layout_container",style:function(){$(this).css({top:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&$(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.themes.bootstrapTheme={name:"bootstrapTheme",modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){var e=this.options.layout.container.selector;switch($(e).addClass("list-group"),this.$closeButton.append('<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>'),this.$closeButton.addClass("close"),this.$bar.addClass("list-group-item").css("padding","0px"),this.options.type){case"alert":case"notification":this.$bar.addClass("list-group-item-info");break;case"warning":this.$bar.addClass("list-group-item-warning");break;case"error":this.$bar.addClass("list-group-item-danger");break;case"information":this.$bar.addClass("list-group-item-info");break;case"success":this.$bar.addClass("list-group-item-success")}this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"})},callback:{onShow:function(){},onClose:function(){}}},$.noty.themes.defaultTheme={name:"defaultTheme",helpers:{borderFix:function(){if(this.options.dismissQueue){var e=this.options.layout.container.selector+" "+this.options.layout.parent.selector;switch(this.options.layout.name){case"top":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).last().css({borderRadius:"0px 0px 5px 5px"});break;case"topCenter":case"topLeft":case"topRight":case"bottomCenter":case"bottomLeft":case"bottomRight":case"center":case"centerLeft":case"centerRight":case"inline":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).first().css({"border-top-left-radius":"5px","border-top-right-radius":"5px"}),$(e).last().css({"border-bottom-left-radius":"5px","border-bottom-right-radius":"5px"});break;case"bottom":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).first().css({borderRadius:"5px 5px 0px 0px"})}}}},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",background:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAoCAQAAAClM0ndAAAAhklEQVR4AdXO0QrCMBBE0bttkk38/w8WRERpdyjzVOc+HxhIHqJGMQcFFkpYRQotLLSw0IJ5aBdovruMYDA/kT8plF9ZKLFQcgF18hDj1SbQOMlCA4kao0iiXmah7qBWPdxpohsgVZyj7e5I9KcID+EhiDI5gxBYKLBQYKHAQoGFAoEks/YEGHYKB7hFxf0AAAAASUVORK5CYII=') repeat-x scroll left top #fff"}),this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){$(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){$(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderRadius:"0px 0px 5px 5px",borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderRadius:"5px 5px 0px 0px",borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"red",borderColor:"darkred",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#57B7E2",borderColor:"#0B90C4",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"lightgreen",borderColor:"#50C24E",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){$.noty.themes.defaultTheme.helpers.borderFix.apply(this)},onClose:function(){$.noty.themes.defaultTheme.helpers.borderFix.apply(this)}}},$.noty.themes.relax={name:"relax",helpers:{},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",margin:"4px 0",borderRadius:"2px"}),this.$message.css({fontSize:"14px",lineHeight:"16px",textAlign:"center",padding:"10px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){$(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){$(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderTop:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderBottom:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#dedede",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"#FF8181",borderColor:"#e25353",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#78C5E7",borderColor:"#3badd6",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"#BCF5BC",borderColor:"#7cdd77",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){},onClose:function(){}}},define("noty",["jquery"],function(){}),define("modules/messages/views/NewMessageView",["app","backbone","core/directus","core/BasePageView","core/widgets/widgets","noty"],function(e,t,i,n,s){return n.extend({headerOptions:{route:{title:"Compose",breadcrumbs:[{title:"Messages",anchor:"#messages"}]}},leftToolbar:function(){return[new s.ButtonWidget({widgetOptions:{buttonId:"addBtn",iconClass:"icon-paper-plane",buttonClass:"add-color-background"}})]},events:{"click #addBtn":function(){var t=this.editView.data();t.read="1",t.date_updated=new Date,this.model.save(t,{success:function(t,i){i.warning&&noty({text:i.warning,type:"warning",timeout:5e3,theme:"directus"}),e.router.go("#messages")}}),this.model.collection.add(this.model)}},afterRender:function(){this.editView=new i.EditView({model:this.model}),this.setView("#page-content",this.editView),this.editView.render()}})}),define("modules/messages/views/ReadMessageView",["app","backbone","core/BasePageView"],function(e,t,i){var n=t.Layout.extend({maxRecipients:10,template:"modules/messages/messages-reading",events:{"click #messages-response-button":function(){{var t=this.model.get("responses"),i=t.model;e.users.getCurrentUser().get("id")}if(""!==$("#messages-response").val()){var n=_.map(this.model.get("recipients").split(","),function(e){return"0_"+e});n.push("0_"+this.model.get("from"));var s={from:e.users.getCurrentUser().get("id"),subject:"RE: "+this.model.get("subject"),recipients:n.join(","),datetime:(new Date).toISOString(),response_to:this.model.id,message:$("#messages-response").val(),responses:[]},o=new i(s,{collection:t,parse:!0,url:e.API_URL+"messages/rows/"});o.save(),t.add(o),this.render()}},"click #messages-show-recipients":function(){var e=$("#messages-recipients");e.toggle()}},serialize:function(){var t=this.model.toJSON();t.datetime+=" UTC",t.recipients=t.recipients.split(","),t.recipientsCount=t.recipients.length,t.collapseRecipients=t.recipients.length>this.maxRecipients,t.current_user=e.authenticatedUserId,_.each(t.responses,function(e){e.datetime+=" UTC"}),t.responses=t.responses.reverse();for(var i=t.message,n=0;;){if(i){var s=i.indexOf("@[");if(-1!==s){var o=i.substring(s).indexOf(" ");if(-1!==o){var a=i.substring(s+2,o+s),r=/^[0-9]|_+$/.test(a);if(r){var l=i.indexOf("]");if(-1!==l){var c=i.substring(o+1+s,l),u=t.message;t.message=u.substring(0,s+n)+'<span class="mention-tag">'+c+"</span>";var d=t.message.length;t.message+=u.substring(l+n+1),i=u.substring(l+n+1),n=d;continue}}}}}break}return t.message=new Handlebars.SafeString(e.replaceAll("\n","<br>",t.message)),t},initialize:function(){this.model.on("change:read",function(){this.model.markAsRead({save:!0}),this.render()},this),this.model.markAsRead({save:!0})}});return i.extend({headerOptions:{route:{title:"Read",breadcrumbs:[{title:"Messages",anchor:"#messages"}]}},afterRender:function(){var e=new n({model:this.model});this.setView("#page-content",e),this.model.has("message")&&e.render()},initialize:function(){this.headerOptions.route.title=this.model.get("subject")}})}),define("modules/messages/MessageModel",["app","backbone","core/entries/EntriesModel"],function(e,t,i){return i.extend({getUnreadCount:function(){var e=1==this.get("read")?0:1,t=this.get("responses").reduce(function(e,t){var i=1==t.get("read")?0:1;return e+i},0);return e+t},markAsRead:function(e){e=e||{};var t=this.getUnreadCount();if(0!==t)return this.collection.unread-=t,e.save?this.save({read:1},{patch:!0,silent:!0}):this.set({read:"1"},{silent:!0})}})}),define("modules/messages/MessageCollection",["app","backbone","core/entries/EntriesCollection","modules/messages/MessageModel"],function(e,t,i,n){return i.extend({model:n,updateFrequency:1e4,filters:{columns_visible:["from","subject","date_updated"],sort:"date_updated",sort_order:"DESC"},updateMessages:function(){var e=this,t={max_id:this.maxId};this.fetch({data:t,remove:!1,global:!1,error:function(){e.trigger("error:polling"),e.stopPolling()}})},startPolling:function(){this.timerId=window.setInterval(this.updateMessages.bind(this),this.updateFrequency)},stopPolling:function(){clearInterval(this.timerId),window.setTimeout(this.startPolling.bind(this),3e4)},parse:function(e){return null===e?[]:(void 0!==e.max_id&&(this.maxId=e.max_id,this.unread=e.unread,this.total=e.total),e.rows)},fetch:function(e){this.trigger("fetch",this),i.prototype.fetch.call(this,e)}})}),define("modules/messages/messages",["app","modules/messages/views/ListMessagesView","modules/messages/views/NewMessageView","modules/messages/views/ReadMessageView","modules/messages/MessageCollection"],function(e,t,i,n,s){var o=e.module();return o.Views.New=i,o.Views.Read=n,o.Views.List=t,o.Collection=s,o}),define("router",["require","exports","module","app","core/tabs","core/bookmarks","schema/SchemaManager","core/EntriesManager","core/ExtensionManager","modules/activity/activity","modules/tables/table","modules/settings/settings","modules/files/files","modules/users/users","modules/messages/messages","core/modal","moment"],function(e){var t=e("app"),i=e("core/tabs"),n=e("core/bookmarks"),s=e("schema/SchemaManager"),o=e("core/EntriesManager"),a=e("core/ExtensionManager"),r=e("modules/activity/activity"),l=e("modules/tables/table"),c=e("modules/settings/settings"),u=e("modules/files/files"),d=e("modules/users/users"),h=e("modules/messages/messages"),p=e("core/modal"),f=e("moment"),m=Backbone.Router.extend({routes:{"":"tables",tables:"tables","tables/:name(/pref/:pref)":"entries","tables/:name/:id":"entry",activity:"activity","files(/pref/:pref)":"files","files/:id":"filesItem","users(/pref/:pref)":"users","users/:id":"user",settings:"settings","settings/:name":"settings","settings/tables/:table":"settingsTable","settings/permissions/:groupId":"settingsPermissions",messages:"messages","messages/new":"newMessage","messages/:id":"message",cashregister:"cashregister",booker:"booker","*notFound":"notFound"},go:function(){var e=_.isArray(arguments[0])?arguments[0]:_.toArray(arguments);return this.navigate(e.join("/"),!0)},setTitle:function(e){document.title=e},showAlert:function(e,t){this.alert||(this.alert=new Backbone.Layout({template:"alert",serialize:{message:e,type:t}}),this.v.messages.insertView(this.alert).render())},hideAlert:function(){this.alert&&(this.alert.remove(),this.alert=void 0)},notFound:function(){this.setTitle(t.settings.get("global").get("site_name")+" | 404"),this.v.main.setView("#content",new Backbone.Layout({template:Handlebars.compile("<h1>Not found</h1>")})),this.v.main.render()},openModal:function(e){if(!(this.v.main.getViews("#modal-container")._wrapped.length>=1)){var t=new p.Prompt(e);this.v.main.insertView("#modal-container",t).render()}},overlayPage:function(e){this.v.main.getViews("#content")._wrapped.length<=1&&(this.baseRouteSave=Backbone.history.fragment,this.oldLoadUrlFunction=Backbone.History.prototype.loadUrl),this.v.main.getViews("#content").each(function(e){e.$el.hide()}),this.v.main.insertView("#content",e).render();var t=this;Backbone.History.prototype.loadUrl=function(){return t.baseRouteSave==this.getFragment()||window.confirm("All Unsaved changes will be lost, Are you sure you want to leave?")?(Backbone.History.prototype.loadUrl=t.oldLoadUrlFunction,t.oldLoadUrlFunction.apply(this,arguments)):(this.navigate(t.baseRouteSave),t.navigate(t.baseRouteSave),!0)}},removeOverlayPage:function(e){e.remove();var t=this.v.main.getViews("#content").last()._wrapped;t.$el.show(),this.v.main.getViews("#content")._wrapped.length<=1&&(Backbone.History.prototype.loadUrl=this.oldLoadUrlFunction,this.navigate(this.baseRouteSave),this.baseRouteSave=void 0)},setPage:function(e,t){this.v.main.setView("#content",new e(t)).render()},tables:function(){return _.contains(this.tabBlacklist,"tables")?this.notFound():(this.navigate("/tables"),this.setTitle(t.settings.get("global").get("site_name")+" | Tables"),this.tabs.setActive("tables"),this.v.main.setView("#content",new l.Views.Tables({collection:s.getTables()})),void this.v.main.render())},entries:function(e,i){if(_.contains(this.tabBlacklist,"tables"))return this.notFound();var n;if($.xhrPool.abortAll(),!s.getTable(e))return this.notFound();if(n=void 0!==this.currentCollection&&this.currentCollection.table.id==e?this.currentCollection:o.getInstance(e),n.table.get("single"))return void(n.models.length?this.entry(e,n.models[0].get("id")):(n.once("sync",_.bind(function(t){if(0===t.length)this.router.entry(e,"new");else{var i=t.models[0];this.router.entry(e,i.get("id"))}},{router:this})),n.fetch()));if(this.lastRoute!="tables/"+e&&this.loadedPreference&&(this.loadedPreference=void 0),i){if(this.navigate("/tables/"+e),this.lastRoute=="tables/"+e&&this.loadedPreference==i)return;this.loadedPreference=i}this.currentCollection=n,this.tabs.setActive("tables"),this.setTitle(t.settings.get("global").get("site_name")+" | "+t.capitalize(e)),this.v.main.setView("#content",new l.Views.List({collection:n})),this.v.main.render()},entry:function(e,i){if(_.contains(this.tabBlacklist,"tables"))return this.notFound();this.setTitle(t.settings.get("global").get("site_name")+" | Entry"),this.tabs.setActive("tables");var n,s,a,r="string"==typeof i&&-1!==i.indexOf(",");return n=void 0!==this.currentCollection&&this.currentCollection.table.id==e?this.currentCollection:o.getInstance(e),void 0===n?this.notFound():("new"===i||r?s=new n.model({},{collection:n,parse:!0}):(s=n.get(i),void 0===s&&(s=new n.model({id:i},{collection:n,parse:!0}))),a=r?new l.Views.BatchEdit({model:s,batchIds:i.split(",")}):new l.Views.Edit({model:s}),this.v.main.setView("#content",a),void this.v.main.render())},activity:function(){return _.contains(this.tabBlacklist,"activity")?this.notFound():(this.setTitle(t.settings.get("global").get("site_name")+" | Activity"),this.tabs.setActive("activity"),this.v.main.setView("#content",new r.Views.List({collection:t.activity})),void this.v.main.render())},files:function(e){if(_.contains(this.tabBlacklist,"files"))return this.notFound();if(e){if(this.navigate("/files"),"files/"==this.lastRoute&&this.loadedPreference==e)return;this.loadedPreference=e}else this.loadedPreference&&-1==this.lastRoute.indexOf("files/pref/")&&(this.loadedPreference=null);this.setTitle(t.settings.get("global").get("site_name")+" | Files"),this.tabs.setActive("files"),this.v.main.setView("#content",new u.Views.List({collection:t.files})),this.v.main.render()},filesItem:function(e){var i;this.setTitle(t.settings.get("global").get("site_name")+" | File"),this.tabs.setActive("files"),"new"===e?i=new t.files.model({},{collection:t.files}):(i=t.files.get(e),void 0===i&&(i=new t.files.model({id:e},{collection:t.files,parse:!0}))),this.v.main.setView("#content",new u.Views.Edit({model:i})),this.v.main.render()},users:function(e){if(e){if(this.navigate("/users"),"users/"==this.lastRoute&&this.loadedPreference==e)return;this.loadedPreference=e}else this.loadedPreference&&-1==this.lastRoute.indexOf("users/pref/")&&(this.loadedPreference=null);this.setTitle(t.settings.get("global").get("site_name")+" | Users"),this.tabs.setActive("users"),this.v.main.setView("#content",new d.Views.List({collection:t.users})),this.v.main.render()},user:function(e){var i=t.users.getCurrentUser(),n=i.get("group");if(parseInt(e,10)!==i.id&&1!==n.id)return this.notFound();var s;this.setTitle(t.settings.get("global").get("site_name")+" | Users"),this.tabs.setActive("users"),s="new"===e?new t.users.model({},{collection:t.users,parse:!0}):t.users.get(e),this.v.main.setView("#content",new d.Views.Edit({model:s})),this.v.main.render()},settings:function(e){if(_.contains(this.tabBlacklist,"settings"))return this.notFound();switch(this.setTitle(t.settings.get("global").get("site_name")+" | Settings"),this.tabs.setActive("settings"),e){case"tables":this.v.main.setView("#content",new c.Tables({collection:s.getTables()}));break;case"global":this.v.main.setView("#content",new c.Global({model:t.settings.get("global"),title:"Global",structure:s.getColumns("settings","global")}));break;case"files":this.v.main.setView("#content",new c.Global({model:t.settings.get("files"),title:"Files",structure:s.getColumns("settings","files")}));break;case"permissions":this.v.main.setView("#content",new c.Permissions({collection:t.groups}));break;case"system":this.v.main.setView("#content",new c.System);break;case"about":this.v.main.setView("#content",new c.About);break;default:this.v.main.setView("#content",new c.Main({tables:s.getTables()}))}this.v.main.render()},settingsTable:function(e){return _.contains(this.tabBlacklist,"settings")?this.notFound():(this.setTitle(t.settings.get("global").get("site_name")+" | Settings"),this.tabs.setActive("settings"),this.v.main.setView("#content",new c.Table({model:s.getTable(e)})),void this.v.main.render())},settingsPermissions:function(e){if(_.contains(this.tabBlacklist,"settings"))return this.notFound();this.setTitle(t.settings.get("global").get("site_name")+" | Settings - Permissions"),this.tabs.setActive("settings");var i=new c.GroupPermissions.Collection([],{url:t.API_URL+"privileges/"+e});this.v.main.setView("#content",new c.GroupPermissions.Page({collection:i,title:t.groups.get(e).get("name")})),this.v.main.render()},messages:function(){this.tabs.setActive("messages"),this.setTitle(t.settings.get("global").get("site_name")+" | Messages"),this.v.main.setView("#content",new h.Views.List({collection:t.messages})),this.v.main.render()},message:function(e){var i=t.messages.get(e);this.setTitle(t.settings.get("global").get("site_name")+" | Message"),void 0===i&&(i=new t.messages.model({id:e},{collection:t.messages,parse:!0}),i.fetch()),this.v.main.setView("#content",new h.Views.Read({model:i})),this.v.main.render()},newMessage:function(){this.setTitle(t.settings.get("global").get("site_name")+" | Compose");var e=new t.messages.model({from:t.users.getCurrentUser().id},{collection:t.messages,parse:!0});this.v.main.setView("#content",new h.Views.New({model:e})),this.v.main.render()},initialize:function(e){this.tabBlacklist=(e.tabPrivileges.tab_blacklist||"").split(","),$("body").addClass("initial-load"),this.tabs=e.tabs,this.bookmarks=t.getBookmarks(),this.extensions={},_.each(e.extensions,function(e){try{this.extensions[e]=a.getInstance(e)}catch(t){return console.log(e+" failed to load:",t.stack),void this.tabs.get(e).set({error:t})}this.extensions[e].on("route",function(){this.trigger("subroute",e),this.trigger("route:"+e,e)},this)},this);var s=(t.users.getCurrentUser(),new i.View({collection:this.tabs})),o=new n.View({collection:this.bookmarks}),r=Backbone.Layout.extend({template:"navbar",tagName:"div",serialize:function(){return{siteUrl:this.model.get("site_url"),messageCounter:t.messages.unread,cms_thumbnail_url:this.model.get("cms_thumbnail_url")}},beforeRender:function(){this.insertView("#featureSidebar",s),this.insertView("#mainSidebar",o)},keep:!0});this.v={};var l=new r({model:t.settings.get("global")});this.v.main=new Backbone.Layout({el:"#main",views:{"#sidebar":l}}),this.v.messages=new Backbone.Layout({el:"#messages"}),this.on("subroute",function(e){this.tabs.setActive(e)}),this.bind("all",function(e,i){this.lastRoute=window.location.pathname.substring(t.root.length);var n,s=e.split(":");if(s.length>1){var a=t.users.getCurrentUser(),r=window.location.pathname.substring(t.root.length);r.length&&(o.setActive(r),n=JSON.stringify({path:r,route:e.substring(6),param:i}),"logout"!=r&&a.save({last_page:n,last_access:f().format("YYYY-MM-DD HH:mm")},{patch:!0,global:!1,silent:!0,wait:!0,validate:!1,url:a.url()+"?skip_activity_log=1"}))}}),this.v.main.render()}});return m}),$.noty.themes.directus={name:"directus",helpers:{},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",margin:"4px 0",borderRadius:"0",width:"60%",border:"0px solid #fff"}),this.$message.css({fontSize:"14px",lineHeight:"16px",textAlign:"center",padding:"10px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:4,textAlign:"right",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){$(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){$(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderTop:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});
break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderBottom:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#333333",borderColor:"#333333",color:"#FFF",borderBottom:"3px solid #212121"});break;case"warning":this.$bar.css({backgroundColor:"#fbb03b",borderColor:"#fbb03b",color:"#FFF",borderBottom:"3px solid #e69005"});break;case"error":this.$bar.css({backgroundColor:"#c1272d",borderColor:"#c1272d",color:"#FFF",borderBottom:"3px solid #981f23"});break;case"information":this.$bar.css({backgroundColor:"#78C5E7",borderColor:"#78C5E7",color:"#FFF",borderBottom:"3px solid #3badd6"});break;case"success":this.$bar.css({backgroundColor:"#7ac943",borderColor:"#7ac943",color:"FFF",borderBottom:"3px solid #981f23"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444",borderBottom:"3px solid #981f23"})}},callback:{onShow:function(){},onClose:function(){}}},define("noty_theme",["jquery","noty"],function(){}),define("alerts",["app","noty","noty_theme"],function(e){var t=(new Backbone.Layout({el:"#messages"}),Backbone.Layout.extend({showDetails:!1,events:{"click button.show-details":function(){this.showDetails=!this.showDetails,this.render()},"click button.close-alert":function(){e.unlockScreen(),this.remove()}},template:"error",serialize:function(){return{message:this.options.message,details:this.options.details,showDetails:this.showDetails}}}),function(){$('a[href$="#activity"] span').removeClass("icon-bell").addClass("icon-cycle"),e.activityInProgress=!0,$("#page-blocker").show()}),i=function(){$('a[href$="#activity"] span').addClass("icon-bell").removeClass("icon-cycle"),e.activityInProgress=!1,$("#page-blocker").fadeOut(100)};e.on("progress",t),e.on("load",i),e.on("alert:error",function(e,t){noty({text:"<b>"+e+"</b><br>"+t,type:"error",theme:"directus"})})}),define("modules/settings/SettingsCollection",["app","backbone","core/collection"],function(e,t,i){var n=i.extend({model:t.Model.extend({getStructure:function(){return this.structure}})});return n}),define("core/idle",["require","exports","module","jquery"],function(e,t,i){var n=e("jquery"),s=i.exports,o=null,a="mousemove click keydown",r=function(e,t,i){return clearTimeout(e),setTimeout(t,i)};s.interrupt=function(){clearTimeout(o),"function"==typeof this.options.interrupt&&this.options.interrupt(),this.options.repeat?o=setTimeout(this.fn,this.ms):this.unbindEvents()},s.bindEvents=function(){n(document).on(a,this.interrupt.bind(this))},s.unbindEvents=function(){n(document).off(a,this.interrupt)},s.start=function(e){var t=this;this.ms=e.delay,this.options=e,this.fn=function(){t.unbindEvents(),e.timeout()},this.bindEvents(),o=r(o,this.fn,this.ms)}}),define("tool-tips",["app","backbone"],function(e,t){var i,n=t.Layout.extend({showDetails:!1,el:"#tool-tips",template:"tool-tips",afterRender:function(){i.init()}});return i=function(){function e(){o=$("[data-tool-tip-for]"),a=$("[data-tool-tip-toggle-class]"),o.each(function(){var e,o=$(this),a=o.data("tool-tip-for"),l=$(a);o.append('<span class="'+r+'"></span>'),e=o.find("."+r),i(o),t(e,o),o.data("nudge-x")||o.data("nudge-x",0),o.data("nudge-y")||o.data("nudge-y",0),o.data("offset-x")||o.data("offset-x",0),o.data("offset-y")||o.data("offset-y",0),o.data("width")?o.width(o.data("width")):null,o.data("height")?o.width(o.data("height")):null,n(e,o),function(){var e;$(document).on("mouseenter",l.selector,function(){e=setTimeout(function(){s(l.selector,o),o.show()},500)}).on("mouseleave click",l.selector,function(){clearTimeout(e),o.hide()})}()})}function t(e,t){var i=e.css(["border-top-width","border-right-width","border-bottom-width","border-left-width"]),n=[parseInt(i["border-top-width"],10),parseInt(i["border-right-width"],10),parseInt(i["border-bottom-width"],10),parseInt(i["border-left-width"],10)];t.data("tool-tip-pointer-size",Math.max(n[0],n[1],n[2],n[3]))}function i(e){var t=l.bottom;e.hasClass(l.top)&&(t=l.top),e.hasClass(l.left)&&(t=l.left),e.hasClass(l.right)&&(t=l.right),e.data("tool-tip-position",t),e.addClass(t)}function n(e,t){t.data("offset-x")&&e.css("margin-left",parseInt(e.css("margin-left"),10)-t.data("offset-x")),t.data("offset-y")&&e.css("margin-top",parseInt(e.css("margin-top"),10)-t.data("offset-y"))}function s(e,t){function i(){return(r.outerWidth()-t.outerWidth())/2+s.left+t.data("offset-x")}function n(){return(r.outerHeight()-t.outerHeight())/2+s.top+t.data("offset-y")}var s,o,a,r=_.isString(e)?$(e):e;if(r.length>0){switch(s=r.offset(),o={position:t.data("fixed")?"fixed":"",zIndex:t.data("fixed")?"100":""},a=t.data("tool-tip-pointer-size"),t.data("fixed")&&(s.top-=$window.scrollTop()),t.data("tool-tip-position")){case l.top:o.top=s.top-t.outerHeight()-a,o.left=i();break;case l.bottom:o.top=s.top+r.outerHeight()+a,o.left=i();break;case l.left:o.top=n(),o.left=s.left-t.outerWidth()-a;break;case l.right:o.top=n(),o.left=s.left+r.outerWidth()+a}o.top+=t.data("nudge-y"),o.left+=t.data("nudge-x"),t.css(o)}else t.hide()}var o,a,r="tool-tip-pointer",l={top:"top",bottom:"bottom",left:"left",right:"right"};return{init:e}}(),n}),require(["config"],function(){require(["app","core/UIManager","router","backbone","alerts","core/tabs","core/bookmarks","modules/messages/messages","schema/SchemaManager","modules/settings/SettingsCollection","core/ExtensionManager","core/EntriesManager","core/ListViewManager","core/idle","tool-tips","noty"],function(e,t,i,n,s,o,a,r,l,c,u,d,h,p,f){var m={path:"/directus/",page:"",authenticatedUser:7,groups:{},privileges:[],ui:[],active_files:{},users:{},bookmarks:{},extensions:[],messages:{},me:{id:7},settings:{global:{},files:{}},storage_adapters:{},tab_privileges:{},preferences:[],tables:[],nonces:{pool:[],nonce_pool_size:10,nonce_request_header:"X-Directus-Request-Nonce",nonce_response_header:"X-Directus-New-Request-Nonces"}},g=_.defaults(window.directusData,m);e.root=g.path,e.DEFAULT_VALIDATION_MESSAGE="Invalid content...",e.API_URL=g.path+"api/1/",e.RESOURCES_URL="/resources/",e.PATH=g.path,e.authenticatedUserId=window.directusData.authenticatedUser,e.storageAdapters=window.directusData.storage_adapters,e.statusMapping=window.directusData.statusMapping,$.xhrPool=[],$.xhrPool.abortAll=function(){$(this).each(function(e,t){t.abort()}),$.xhrPool.length=0},$.ajaxSetup({beforeSend:function(e){$.xhrPool.push(e)},complete:function(e){var t=$.xhrPool.indexOf(e);t>-1&&$.xhrPool.splice(t,1)}}),e.settings=new c(g.settings,{parse:!0}),e.settings.url=e.API_URL+"settings",t.setup(),l.setup({apiURL:e.API_URL}),e.schemaManager=l,$.when(t.load(g.ui),u.load(g.extensions),h.load(g.listViews)).done(function(){var c=parseInt(e.settings.get("global").get("cms_user_auto_sign_out")||60,10),h=function(){p.start({timeout:function(){noty({text:"You've been inactive for "+c+" minutes. You will be automatically logged out in 10 seconds",type:"warning",layout:"bottomRight",theme:"directus"}),p.start({timeout:function(){e.logOut(!0)},interrupt:h,delay:1e4,repeat:!1})},delay:60*c*1e3,repeat:!0})};h(),l.registerUISchemas(t.getAllSettings()),l.register("tables",g.tables),l.registerPreferences(g.preferences),l.registerPrivileges(g.privileges),l.getColumns("tables","directus_users").add(g.extendedUserColumns,{parse:!0}),d.setup({apiURL:e.API_URL,rowsPerPage:parseInt(e.settings.get("global").get("rows_per_page"),10)}),e.users=d.getInstance("directus_users"),e.files=d.getInstance("directus_files"),e.activity=d.getInstance("directus_activity"),e.groups=d.getInstance("directus_groups"),e.getEntries=function(e,t){return d.getInstance(e,t)},e.messages=new r.Collection([],_.extend({url:e.API_URL+"messages/rows/"},l.getFullSchema("directus_messages"))),e.messages.on("error:polling",function(){noty({text:"<b>Directus can't reach the server</b><br><i>A new attempt will be made in 30 seconds</i>",type:"error",layout:"bottomRight",theme:"directus"})}),e.messages.on("sync",function(e,t){null!==t&&t.rows&&t.rows.forEach(function(e){noty({text:"<b>New Message — <i>"+e.subject+"</i></b><br>"+e.responses.models[e.responses.models.length-1].attributes.message+"<br><br><i>View message</i>",layout:"bottomRight",timeout:5e3,theme:"directus",callback:{onCloseClick:function(){n.history.navigate("/messages/"+e.id,!0)}}})})}),e.groups.reset(g.groups,{parse:!0}),e.users.reset(g.users,{parse:!0}),e.files.reset(g.active_files,{parse:!0}),e.messages.reset(g.messages,{parse:!0}),e.messages.startPolling(),e.showProgressNotification=function(e){s.showProgressNotification(e)},e.hideProgressNotification=function(){s.hideProgressNotification()},$("#page-blocker").fadeOut(0);var m=[{id:"users/"+e.users.getCurrentUser().get("id"),icon_class:"icon-pencil",avatar:""},{id:"logout",icon_class:"icon-power-button"}];1===e.users.getCurrentUser().get("group").id&&m.unshift();var v=[];g.tables.forEach(function(t){if(t=t.schema,l.getPrivileges(t.table_name)&&l.getPrivileges(t.table_name).get("permissions")){var i=l.getPrivileges(t.table_name).get("permissions").split(",");(-1!==i.indexOf("view")||-1!==i.indexOf("bigview"))&&(t.hidden||v.push(new n.Model({icon_class:"",title:e.capitalize(t.table_name),url:"tables/"+t.table_name,section:"table"})))}});var b=window.directusData.bookmarks;_.each(b,function(e){v.push(new n.Model(e))});var y=u.getIds();_.each(y,function(e){e=u.getInfo(e),v.push(new n.Model({icon_class:e.icon,title:e.title,url:e.id,section:"extension"}))});var w=g.tab_privileges,x=(w.tab_blacklist||"").split(","),k=[];if(w.nav_override!==!1)for(var C in w.nav_override){var S=w.nav_override[C];for(var T in S){var E=S[T].path||"";k.push(new n.Model({icon_class:T.icon,title:T,url:E,section:C}))}}else console.log("The nav override JSON for this user group is malformed – the default nav will be used instead");var A=!1;k.length&&(A=!0,v=v.concat(k)),v=_.filter(v,function(e){return!_.contains(x,e.attributes.title)}),m=new o.Collection(m),e.bookmarks=new a.Collection(v,{isCustomBookmarks:A});var M=n.sync;n.sync=function(t,i,n){var s=function(){};void 0!==n.error&&(s=n.error);var o=function(t,i,n){switch(i=t.status,s(t,i,n),i){case 404:e.router.notFound();break;case 401:window.location=e.root;break;case 500:}};n.error=o,M(t,i,n)},$(document).on("drop dragover",function(e){e.preventDefault()}),$(document).on("mousewheel DOMMouseScroll",function(t){e.noScroll&&"TEXTAREA"!==event.target.nodeName&&t.preventDefault()}),$(window).keydown(_.bind(function(e){83===e.keyCode&&e.metaKey&&e.preventDefault()},this)),$(document).on("ajaxStart.directus",function(){e.trigger("progress")}),$(document).on("ajaxStop.directus",function(){e.trigger("load")}),$(document).ajaxError(function(t,i){var n,s,o;if("abort"!=i.statusText)switch(i.status){case 403:s="You don't have permission to access this table. Please send this to IT:<br>\n\n"+i.responseText,e.trigger("alert:error","Restricted Access",s,!0);break;default:n="Server "+i.status,s="Server Error",o=encodeURIComponent(i.responseText),e.logErrorToServer(n,s,o),i.responseJSON?e.trigger("alert:error","Server Error",i.responseJSON.message):e.trigger("alert:error","Server Error",i.responseText)}}),window.onerror=function(t,i,n){var s="JS",o="Error: "+t+"\nFile: "+i+"\n Line:"+n;e.logErrorToServer(s,"Error",o),e.trigger("alert:error","Error",o)};var N,O=window.directusData.nonces;$(document).ajaxSend(function(t,i,n){var s=n.url.substr(0,e.API_URL.length)==e.API_URL;s&&(N=O.pool.pop(),i.setRequestHeader(O.nonce_request_header,N))}),$(document).ajaxSuccess(function(e,t){var i=t.getResponseHeader(O.nonce_response_header);i&&(i=i.split(","),O.pool.push.apply(O.pool,i))}),e.router=new i({extensions:y,tabs:m,tabPrivileges:g.tab_privileges}),n.history.start({pushState:!0,root:e.root}),$(document).on("click","a[href]:not([data-bypass])",function(t){var i={prop:$(this).prop("href"),attr:$(this).attr("href")},s=location.protocol+"//"+location.host+e.root;if(i.prop.slice(0,s.length)===s){if(t.preventDefault(),"#"===i.attr)return;n.history.navigate(i.attr,!0)}}).on("scroll",function(){var e=Math.max(Math.min($(window).scrollTop(),100),0)/100;$("#header-shadow").css({opacity:e})});var I=new f;I.render()})})}),define("main",function(){})}();